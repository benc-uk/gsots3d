var To=Object.create;var gt=Object.defineProperty;var _o=Object.getOwnPropertyDescriptor;var vo=Object.getOwnPropertyNames;var Ao=Object.getPrototypeOf,go=Object.prototype.hasOwnProperty;var wo=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),So=(e,t)=>{for(var r in t)gt(e,r,{get:t[r],enumerable:!0})},Fo=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of vo(t))!go.call(e,o)&&o!==r&&gt(e,o,{get:()=>t[o],enumerable:!(n=_o(t,o))||n.enumerable});return e};var de=(e,t,r)=>(r=e!=null?To(Ao(e)):{},Fo(t||!e||!e.__esModule?gt(r,"default",{value:e,enumerable:!0}):r,e));var Te=wo((dr,Xe)=>{"use strict";(function(e,t){"use strict";typeof define=="function"&&define.amd?define(t):typeof Xe=="object"&&Xe.exports?Xe.exports=t():e.log=t()})(dr,function(){"use strict";var e=function(){},t="undefined",r=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),n=["trace","debug","info","warn","error"];function o(h,l){var x=h[l];if(typeof x.bind=="function")return x.bind(h);try{return Function.prototype.bind.call(x,h)}catch{return function(){return Function.prototype.apply.apply(x,[h,arguments])}}}function i(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function c(h){return h==="debug"&&(h="log"),typeof console===t?!1:h==="trace"&&r?i:console[h]!==void 0?o(console,h):console.log!==void 0?o(console,"log"):e}function a(h,l){for(var x=0;x<n.length;x++){var b=n[x];this[b]=x<h?e:this.methodFactory(b,h,l)}this.log=this.debug}function s(h,l,x){return function(){typeof console!==t&&(a.call(this,l,x),this[h].apply(this,arguments))}}function f(h,l,x){return c(h)||s.apply(this,arguments)}function u(h,l,x){var b=this,_;l=l??"WARN";var E="loglevel";typeof h=="string"?E+=":"+h:typeof h=="symbol"&&(E=void 0);function v(g){var w=(n[g]||"silent").toUpperCase();if(!(typeof window===t||!E)){try{window.localStorage[E]=w;return}catch{}try{window.document.cookie=encodeURIComponent(E)+"="+w+";"}catch{}}}function T(){var g;if(!(typeof window===t||!E)){try{g=window.localStorage[E]}catch{}if(typeof g===t)try{var w=window.document.cookie,F=w.indexOf(encodeURIComponent(E)+"=");F!==-1&&(g=/^([^;]+)/.exec(w.slice(F))[1])}catch{}return b.levels[g]===void 0&&(g=void 0),g}}function A(){if(!(typeof window===t||!E)){try{window.localStorage.removeItem(E);return}catch{}try{window.document.cookie=encodeURIComponent(E)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}b.name=h,b.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},b.methodFactory=x||f,b.getLevel=function(){return _},b.setLevel=function(g,w){if(typeof g=="string"&&b.levels[g.toUpperCase()]!==void 0&&(g=b.levels[g.toUpperCase()]),typeof g=="number"&&g>=0&&g<=b.levels.SILENT){if(_=g,w!==!1&&v(g),a.call(b,g,h),typeof console===t&&g<b.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+g},b.setDefaultLevel=function(g){l=g,T()||b.setLevel(g,!1)},b.resetLevel=function(){b.setLevel(l,!1),A()},b.enableAll=function(g){b.setLevel(b.levels.TRACE,g)},b.disableAll=function(g){b.setLevel(b.levels.SILENT,g)};var d=T();d==null&&(d=l),b.setLevel(d,!1)}var p=new u,m={};p.getLogger=function(l){if(typeof l!="symbol"&&typeof l!="string"||l==="")throw new TypeError("You must supply a name when creating a logger.");var x=m[l];return x||(x=m[l]=new u(l,p.getLevel(),p.methodFactory)),x};var y=typeof window!==t?window.log:void 0;return p.noConflict=function(){return typeof window!==t&&window.log===p&&(window.log=y),p},p.getLoggers=function(){return m},p.default=p,p})});var wr=de(Te(),1);function t0(e){wr.default.setLevel(e)}var ce=de(Te(),1);var Dt=Float32Array;function zt(e,t,r){let n=new Dt(3);return e&&(n[0]=e),t&&(n[1]=t),r&&(n[2]=r),n}function Po(e,t,r){return r=r||new Dt(3),r[0]=e[0]+t[0],r[1]=e[1]+t[1],r[2]=e[2]+t[2],r}function Io(e,t,r){return r=r||new Dt(3),r[0]=e[0]*t[0],r[1]=e[1]*t[1],r[2]=e[2]*t[2],r}var Ur=Float32Array;function Mo(e){return e=e||new Ur(16),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ro(e,t){t=t||new Ur(16);let r=e[0*4+0],n=e[0*4+1],o=e[0*4+2],i=e[0*4+3],c=e[1*4+0],a=e[1*4+1],s=e[1*4+2],f=e[1*4+3],u=e[2*4+0],p=e[2*4+1],m=e[2*4+2],y=e[2*4+3],h=e[3*4+0],l=e[3*4+1],x=e[3*4+2],b=e[3*4+3],_=m*b,E=x*y,v=s*b,T=x*f,A=s*y,d=m*f,g=o*b,w=x*i,F=o*y,I=m*i,R=o*f,C=s*i,P=u*l,z=h*p,$=c*l,H=h*a,K=c*p,Z=u*a,Ge=r*l,Ve=h*n,ke=r*p,$e=u*n,He=r*a,je=c*n,_r=_*a+T*p+A*l-(E*a+v*p+d*l),vr=E*n+g*p+I*l-(_*n+w*p+F*l),Ar=v*n+w*a+R*l-(T*n+g*a+C*l),gr=d*n+F*a+C*p-(A*n+I*a+R*p),O=1/(r*_r+c*vr+u*Ar+h*gr);return t[0]=O*_r,t[1]=O*vr,t[2]=O*Ar,t[3]=O*gr,t[4]=O*(E*c+v*u+d*h-(_*c+T*u+A*h)),t[5]=O*(_*r+w*u+F*h-(E*r+g*u+I*h)),t[6]=O*(T*r+g*c+C*h-(v*r+w*c+R*h)),t[7]=O*(A*r+I*c+R*u-(d*r+F*c+C*u)),t[8]=O*(P*f+H*y+K*b-(z*f+$*y+Z*b)),t[9]=O*(z*i+Ge*y+$e*b-(P*i+Ve*y+ke*b)),t[10]=O*($*i+Ve*f+He*b-(H*i+Ge*f+je*b)),t[11]=O*(Z*i+ke*f+je*y-(K*i+$e*f+He*y)),t[12]=O*($*m+Z*x+z*s-(K*x+P*s+H*m)),t[13]=O*(ke*x+P*o+Ve*m-(Ge*m+$e*x+z*o)),t[14]=O*(Ge*s+je*x+H*o-(He*x+$*o+Ve*s)),t[15]=O*(He*m+K*o+$e*s-(ke*s+je*m+Z*o)),t}function Co(e,t,r){r=r||zt();let n=t[0],o=t[1],i=t[2],c=n*e[0*4+3]+o*e[1*4+3]+i*e[2*4+3]+e[3*4+3];return r[0]=(n*e[0*4+0]+o*e[1*4+0]+i*e[2*4+0]+e[3*4+0])/c,r[1]=(n*e[0*4+1]+o*e[1*4+1]+i*e[2*4+1]+e[3*4+1])/c,r[2]=(n*e[0*4+2]+o*e[1*4+2]+i*e[2*4+2]+e[3*4+2])/c,r}function No(e,t,r){r=r||zt();let n=t[0],o=t[1],i=t[2];return r[0]=n*e[0*4+0]+o*e[1*4+0]+i*e[2*4+0],r[1]=n*e[0*4+1]+o*e[1*4+1]+i*e[2*4+1],r[2]=n*e[0*4+2]+o*e[1*4+2]+i*e[2*4+2],r}var Ot=5120,Pe=5121,Gt=5122,Vt=5123,kt=5124,$t=5125,Ht=5126,Bo=32819,Lo=32820,Uo=33635,Do=5131,zo=33640,Oo=35899,Go=35902,Vo=36269,ko=34042,Dr={};{let e=Dr;e[Ot]=Int8Array,e[Pe]=Uint8Array,e[Gt]=Int16Array,e[Vt]=Uint16Array,e[kt]=Int32Array,e[$t]=Uint32Array,e[Ht]=Float32Array,e[Bo]=Uint16Array,e[Lo]=Uint16Array,e[Uo]=Uint16Array,e[Do]=Uint16Array,e[zo]=Uint32Array,e[Oo]=Uint32Array,e[Go]=Uint32Array,e[Vo]=Uint32Array,e[ko]=Uint32Array}function et(e){if(e instanceof Int8Array)return Ot;if(e instanceof Uint8Array||e instanceof Uint8ClampedArray)return Pe;if(e instanceof Int16Array)return Gt;if(e instanceof Uint16Array)return Vt;if(e instanceof Int32Array)return kt;if(e instanceof Uint32Array)return $t;if(e instanceof Float32Array)return Ht;throw new Error("unsupported typed array type")}function zr(e){if(e===Int8Array)return Ot;if(e===Uint8Array||e===Uint8ClampedArray)return Pe;if(e===Int16Array)return Gt;if(e===Uint16Array)return Vt;if(e===Int32Array)return kt;if(e===Uint32Array)return $t;if(e===Float32Array)return Ht;throw new Error("unsupported typed array type")}function Or(e){let t=Dr[e];if(!t)throw new Error("unknown gl type");return t}var Ie=typeof SharedArrayBuffer<"u"?function(t){return t&&t.buffer&&(t.buffer instanceof ArrayBuffer||t.buffer instanceof SharedArrayBuffer)}:function(t){return t&&t.buffer&&t.buffer instanceof ArrayBuffer};function $o(e,t,r){e.forEach(function(n){let o=t[n];o!==void 0&&(r[n]=o)})}function Gr(...e){console.error(...e)}var Sr=new Map;function jt(e,t){if(!e||typeof e!="object")return!1;let r=Sr.get(t);r||(r=new WeakMap,Sr.set(t,r));let n=r.get(e);if(n===void 0){let o=Object.prototype.toString.call(e);n=o.substring(8,o.length-1)===t,r.set(e,n)}return n}function Ho(e,t){return typeof WebGLBuffer<"u"&&jt(t,"WebGLBuffer")}function Vr(e,t){return typeof WebGLTexture<"u"&&jt(t,"WebGLTexture")}function jo(e,t){return typeof WebGLSampler<"u"&&jt(t,"WebGLSampler")}var kr=35044,te=34962,$r=34963,Xo=34660,Yo=5120,Wo=5121,Ko=5122,Zo=5123,qo=5124,Qo=5125,Hr=5126,jr={attribPrefix:""};function Jo(e,t,r,n,o){e.bindBuffer(t,r),e.bufferData(t,n,o||kr)}function Xt(e,t,r,n){if(Ho(e,t))return t;r=r||te;let o=e.createBuffer();return Jo(e,r,o,t,n),o}function Xr(e){return e==="indices"}function ei(e){return e===Int8Array||e===Uint8Array}function Yt(e){return e.length?e:e.data}var ti=/coord|texture/i,ri=/color|colour/i;function ni(e,t){let r;if(ti.test(e)?r=2:ri.test(e)?r=4:r=3,t%r>0)throw new Error(`Can not guess numComponents for attribute '${e}'. Tried ${r} but ${t} values is not evenly divisible by ${r}. You should specify it.`);return r}function Wt(e,t,r){return e.numComponents||e.size||ni(t,r||Yt(e).length)}function tt(e,t){if(Ie(e))return e;if(Ie(e.data))return e.data;Array.isArray(e)&&(e={data:e});let r=e.type?Kt(e.type):void 0;return r||(Xr(t)?r=Uint16Array:r=Float32Array),new r(e.data)}function oi(e){return typeof e=="number"?e:e?zr(e):Hr}function Kt(e){return typeof e=="number"?Or(e):e||Float32Array}function ii(e,t){return{buffer:t.buffer,numValues:2*3*4,type:oi(t.type),arrayType:Kt(t.type)}}function ci(e,t){let r=t.data||t,n=Kt(t.type),o=r*n.BYTES_PER_ELEMENT,i=e.createBuffer();return e.bindBuffer(te,i),e.bufferData(te,o,t.drawType||kr),{buffer:i,numValues:r,type:zr(n),arrayType:n}}function ai(e,t,r){let n=tt(t,r);return{arrayType:n.constructor,buffer:Xt(e,n,void 0,t.drawType),type:et(n),numValues:0}}function si(e,t){let r={};return Object.keys(t).forEach(function(n){if(!Xr(n)){let o=t[n],i=o.attrib||o.name||o.attribName||jr.attribPrefix+n;if(o.value){if(!Array.isArray(o.value)&&!Ie(o.value))throw new Error("array.value is not array or typedarray");r[i]={value:o.value}}else{let c;o.buffer&&o.buffer instanceof WebGLBuffer?c=ii:typeof o=="number"||typeof o.data=="number"?c=ci:c=ai;let{buffer:a,type:s,numValues:f,arrayType:u}=c(e,o,n),p=o.normalize!==void 0?o.normalize:ei(u),m=Wt(o,n,f);r[i]={buffer:a,numComponents:m,type:s,normalize:p,stride:o.stride||0,offset:o.offset||0,divisor:o.divisor===void 0?void 0:o.divisor,drawType:o.drawType}}}}),e.bindBuffer(te,null),r}function fi(e,t){return t===Yo||t===Wo?1:t===Ko||t===Zo?2:t===qo||t===Qo||t===Hr?4:0}var Ae=["position","positions","a_position"];function li(e){let t,r;for(r=0;r<Ae.length&&(t=Ae[r],!(t in e));++r);r===Ae.length&&(t=Object.keys(e)[0]);let n=e[t],o=Yt(n).length;if(o===void 0)return 1;let i=Wt(n,t),c=o/i;if(o%i>0)throw new Error(`numComponents ${i} not correct for length ${o}`);return c}function ui(e,t){let r,n;for(n=0;n<Ae.length&&(r=Ae[n],!(r in t||(r=jr.attribPrefix+r,r in t)));++n);n===Ae.length&&(r=Object.keys(t)[0]);let o=t[r];if(!o.buffer)return 1;e.bindBuffer(te,o.buffer);let i=e.getBufferParameter(te,Xo);e.bindBuffer(te,null);let c=fi(e,o.type),a=i/c,s=o.numComponents||o.size,f=a/s;if(f%1!==0)throw new Error(`numComponents ${s} not correct for length ${length}`);return f}function Zt(e,t,r){let n=si(e,t),o=Object.assign({},r||{});o.attribs=Object.assign({},r?r.attribs:{},n);let i=t.indices;if(i){let c=tt(i,"indices");o.indices=Xt(e,c,$r),o.numElements=c.length,o.elementType=et(c)}else o.numElements||(o.numElements=ui(e,o.attribs));return o}function mi(e,t,r){let n=r==="indices"?$r:te,o=tt(t,r);return Xt(e,o,n)}function xi(e,t){let r={};return Object.keys(t).forEach(function(n){r[n]=mi(e,t[n],n)}),t.indices?(r.numElements=t.indices.length,r.elementType=et(tt(t.indices))):r.numElements=li(t),r}var ue=Yt,hi=Wt;function Yr(e,t){let r=0;return e.push=function(){for(let n=0;n<arguments.length;++n){let o=arguments[n];if(o instanceof Array||Ie(o))for(let i=0;i<o.length;++i)e[r++]=o[i];else e[r++]=o}},e.reset=function(n){r=n||0},e.numComponents=t,Object.defineProperty(e,"numElements",{get:function(){return this.length/this.numComponents|0}}),e}function M(e,t,r){let n=r||Float32Array;return Yr(new n(e*t),e)}function pi(e){return e!=="indices"}function yi(e){let t=e.indices,r={},n=t.length;function o(i){let c=e[i],a=c.numComponents,s=M(a,n,c.constructor);for(let f=0;f<n;++f){let p=t[f]*a;for(let m=0;m<a;++m)s.push(c[p+m])}r[i]=s}return Object.keys(e).filter(pi).forEach(o),r}function bi(e){if(e.indices)throw new Error("can not flatten normals of indexed vertices. deindex them first");let t=e.normal,r=t.length;for(let n=0;n<r;n+=9){let o=t[n+0],i=t[n+1],c=t[n+2],a=t[n+3],s=t[n+4],f=t[n+5],u=t[n+6],p=t[n+7],m=t[n+8],y=o+a+u,h=i+s+p,l=c+f+m,x=Math.sqrt(y*y+h*h+l*l);y/=x,h/=x,l/=x,t[n+0]=y,t[n+1]=h,t[n+2]=l,t[n+3]=y,t[n+4]=h,t[n+5]=l,t[n+6]=y,t[n+7]=h,t[n+8]=l}return e}function qt(e,t,r){let n=e.length,o=new Float32Array(3);for(let i=0;i<n;i+=3)r(t,[e[i],e[i+1],e[i+2]],o),e[i]=o[0],e[i+1]=o[1],e[i+2]=o[2]}function Ei(e,t,r){r=r||zt();let n=t[0],o=t[1],i=t[2];return r[0]=n*e[0*4+0]+o*e[0*4+1]+i*e[0*4+2],r[1]=n*e[1*4+0]+o*e[1*4+1]+i*e[1*4+2],r[2]=n*e[2*4+0]+o*e[2*4+1]+i*e[2*4+2],r}function Wr(e,t){return qt(e,t,No),e}function Kr(e,t){return qt(e,Ro(t),Ei),e}function Zr(e,t){return qt(e,t,Co),e}function qr(e,t){return Object.keys(e).forEach(function(r){let n=e[r];r.indexOf("pos")>=0?Zr(n,t):r.indexOf("tan")>=0||r.indexOf("binorm")>=0?Wr(n,t):r.indexOf("norm")>=0&&Kr(n,t)}),e}function Qt(e,t,r){return e=e||2,t=t||0,r=r||0,e*=.5,{position:{numComponents:2,data:[t+-1*e,r+-1*e,t+1*e,r+-1*e,t+-1*e,r+1*e,t+1*e,r+1*e]},normal:[0,0,1,0,0,1,0,0,1,0,0,1],texcoord:[0,0,1,0,0,1,1,1],indices:[0,1,2,2,1,3]}}function Jt(e,t,r,n,o){e=e||1,t=t||1,r=r||1,n=n||1,o=o||Mo();let i=(r+1)*(n+1),c=M(3,i),a=M(3,i),s=M(2,i);for(let m=0;m<=n;m++)for(let y=0;y<=r;y++){let h=y/r,l=m/n;c.push(e*h-e*.5,0,t*l-t*.5),a.push(0,1,0),s.push(h,l)}let f=r+1,u=M(3,r*n*2,Uint16Array);for(let m=0;m<n;m++)for(let y=0;y<r;y++)u.push((m+0)*f+y,(m+1)*f+y,(m+0)*f+y+1),u.push((m+1)*f+y,(m+1)*f+y+1,(m+0)*f+y+1);return qr({position:c,normal:a,texcoord:s,indices:u},o)}function er(e,t,r,n,o,i,c){if(t<=0||r<=0)throw new Error("subdivisionAxis and subdivisionHeight must be > 0");n=n||0,o=o||Math.PI,i=i||0,c=c||Math.PI*2;let a=o-n,s=c-i,f=(t+1)*(r+1),u=M(3,f),p=M(3,f),m=M(2,f);for(let l=0;l<=r;l++)for(let x=0;x<=t;x++){let b=x/t,_=l/r,E=s*b+i,v=a*_+n,T=Math.sin(E),A=Math.cos(E),d=Math.sin(v),g=Math.cos(v),w=A*d,F=g,I=T*d;u.push(e*w,e*F,e*I),p.push(w,F,I),m.push(1-b,_)}let y=t+1,h=M(3,t*r*2,Uint16Array);for(let l=0;l<t;l++)for(let x=0;x<r;x++)h.push((x+0)*y+l,(x+0)*y+l+1,(x+1)*y+l),h.push((x+1)*y+l,(x+0)*y+l+1,(x+1)*y+l+1);return{position:u,normal:p,texcoord:m,indices:h}}var Ti=[[3,7,5,1],[6,2,0,4],[6,7,3,2],[0,1,5,4],[7,6,4,5],[2,3,1,0]];function tr(e){e=e||1;let t=e/2,r=[[-t,-t,-t],[+t,-t,-t],[-t,+t,-t],[+t,+t,-t],[-t,-t,+t],[+t,-t,+t],[-t,+t,+t],[+t,+t,+t]],n=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],o=[[1,0],[0,0],[0,1],[1,1]],i=6*4,c=M(3,i),a=M(3,i),s=M(2,i),f=M(3,6*2,Uint16Array);for(let u=0;u<6;++u){let p=Ti[u];for(let y=0;y<4;++y){let h=r[p[y]],l=n[u],x=o[y];c.push(h),a.push(l),s.push(x)}let m=4*u;f.push(m+0,m+1,m+2),f.push(m+0,m+2,m+3)}return{position:c,normal:a,texcoord:s,indices:f}}function rt(e,t,r,n,o,i,c){if(n<3)throw new Error("radialSubdivisions must be 3 or greater");if(o<1)throw new Error("verticalSubdivisions must be 1 or greater");let a=i===void 0?!0:i,s=c===void 0?!0:c,f=(a?2:0)+(s?2:0),u=(n+1)*(o+1+f),p=M(3,u),m=M(3,u),y=M(2,u),h=M(3,n*(o+f/2)*2,Uint16Array),l=n+1,x=Math.atan2(e-t,r),b=Math.cos(x),_=Math.sin(x),E=a?-2:0,v=o+(s?2:0);for(let T=E;T<=v;++T){let A=T/o,d=r*A,g;T<0?(d=0,A=1,g=e):T>o?(d=r,A=1,g=t):g=e+(t-e)*(T/o),(T===-2||T===o+2)&&(g=0,A=0),d-=r/2;for(let w=0;w<l;++w){let F=Math.sin(w*Math.PI*2/n),I=Math.cos(w*Math.PI*2/n);p.push(F*g,d,I*g),T<0?m.push(0,-1,0):T>o?m.push(0,1,0):g===0?m.push(0,0,0):m.push(F*b,_,I*b),y.push(w/n,1-A)}}for(let T=0;T<o+f;++T)if(!(T===1&&a||T===o+f-2&&s))for(let A=0;A<n;++A)h.push(l*(T+0)+0+A,l*(T+0)+1+A,l*(T+1)+1+A),h.push(l*(T+0)+0+A,l*(T+1)+1+A,l*(T+1)+0+A);return{position:p,normal:m,texcoord:y,indices:h}}function Fr(e,t){t=t||[];let r=[];for(let n=0;n<e.length;n+=4){let o=e[n],i=e.slice(n+1,n+4);i.push.apply(i,t);for(let c=0;c<o;++c)r.push.apply(r,i)}return r}function rr(){let e=[0,0,0,0,150,0,30,0,0,0,150,0,30,150,0,30,0,0,30,0,0,30,30,0,100,0,0,30,30,0,100,30,0,100,0,0,30,60,0,30,90,0,67,60,0,30,90,0,67,90,0,67,60,0,0,0,30,30,0,30,0,150,30,0,150,30,30,0,30,30,150,30,30,0,30,100,0,30,30,30,30,30,30,30,100,0,30,100,30,30,30,60,30,67,60,30,30,90,30,30,90,30,67,60,30,67,90,30,0,0,0,100,0,0,100,0,30,0,0,0,100,0,30,0,0,30,100,0,0,100,30,0,100,30,30,100,0,0,100,30,30,100,0,30,30,30,0,30,30,30,100,30,30,30,30,0,100,30,30,100,30,0,30,30,0,30,60,30,30,30,30,30,30,0,30,60,0,30,60,30,30,60,0,67,60,30,30,60,30,30,60,0,67,60,0,67,60,30,67,60,0,67,90,30,67,60,30,67,60,0,67,90,0,67,90,30,30,90,0,30,90,30,67,90,30,30,90,0,67,90,30,67,90,0,30,90,0,30,150,30,30,90,30,30,90,0,30,150,0,30,150,30,0,150,0,0,150,30,30,150,30,0,150,0,30,150,30,30,150,0,0,0,0,0,0,30,0,150,30,0,0,0,0,150,30,0,150,0],t=[.22,.19,.22,.79,.34,.19,.22,.79,.34,.79,.34,.19,.34,.19,.34,.31,.62,.19,.34,.31,.62,.31,.62,.19,.34,.43,.34,.55,.49,.43,.34,.55,.49,.55,.49,.43,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0],r=Fr([18,0,0,1,18,0,0,-1,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,-1,0,6,-1,0,0]),n=Fr([18,200,70,120,18,80,70,200,6,70,200,210,6,200,200,70,6,210,100,70,6,210,160,70,6,70,180,210,6,100,70,210,6,76,210,100,6,140,210,80,6,90,130,110,6,160,160,220],[255]),o=e.length/3,i={position:M(3,o),texcoord:M(2,o),normal:M(3,o),color:M(4,o,Uint8Array),indices:M(3,o/3,Uint16Array)};i.position.push(e),i.texcoord.push(t),i.normal.push(r),i.color.push(n);for(let c=0;c<o;++c)i.indices.push(c);return i}function nt(e,t,r,n,o,i,c){if(o<=0)throw new Error("subdivisionDown must be > 0");i=i||0,c=c||1;let a=2,s=c-i,f=(o+1)*2*(2+a),u=M(3,f),p=M(3,f),m=M(2,f);function y(_,E,v){return _+(E-_)*v}function h(_,E,v,T,A,d){for(let g=0;g<=o;g++){let w=E/(a-1),F=g/o,I=(w-.5)*2,R=(i+F*s)*Math.PI,C=Math.sin(R),P=Math.cos(R),z=y(e,_,C),$=I*n,H=P*e,K=C*z;u.push($,H,K);let Z=Po(Io([0,C,P],v),T);p.push(Z),m.push(w*A+d,F)}}for(let _=0;_<a;_++){let E=(_/(a-1)-.5)*2;h(t,_,[1,1,1],[0,0,0],1,0),h(t,_,[0,0,0],[E,0,0],0,0),h(r,_,[1,1,1],[0,0,0],1,0),h(r,_,[0,0,0],[E,0,0],0,1)}let l=M(3,o*2*(2+a),Uint16Array);function x(_,E){for(let v=0;v<o;++v)l.push(_+v+0,_+v+1,E+v+0),l.push(_+v+1,E+v+1,E+v+0)}let b=o+1;return x(b*0,b*4),x(b*5,b*7),x(b*6,b*2),x(b*3,b*1),{position:u,normal:p,texcoord:m,indices:l}}function nr(e,t,r,n,o,i){return rt(e,e,t,r,n,o,i)}function or(e,t,r,n,o,i){if(r<3)throw new Error("radialSubdivisions must be 3 or greater");if(n<3)throw new Error("verticalSubdivisions must be 3 or greater");o=o||0,i=i||Math.PI*2;let c=i-o,a=r+1,s=n+1,f=a*s,u=M(3,f),p=M(3,f),m=M(2,f),y=M(3,r*n*2,Uint16Array);for(let h=0;h<s;++h){let l=h/n,x=l*Math.PI*2,b=Math.sin(x),_=e+b*t,E=Math.cos(x),v=E*t;for(let T=0;T<a;++T){let A=T/r,d=o+A*c,g=Math.sin(d),w=Math.cos(d),F=g*_,I=w*_,R=g*b,C=w*b;u.push(F,v,I),p.push(R,E,C),m.push(A,1-l)}}for(let h=0;h<n;++h)for(let l=0;l<r;++l){let x=1+l,b=1+h;y.push(a*h+l,a*b+l,a*h+x),y.push(a*b+l,a*b+x,a*h+x)}return{position:u,normal:p,texcoord:m,indices:y}}function ir(e,t,r,n,o){if(t<3)throw new Error("divisions must be at least 3");r=r||1,o=o||1,n=n||0;let i=(t+1)*(r+1),c=M(3,i),a=M(3,i),s=M(2,i),f=M(3,r*t*2,Uint16Array),u=0,p=e-n,m=t+1;for(let y=0;y<=r;++y){let h=n+p*Math.pow(y/r,o);for(let l=0;l<=t;++l){let x=2*Math.PI*l/t,b=h*Math.cos(x),_=h*Math.sin(x);if(c.push(b,0,_),a.push(0,1,0),s.push(1-l/t,y/r),y>0&&l!==t){let E=u+(l+1),v=u+l,T=u+l-m,A=u+(l+1)-m;f.push(E,v,T),f.push(E,T,A)}}u+=t+1}return{position:c,normal:a,texcoord:s,indices:f}}function _i(e){return Math.random()*e|0}function vi(e,t){t=t||{};let r=e.position.numElements,n=M(4,r,Uint8Array),o=t.rand||function(i,c){return c<3?_i(256):255};if(e.color=n,e.indices)for(let i=0;i<r;++i)n.push(o(i,0),o(i,1),o(i,2),o(i,3));else{let i=t.vertsPerColor||3,c=r/i;for(let a=0;a<c;++a){let s=[o(a,0),o(a,1),o(a,2),o(a,3)];for(let f=0;f<i;++f)n.push(s)}}return e}function Y(e){return function(t){let r=e.apply(this,Array.prototype.slice.call(arguments,1));return xi(t,r)}}function W(e){return function(t){let r=e.apply(null,Array.prototype.slice.call(arguments,1));return Zt(t,r)}}var Ai=["numComponents","size","type","normalize","stride","offset","attrib","name","attribName"];function St(e,t,r,n){n=n||0;let o=e.length;for(let i=0;i<o;++i)t[r+i]=e[i]+n}function Qr(e,t){let r=ue(e),n=new r.constructor(t),o=n;return r.numComponents&&r.numElements&&Yr(n,r.numComponents),e.data&&(o={data:n},$o(Ai,e,o)),o}function gi(e){let t={},r;for(let a=0;a<e.length;++a){let s=e[a];Object.keys(s).forEach(function(f){t[f]||(t[f]=[]),!r&&f!=="indices"&&(r=f);let u=s[f],p=hi(u,f),y=ue(u).length/p;t[f].push(y)})}function n(a){let s=0,f;for(let u=0;u<e.length;++u){let m=e[u][a],y=ue(m);s+=y.length,(!f||m.data)&&(f=m)}return{length:s,spec:f}}function o(a,s,f){let u=0,p=0;for(let m=0;m<e.length;++m){let h=e[m][a],l=ue(h);a==="indices"?(St(l,f,p,u),u+=s[m]):St(l,f,p),p+=l.length}}let i=t[r],c={};return Object.keys(t).forEach(function(a){let s=n(a),f=Qr(s.spec,s.length);o(a,i,ue(f)),c[a]=f}),c}function di(e){let t={};return Object.keys(e).forEach(function(r){let n=e[r],o=ue(n),i=Qr(n,o.length);St(o,ue(i),0),t[r]=i}),t}var wi=W(rr),Si=Y(rr),Fi=W(tr),Pi=Y(tr),Ii=W(Jt),Mi=Y(Jt),Ri=W(er),Ci=Y(er),Ni=W(rt),Bi=Y(rt),Li=W(Qt),Ui=Y(Qt),Jr=W(nt),en=Y(nt),Di=W(nr),zi=Y(nr),Oi=W(or),Gi=Y(or),Vi=W(ir),ki=Y(ir),$i=Jr,Hi=en,ji=nt,ot=Object.freeze({__proto__:null,create3DFBufferInfo:wi,create3DFBuffers:Si,create3DFVertices:rr,createAugmentedTypedArray:M,createCubeBufferInfo:Fi,createCubeBuffers:Pi,createCubeVertices:tr,createPlaneBufferInfo:Ii,createPlaneBuffers:Mi,createPlaneVertices:Jt,createSphereBufferInfo:Ri,createSphereBuffers:Ci,createSphereVertices:er,createTruncatedConeBufferInfo:Ni,createTruncatedConeBuffers:Bi,createTruncatedConeVertices:rt,createXYQuadBufferInfo:Li,createXYQuadBuffers:Ui,createXYQuadVertices:Qt,createCresentBufferInfo:$i,createCresentBuffers:Hi,createCresentVertices:ji,createCrescentBufferInfo:Jr,createCrescentBuffers:en,createCrescentVertices:nt,createCylinderBufferInfo:Di,createCylinderBuffers:zi,createCylinderVertices:nr,createTorusBufferInfo:Oi,createTorusBuffers:Gi,createTorusVertices:or,createDiscBufferInfo:Vi,createDiscBuffers:ki,createDiscVertices:ir,deindexVertices:yi,flattenNormals:bi,makeRandomVertexColors:vi,reorientDirections:Wr,reorientNormals:Kr,reorientPositions:Zr,reorientVertices:qr,concatVertices:gi,duplicateVertices:di});function Ce(e){return!!e.texStorage2D}var tn=function(){let e={},t={};function r(n){let o=n.constructor.name;if(!e[o]){for(let i in n)if(typeof n[i]=="number"){let c=t[n[i]];t[n[i]]=c?`${c} | ${i}`:i}e[o]=!0}}return function(o,i){return r(o),t[i]||(typeof i=="number"?`0x${i.toString(16)}`:i)}}();var ne={textureColor:new Uint8Array([128,192,255,255]),textureOptions:{},crossOrigin:void 0},Me=Ie,rn=function(){let e;return function(){return e=e||(typeof document<"u"&&document.createElement?document.createElement("canvas").getContext("2d"):null),e}}(),Ft=6406,j=6407,B=6408,Pt=6409,It=6410,ve=6402,Mt=34041,Ze=33071,Xi=9728,Yi=9729,oe=3553,re=34067,me=32879,xe=35866,cr=34069,Wi=34070,Ki=34071,Zi=34072,qi=34073,Qi=34074,Rt=10241,Ct=10240,qe=10242,Qe=10243,Pr=32882,Ji=33082,ec=33083,tc=33084,rc=33085,ar=3317,nn=3314,on=32878,cn=3316,an=3315,sn=32877,nc=37443,oc=37441,ic=37440,cc=33321,ac=36756,sc=33325,fc=33326,lc=33330,uc=33329,mc=33338,xc=33337,hc=33340,pc=33339,yc=33323,bc=36757,Ec=33327,Tc=33328,_c=33336,vc=33335,Ac=33332,gc=33331,dc=33334,wc=33333,Sc=32849,Fc=35905,Pc=36194,Ic=36758,Mc=35898,Rc=35901,Cc=34843,Nc=34837,Bc=36221,Lc=36239,Uc=36215,Dc=36233,zc=36209,Oc=36227,Gc=32856,Vc=35907,kc=36759,$c=32855,Hc=32854,jc=32857,Xc=34842,Yc=34836,Wc=36220,Kc=36238,Zc=36975,qc=36214,Qc=36232,Jc=36226,ea=36208,ta=33189,ra=33190,na=36012,oa=36013,ia=35056,J=5120,L=5121,Ye=5122,_e=5123,We=5124,ae=5125,G=5126,Ir=32819,Mr=32820,Rr=33635,X=5131,we=36193,dt=33640,ca=35899,aa=35902,sa=36269,fa=34042,Se=33319,se=33320,Fe=6403,fe=36244,le=36248,ee=36249,la={};{let e=la;e[Ft]={numColorComponents:1},e[Pt]={numColorComponents:1},e[It]={numColorComponents:2},e[j]={numColorComponents:3},e[B]={numColorComponents:4},e[Fe]={numColorComponents:1},e[fe]={numColorComponents:1},e[Se]={numColorComponents:2},e[se]={numColorComponents:2},e[j]={numColorComponents:3},e[le]={numColorComponents:3},e[B]={numColorComponents:4},e[ee]={numColorComponents:4},e[ve]={numColorComponents:1},e[Mt]={numColorComponents:2}}var wt;function it(e){if(!wt){let t={};t[Ft]={textureFormat:Ft,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[L,X,we,G]},t[Pt]={textureFormat:Pt,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[L,X,we,G]},t[It]={textureFormat:It,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4,4,8],type:[L,X,we,G]},t[j]={textureFormat:j,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,6,6,12,2],type:[L,X,we,G,Rr]},t[B]={textureFormat:B,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,8,8,16,2,2],type:[L,X,we,G,Ir,Mr]},t[ve]={textureFormat:ve,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[ae,_e]},t[cc]={textureFormat:Fe,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1],type:[L]},t[ac]={textureFormat:Fe,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[1],type:[J]},t[sc]={textureFormat:Fe,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4,2],type:[G,X]},t[fc]={textureFormat:Fe,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[4],type:[G]},t[lc]={textureFormat:fe,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[L]},t[uc]={textureFormat:fe,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[J]},t[Ac]={textureFormat:fe,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[_e]},t[gc]={textureFormat:fe,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[Ye]},t[dc]={textureFormat:fe,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[ae]},t[wc]={textureFormat:fe,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[We]},t[yc]={textureFormat:Se,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2],type:[L]},t[bc]={textureFormat:Se,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[2],type:[J]},t[Ec]={textureFormat:Se,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[8,4],type:[G,X]},t[Tc]={textureFormat:Se,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[8],type:[G]},t[_c]={textureFormat:se,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[L]},t[vc]={textureFormat:se,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[J]},t[mc]={textureFormat:se,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[_e]},t[xc]={textureFormat:se,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Ye]},t[hc]={textureFormat:se,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[ae]},t[pc]={textureFormat:se,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[We]},t[Sc]={textureFormat:j,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3],type:[L]},t[Fc]={textureFormat:j,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[L]},t[Pc]={textureFormat:j,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,2],type:[L,Rr]},t[Ic]={textureFormat:j,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[J]},t[Mc]={textureFormat:j,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[G,X,ca]},t[Rc]={textureFormat:j,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[G,X,aa]},t[Cc]={textureFormat:j,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6],type:[G,X]},t[Nc]={textureFormat:j,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[G]},t[Bc]={textureFormat:le,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[L]},t[Lc]={textureFormat:le,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[J]},t[Uc]={textureFormat:le,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[_e]},t[Dc]={textureFormat:le,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[Ye]},t[zc]={textureFormat:le,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[ae]},t[Oc]={textureFormat:le,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[We]},t[Gc]={textureFormat:B,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[L]},t[Vc]={textureFormat:B,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[L]},t[kc]={textureFormat:B,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4],type:[J]},t[$c]={textureFormat:B,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2,4],type:[L,Mr,dt]},t[Hc]={textureFormat:B,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2],type:[L,Ir]},t[jc]={textureFormat:B,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[dt]},t[Xc]={textureFormat:B,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[16,8],type:[G,X]},t[Yc]={textureFormat:B,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[16],type:[G]},t[Wc]={textureFormat:ee,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[L]},t[Kc]={textureFormat:ee,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[J]},t[Zc]={textureFormat:ee,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[dt]},t[qc]={textureFormat:ee,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[_e]},t[Qc]={textureFormat:ee,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Ye]},t[Jc]={textureFormat:ee,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[We]},t[ea]={textureFormat:ee,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[ae]},t[ta]={textureFormat:ve,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[_e,ae]},t[ra]={textureFormat:ve,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[ae]},t[na]={textureFormat:ve,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[G]},t[ia]={textureFormat:Mt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[fa]},t[oa]={textureFormat:Mt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[sa]},Object.keys(t).forEach(function(r){let n=t[r];n.bytesPerElementMap={},n.bytesPerElement.forEach(function(o,i){let c=n.type[i];n.bytesPerElementMap[c]=o})}),wt=t}return wt[e]}function ua(e,t){let r=it(e);if(!r)throw"unknown internal format";let n=r.bytesPerElementMap[t];if(n===void 0)throw"unknown internal format";return n}function Ne(e){let t=it(e);if(!t)throw"unknown internal format";return{format:t.textureFormat,type:t.type[0]}}function Cr(e){return(e&e-1)===0}function ma(e,t,r,n){if(!Ce(e))return Cr(t)&&Cr(r);let o=it(n);if(!o)throw"unknown internal format";return o.colorRenderable&&o.textureFilterable}function xa(e){let t=it(e);if(!t)throw"unknown internal format";return t.textureFilterable}function ha(e,t,r){return Me(t)?et(t):r||L}function Ke(e,t,r,n,o){if(o%1!==0)throw"can't guess dimensions";if(!r&&!n){let i=Math.sqrt(o/(t===re?6:1));i%1===0?(r=i,n=i):(r=o,n=1)}else if(n){if(!r&&(r=o/n,r%1))throw"can't guess dimensions"}else if(n=o/r,n%1)throw"can't guess dimensions";return{width:r,height:n}}function ge(e,t){t.colorspaceConversion!==void 0&&e.pixelStorei(nc,t.colorspaceConversion),t.premultiplyAlpha!==void 0&&e.pixelStorei(oc,t.premultiplyAlpha),t.flipY!==void 0&&e.pixelStorei(ic,t.flipY)}function fn(e){e.pixelStorei(ar,4),Ce(e)&&(e.pixelStorei(nn,0),e.pixelStorei(on,0),e.pixelStorei(cn,0),e.pixelStorei(an,0),e.pixelStorei(sn,0))}function pa(e,t,r,n){n.minMag&&(r.call(e,t,Rt,n.minMag),r.call(e,t,Ct,n.minMag)),n.min&&r.call(e,t,Rt,n.min),n.mag&&r.call(e,t,Ct,n.mag),n.wrap&&(r.call(e,t,qe,n.wrap),r.call(e,t,Qe,n.wrap),(t===me||jo(e,t))&&r.call(e,t,Pr,n.wrap)),n.wrapR&&r.call(e,t,Pr,n.wrapR),n.wrapS&&r.call(e,t,qe,n.wrapS),n.wrapT&&r.call(e,t,Qe,n.wrapT),n.minLod&&r.call(e,t,Ji,n.minLod),n.maxLod&&r.call(e,t,ec,n.maxLod),n.baseLevel&&r.call(e,t,tc,n.baseLevel),n.maxLevel&&r.call(e,t,rc,n.maxLevel)}function ln(e,t,r){let n=r.target||oe;e.bindTexture(n,t),pa(e,n,e.texParameteri,r)}function ya(e){return e=e||ne.textureColor,Me(e)?e:new Uint8Array([e[0]*255,e[1]*255,e[2]*255,e[3]*255])}function Nt(e,t,r,n,o,i){r=r||ne.textureOptions,i=i||B;let c=r.target||oe;if(n=n||r.width,o=o||r.height,e.bindTexture(c,t),ma(e,n,o,i))e.generateMipmap(c);else{let a=xa(i)?Yi:Xi;e.texParameteri(c,Rt,a),e.texParameteri(c,Ct,a),e.texParameteri(c,qe,Ze),e.texParameteri(c,Qe,Ze)}}function Re(e){return e.auto===!0||e.auto===void 0&&e.level===void 0}function Bt(e,t){return t=t||{},t.cubeFaceOrder||[cr,Wi,Ki,Zi,qi,Qi]}function Lt(e,t){let n=Bt(e,t).map(function(o,i){return{face:o,ndx:i}});return n.sort(function(o,i){return o.face-i.face}),n}function un(e,t,r,n){n=n||ne.textureOptions;let o=n.target||oe,i=n.level||0,c=r.width,a=r.height,s=n.internalFormat||n.format||B,f=Ne(s),u=n.format||f.format,p=n.type||f.type;if(ge(e,n),e.bindTexture(o,t),o===re){let m=r.width,y=r.height,h,l;if(m/6===y)h=y,l=[0,0,1,0,2,0,3,0,4,0,5,0];else if(y/6===m)h=m,l=[0,0,0,1,0,2,0,3,0,4,0,5];else if(m/3===y/2)h=m/3,l=[0,0,1,0,2,0,0,1,1,1,2,1];else if(m/2===y/3)h=m/2,l=[0,0,1,0,0,1,1,1,0,2,1,2];else throw"can't figure out cube map from element: "+(r.src?r.src:r.nodeName);let x=rn();x?(x.canvas.width=h,x.canvas.height=h,c=h,a=h,Lt(e,n).forEach(function(b){let _=l[b.ndx*2+0]*h,E=l[b.ndx*2+1]*h;x.drawImage(r,_,E,h,h,0,0,h,h),e.texImage2D(b.face,i,s,u,p,x.canvas)}),x.canvas.width=1,x.canvas.height=1):typeof createImageBitmap<"u"&&(c=h,a=h,Lt(e,n).forEach(function(b){let _=l[b.ndx*2+0]*h,E=l[b.ndx*2+1]*h;e.texImage2D(b.face,i,s,h,h,0,u,p,null),createImageBitmap(r,_,E,h,h,{premultiplyAlpha:"none",colorSpaceConversion:"none"}).then(function(v){ge(e,n),e.bindTexture(o,t),e.texImage2D(b.face,i,s,u,p,v),Re(n)&&Nt(e,t,n,c,a,s)})}))}else if(o===me||o===xe){let m=Math.min(r.width,r.height),y=Math.max(r.width,r.height),h=y/m;if(h%1!==0)throw"can not compute 3D dimensions of element";let l=r.width===y?1:0,x=r.height===y?1:0;e.pixelStorei(ar,1),e.pixelStorei(nn,r.width),e.pixelStorei(on,0),e.pixelStorei(sn,0),e.texImage3D(o,i,s,m,m,m,0,u,p,null);for(let b=0;b<h;++b){let _=b*m*l,E=b*m*x;e.pixelStorei(cn,_),e.pixelStorei(an,E),e.texSubImage3D(o,i,0,0,b,m,m,1,u,p,r)}fn(e)}else e.texImage2D(o,i,s,u,p,r);Re(n)&&Nt(e,t,n,c,a,s),ln(e,t,n)}function Be(){}function ba(e){if(typeof document<"u"){let t=document.createElement("a");return t.href=e,t.hostname===location.hostname&&t.port===location.port&&t.protocol===location.protocol}else{let t=new URL(location.href).origin;return new URL(e,location.href).origin===t}}function Ea(e,t){return t===void 0&&!ba(e)?"anonymous":t}function Ta(e,t,r){r=r||Be;let n;if(t=t!==void 0?t:ne.crossOrigin,t=Ea(e,t),typeof Image<"u"){n=new Image,t!==void 0&&(n.crossOrigin=t);let o=function(){n.removeEventListener("error",i),n.removeEventListener("load",c),n=null},i=function(){let s="couldn't load image: "+e;Gr(s),r(s,n),o()},c=function(){r(null,n),o()};return n.addEventListener("error",i),n.addEventListener("load",c),n.src=e,n}else if(typeof ImageBitmap<"u"){let o,i,c=function(){r(o,i)},a={};t&&(a.mode="cors"),fetch(e,a).then(function(s){if(!s.ok)throw s;return s.blob()}).then(function(s){return createImageBitmap(s,{premultiplyAlpha:"none",colorSpaceConversion:"none"})}).then(function(s){i=s,setTimeout(c)}).catch(function(s){o=s,setTimeout(c)}),n=null}return n}function mn(e){return typeof ImageBitmap<"u"&&e instanceof ImageBitmap||typeof ImageData<"u"&&e instanceof ImageData||typeof HTMLElement<"u"&&e instanceof HTMLElement}function sr(e,t,r){return mn(e)?(setTimeout(function(){r(null,e)}),e):Ta(e,t,r)}function fr(e,t,r){r=r||ne.textureOptions;let n=r.target||oe;if(e.bindTexture(n,t),r.color===!1)return;let o=ya(r.color);if(n===re)for(let i=0;i<6;++i)e.texImage2D(cr+i,0,B,1,1,0,B,L,o);else n===me||n===xe?e.texImage3D(n,0,B,1,1,1,0,B,L,o):e.texImage2D(n,0,B,1,1,0,B,L,o)}function _a(e,t,r,n){return n=n||Be,r=r||ne.textureOptions,fr(e,t,r),r=Object.assign({},r),sr(r.src,r.crossOrigin,function(i,c){i?n(i,t,c):(un(e,t,c,r),n(null,t,c))})}function va(e,t,r,n){n=n||Be;let o=r.src;if(o.length!==6)throw"there must be 6 urls for a cubemap";let i=r.level||0,c=r.internalFormat||r.format||B,a=Ne(c),s=r.format||a.format,f=r.type||L,u=r.target||oe;if(u!==re)throw"target must be TEXTURE_CUBE_MAP";fr(e,t,r),r=Object.assign({},r);let p=6,m=[],y=Bt(e,r),h;function l(x){return function(b,_){--p,b?m.push(b):_.width!==_.height?m.push("cubemap face img is not a square: "+_.src):(ge(e,r),e.bindTexture(u,t),p===5?Bt().forEach(function(E){e.texImage2D(E,i,c,s,f,_)}):e.texImage2D(x,i,c,s,f,_),Re(r)&&e.generateMipmap(u)),p===0&&n(m.length?m:void 0,t,h)}}h=o.map(function(x,b){return sr(x,r.crossOrigin,l(y[b]))})}function Aa(e,t,r,n){n=n||Be;let o=r.src,i=r.internalFormat||r.format||B,c=Ne(i),a=r.format||c.format,s=r.type||L,f=r.target||xe;if(f!==me&&f!==xe)throw"target must be TEXTURE_3D or TEXTURE_2D_ARRAY";fr(e,t,r),r=Object.assign({},r);let u=o.length,p=[],m,y=r.level||0,h=r.width,l=r.height,x=o.length,b=!0;function _(E){return function(v,T){if(--u,v)p.push(v);else{if(ge(e,r),e.bindTexture(f,t),b){b=!1,h=r.width||T.width,l=r.height||T.height,e.texImage3D(f,y,i,h,l,x,0,a,s,null);for(let A=0;A<x;++A)e.texSubImage3D(f,y,0,0,A,h,l,1,a,s,T)}else{let A=T,d;(T.width!==h||T.height!==l)&&(d=rn(),A=d.canvas,d.canvas.width=h,d.canvas.height=l,d.drawImage(T,0,0,h,l)),e.texSubImage3D(f,y,0,0,E,h,l,1,a,s,A),d&&A===d.canvas&&(d.canvas.width=0,d.canvas.height=0)}Re(r)&&e.generateMipmap(f)}u===0&&n(p.length?p:void 0,t,m)}}m=o.map(function(E,v){return sr(E,r.crossOrigin,_(v))})}function ga(e,t,r,n){n=n||ne.textureOptions;let o=n.target||oe;e.bindTexture(o,t);let i=n.width,c=n.height,a=n.depth,s=n.level||0,f=n.internalFormat||n.format||B,u=Ne(f),p=n.format||u.format,m=n.type||ha(e,r,u.type);if(Me(r))r instanceof Uint8ClampedArray&&(r=new Uint8Array(r.buffer));else{let x=Or(m);r=new x(r)}let y=ua(f,m),h=r.byteLength/y;if(h%1)throw"length wrong size for format: "+tn(e,p);let l;if(o===me||o===xe)if(!i&&!c&&!a){let x=Math.cbrt(h);if(x%1!==0)throw"can't guess cube size of array of numElements: "+h;i=x,c=x,a=x}else i&&(!c||!a)?(l=Ke(e,o,c,a,h/i),c=l.width,a=l.height):c&&(!i||!a)?(l=Ke(e,o,i,a,h/c),i=l.width,a=l.height):(l=Ke(e,o,i,c,h/a),i=l.width,c=l.height);else l=Ke(e,o,i,c,h),i=l.width,c=l.height;if(fn(e),e.pixelStorei(ar,n.unpackAlignment||1),ge(e,n),o===re){let x=y/r.BYTES_PER_ELEMENT,b=h/6*x;Lt(e,n).forEach(_=>{let E=b*_.ndx,v=r.subarray(E,E+b);e.texImage2D(_.face,s,f,i,c,0,p,m,v)})}else o===me||o===xe?e.texImage3D(o,s,f,i,c,a,0,p,m,r):e.texImage2D(o,s,f,i,c,0,p,m,r);return{width:i,height:c,depth:a,type:m}}function da(e,t,r){let n=r.target||oe;e.bindTexture(n,t);let o=r.level||0,i=r.internalFormat||r.format||B,c=Ne(i),a=r.format||c.format,s=r.type||c.type;if(ge(e,r),n===re)for(let f=0;f<6;++f)e.texImage2D(cr+f,o,i,r.width,r.height,0,a,s,null);else n===me||n===xe?e.texImage3D(n,o,i,r.width,r.height,r.depth,0,a,s,null):e.texImage2D(n,o,i,r.width,r.height,0,a,s,null)}function lr(e,t,r){r=r||Be,t=t||ne.textureOptions;let n=e.createTexture(),o=t.target||oe,i=t.width||1,c=t.height||1,a=t.internalFormat||B;e.bindTexture(o,n),o===re&&(e.texParameteri(o,qe,Ze),e.texParameteri(o,Qe,Ze));let s=t.src;if(s)if(typeof s=="function"&&(s=s(e,t)),typeof s=="string")_a(e,n,t,r);else if(Me(s)||Array.isArray(s)&&(typeof s[0]=="number"||Array.isArray(s[0])||Me(s[0]))){let f=ga(e,n,s,t);i=f.width,c=f.height}else Array.isArray(s)&&(typeof s[0]=="string"||mn(s[0]))?o===re?va(e,n,t,r):Aa(e,n,t,r):(un(e,n,s,t),i=s.width,c=s.height);else da(e,n,t);return Re(t)&&Nt(e,n,t,i,c,a),ln(e,n,t),n}var ur=Gr;function xn(e){return typeof document<"u"&&document.getElementById?document.getElementById(e):null}var Je=33984;var ct=34962,wa=34963;var Sa=35713,Fa=35714,Pa=35632,Ia=35633,Ma=35981,hn=35718,Ra=35721,Ca=35971,Na=35382,Ba=35396,La=35398,Ua=35392,Da=35395,at=5126,pn=35664,yn=35665,bn=35666,mr=5124,En=35667,Tn=35668,_n=35669,vn=35670,An=35671,gn=35672,dn=35673,wn=35674,Sn=35675,Fn=35676,za=35678,Oa=35680,Ga=35679,Va=35682,ka=35685,$a=35686,Ha=35687,ja=35688,Xa=35689,Ya=35690,Wa=36289,Ka=36292,Za=36293,xr=5125,Pn=36294,In=36295,Mn=36296,qa=36298,Qa=36299,Ja=36300,es=36303,ts=36306,rs=36307,ns=36308,os=36311,st=3553,ft=34067,hr=32879,lt=35866,S={};function Rn(e,t){return S[t].bindPoint}function is(e,t){return function(r){e.uniform1f(t,r)}}function cs(e,t){return function(r){e.uniform1fv(t,r)}}function as(e,t){return function(r){e.uniform2fv(t,r)}}function ss(e,t){return function(r){e.uniform3fv(t,r)}}function fs(e,t){return function(r){e.uniform4fv(t,r)}}function Cn(e,t){return function(r){e.uniform1i(t,r)}}function Nn(e,t){return function(r){e.uniform1iv(t,r)}}function Bn(e,t){return function(r){e.uniform2iv(t,r)}}function Ln(e,t){return function(r){e.uniform3iv(t,r)}}function Un(e,t){return function(r){e.uniform4iv(t,r)}}function ls(e,t){return function(r){e.uniform1ui(t,r)}}function us(e,t){return function(r){e.uniform1uiv(t,r)}}function ms(e,t){return function(r){e.uniform2uiv(t,r)}}function xs(e,t){return function(r){e.uniform3uiv(t,r)}}function hs(e,t){return function(r){e.uniform4uiv(t,r)}}function ps(e,t){return function(r){e.uniformMatrix2fv(t,!1,r)}}function ys(e,t){return function(r){e.uniformMatrix3fv(t,!1,r)}}function bs(e,t){return function(r){e.uniformMatrix4fv(t,!1,r)}}function Es(e,t){return function(r){e.uniformMatrix2x3fv(t,!1,r)}}function Ts(e,t){return function(r){e.uniformMatrix3x2fv(t,!1,r)}}function _s(e,t){return function(r){e.uniformMatrix2x4fv(t,!1,r)}}function vs(e,t){return function(r){e.uniformMatrix4x2fv(t,!1,r)}}function As(e,t){return function(r){e.uniformMatrix3x4fv(t,!1,r)}}function gs(e,t){return function(r){e.uniformMatrix4x3fv(t,!1,r)}}function V(e,t,r,n){let o=Rn(e,t);return Ce(e)?function(i){let c,a;!i||Vr(e,i)?(c=i,a=null):(c=i.texture,a=i.sampler),e.uniform1i(n,r),e.activeTexture(Je+r),e.bindTexture(o,c),e.bindSampler(r,a)}:function(i){e.uniform1i(n,r),e.activeTexture(Je+r),e.bindTexture(o,i)}}function k(e,t,r,n,o){let i=Rn(e,t),c=new Int32Array(o);for(let a=0;a<o;++a)c[a]=r+a;return Ce(e)?function(a){e.uniform1iv(n,c),a.forEach(function(s,f){e.activeTexture(Je+c[f]);let u,p;!s||Vr(e,s)?(u=s,p=null):(u=s.texture,p=s.sampler),e.bindSampler(r,p),e.bindTexture(i,u)})}:function(a){e.uniform1iv(n,c),a.forEach(function(s,f){e.activeTexture(Je+c[f]),e.bindTexture(i,s)})}}S[at]={Type:Float32Array,size:4,setter:is,arraySetter:cs};S[pn]={Type:Float32Array,size:8,setter:as,cols:2};S[yn]={Type:Float32Array,size:12,setter:ss,cols:3};S[bn]={Type:Float32Array,size:16,setter:fs,cols:4};S[mr]={Type:Int32Array,size:4,setter:Cn,arraySetter:Nn};S[En]={Type:Int32Array,size:8,setter:Bn,cols:2};S[Tn]={Type:Int32Array,size:12,setter:Ln,cols:3};S[_n]={Type:Int32Array,size:16,setter:Un,cols:4};S[xr]={Type:Uint32Array,size:4,setter:ls,arraySetter:us};S[Pn]={Type:Uint32Array,size:8,setter:ms,cols:2};S[In]={Type:Uint32Array,size:12,setter:xs,cols:3};S[Mn]={Type:Uint32Array,size:16,setter:hs,cols:4};S[vn]={Type:Uint32Array,size:4,setter:Cn,arraySetter:Nn};S[An]={Type:Uint32Array,size:8,setter:Bn,cols:2};S[gn]={Type:Uint32Array,size:12,setter:Ln,cols:3};S[dn]={Type:Uint32Array,size:16,setter:Un,cols:4};S[wn]={Type:Float32Array,size:32,setter:ps,rows:2,cols:2};S[Sn]={Type:Float32Array,size:48,setter:ys,rows:3,cols:3};S[Fn]={Type:Float32Array,size:64,setter:bs,rows:4,cols:4};S[ka]={Type:Float32Array,size:32,setter:Es,rows:2,cols:3};S[$a]={Type:Float32Array,size:32,setter:_s,rows:2,cols:4};S[Ha]={Type:Float32Array,size:48,setter:Ts,rows:3,cols:2};S[ja]={Type:Float32Array,size:48,setter:As,rows:3,cols:4};S[Xa]={Type:Float32Array,size:64,setter:vs,rows:4,cols:2};S[Ya]={Type:Float32Array,size:64,setter:gs,rows:4,cols:3};S[za]={Type:null,size:0,setter:V,arraySetter:k,bindPoint:st};S[Oa]={Type:null,size:0,setter:V,arraySetter:k,bindPoint:ft};S[Ga]={Type:null,size:0,setter:V,arraySetter:k,bindPoint:hr};S[Va]={Type:null,size:0,setter:V,arraySetter:k,bindPoint:st};S[Wa]={Type:null,size:0,setter:V,arraySetter:k,bindPoint:lt};S[Ka]={Type:null,size:0,setter:V,arraySetter:k,bindPoint:lt};S[Za]={Type:null,size:0,setter:V,arraySetter:k,bindPoint:ft};S[qa]={Type:null,size:0,setter:V,arraySetter:k,bindPoint:st};S[Qa]={Type:null,size:0,setter:V,arraySetter:k,bindPoint:hr};S[Ja]={Type:null,size:0,setter:V,arraySetter:k,bindPoint:ft};S[es]={Type:null,size:0,setter:V,arraySetter:k,bindPoint:lt};S[ts]={Type:null,size:0,setter:V,arraySetter:k,bindPoint:st};S[rs]={Type:null,size:0,setter:V,arraySetter:k,bindPoint:hr};S[ns]={Type:null,size:0,setter:V,arraySetter:k,bindPoint:ft};S[os]={Type:null,size:0,setter:V,arraySetter:k,bindPoint:lt};function ut(e,t){return function(r){if(r.value)switch(e.disableVertexAttribArray(t),r.value.length){case 4:e.vertexAttrib4fv(t,r.value);break;case 3:e.vertexAttrib3fv(t,r.value);break;case 2:e.vertexAttrib2fv(t,r.value);break;case 1:e.vertexAttrib1fv(t,r.value);break;default:throw new Error("the length of a float constant value must be between 1 and 4!")}else e.bindBuffer(ct,r.buffer),e.enableVertexAttribArray(t),e.vertexAttribPointer(t,r.numComponents||r.size,r.type||at,r.normalize||!1,r.stride||0,r.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,r.divisor||0)}}function ie(e,t){return function(r){if(r.value)if(e.disableVertexAttribArray(t),r.value.length===4)e.vertexAttrib4iv(t,r.value);else throw new Error("The length of an integer constant value must be 4!");else e.bindBuffer(ct,r.buffer),e.enableVertexAttribArray(t),e.vertexAttribIPointer(t,r.numComponents||r.size,r.type||mr,r.stride||0,r.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,r.divisor||0)}}function mt(e,t){return function(r){if(r.value)if(e.disableVertexAttribArray(t),r.value.length===4)e.vertexAttrib4uiv(t,r.value);else throw new Error("The length of an unsigned integer constant value must be 4!");else e.bindBuffer(ct,r.buffer),e.enableVertexAttribArray(t),e.vertexAttribIPointer(t,r.numComponents||r.size,r.type||xr,r.stride||0,r.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,r.divisor||0)}}function pr(e,t,r){let n=r.size,o=r.count;return function(i){e.bindBuffer(ct,i.buffer);let c=i.size||i.numComponents||n,a=c/o,s=i.type||at,u=S[s].size*c,p=i.normalize||!1,m=i.offset||0,y=u/o;for(let h=0;h<o;++h)e.enableVertexAttribArray(t+h),e.vertexAttribPointer(t+h,a,s,p,u,m+y*h),e.vertexAttribDivisor&&e.vertexAttribDivisor(t+h,i.divisor||0)}}var D={};D[at]={size:4,setter:ut};D[pn]={size:8,setter:ut};D[yn]={size:12,setter:ut};D[bn]={size:16,setter:ut};D[mr]={size:4,setter:ie};D[En]={size:8,setter:ie};D[Tn]={size:12,setter:ie};D[_n]={size:16,setter:ie};D[xr]={size:4,setter:mt};D[Pn]={size:8,setter:mt};D[In]={size:12,setter:mt};D[Mn]={size:16,setter:mt};D[vn]={size:4,setter:ie};D[An]={size:8,setter:ie};D[gn]={size:12,setter:ie};D[dn]={size:16,setter:ie};D[wn]={size:4,setter:pr,count:2};D[Sn]={size:9,setter:pr,count:3};D[Fn]={size:16,setter:pr,count:4};var ds=/ERROR:\s*\d+:(\d+)/gi;function ws(e,t="",r=0){let n=[...t.matchAll(ds)],o=new Map(n.map((i,c)=>{let a=parseInt(i[1]),s=n[c+1],f=s?s.index:t.length,u=t.substring(i.index,f);return[a-1,u]}));return e.split(`
`).map((i,c)=>{let a=o.get(c);return`${c+1+r}: ${i}${a?`

^^^ ${a}`:""}`}).join(`
`)}var Nr=/^[ \t]*\n/;function Dn(e){let t=0;return Nr.test(e)&&(t=1,e=e.replace(Nr,"")),{lineOffset:t,shaderSource:e}}function Ss(e,t){return e.errorCallback(t),e.callback&&setTimeout(()=>{e.callback(`${t}
${e.errors.join(`
`)}`)}),null}function Fs(e,t,r,n){if(n=n||ur,!e.getShaderParameter(r,Sa)){let i=e.getShaderInfoLog(r),{lineOffset:c,shaderSource:a}=Dn(e.getShaderSource(r)),s=`${ws(a,i,c)}
Error compiling ${tn(e,t)}: ${i}`;return n(s),s}return""}function Le(e,t,r){let n,o,i;if(typeof t=="function"&&(r=t,t=void 0),typeof e=="function")r=e,e=void 0;else if(e&&!Array.isArray(e)){let f=e;r=f.errorCallback,e=f.attribLocations,n=f.transformFeedbackVaryings,o=f.transformFeedbackMode,i=f.callback}let c=r||ur,a=[],s={errorCallback(f,...u){a.push(f),c(f,...u)},transformFeedbackVaryings:n,transformFeedbackMode:o,callback:i,errors:a};{let f={};Array.isArray(e)?e.forEach(function(u,p){f[u]=t?t[p]:p}):f=e||{},s.attribLocations=f}return s}var Ps=["VERTEX_SHADER","FRAGMENT_SHADER"];function Is(e,t){if(t.indexOf("frag")>=0)return Pa;if(t.indexOf("vert")>=0)return Ia}function Ms(e,t,r){let n=e.getAttachedShaders(t);for(let o of n)r.has(o)&&e.deleteShader(o);e.deleteProgram(t)}var Rs=(e=0)=>new Promise(t=>setTimeout(t,e));function zn(e,t,r){let n=e.createProgram(),{attribLocations:o,transformFeedbackVaryings:i,transformFeedbackMode:c}=Le(r);for(let a=0;a<t.length;++a){let s=t[a];if(typeof s=="string"){let f=xn(s),u=f?f.text:s,p=e[Ps[a]];f&&f.type&&(p=Is(e,f.type)||p),s=e.createShader(p),e.shaderSource(s,Dn(u).shaderSource),e.compileShader(s),e.attachShader(n,s)}}Object.entries(o).forEach(([a,s])=>e.bindAttribLocation(n,s,a));{let a=i;a&&(a.attribs&&(a=a.attribs),Array.isArray(a)||(a=Object.keys(a)),e.transformFeedbackVaryings(n,a,c||Ma))}return e.linkProgram(n),n}function On(e,t,r,n,o){let i=Le(r,n,o),c=new Set(t),a=zn(e,t,i);function s(f,u){let p=Vn(f,u,i.errorCallback);return p&&Ms(f,u,c),p}if(i.callback){Gn(e,a).then(()=>{let f=s(e,a);i.callback(f,f?void 0:a)});return}return s(e,a)?void 0:a}function xt(e){return function(t,r,...n){return new Promise((o,i)=>{let c=Le(...n);c.callback=(a,s)=>{a?i(a):o(s)},e(t,r,c)})}}var n0=xt(On),o0=xt(Ue);async function Gn(e,t){let r=e.getExtension("KHR_parallel_shader_compile"),n=r?(i,c)=>i.getProgramParameter(c,r.COMPLETION_STATUS_KHR):()=>!0,o=0;do await Rs(o),o=1e3/60;while(!n(e,t))}async function Cs(e,t){for(let r of Object.values(t))await Gn(e,r)}function Vn(e,t,r){if(r=r||ur,!e.getProgramParameter(t,Fa)){let o=e.getProgramInfoLog(t);r(`Error in program linking: ${o}`);let c=e.getAttachedShaders(t).map(a=>Fs(e,e.getShaderParameter(a,e.SHADER_TYPE),a,r));return`${o}
${c.filter(a=>a).join(`
`)}`}}function Ns(e,t,r,n,o){return On(e,t,r,n,o)}function kn(e){let t=e.name;return t.startsWith("gl_")||t.startsWith("webgl_")}var Bs=/(\.|\[|]|\w+)/g,Ls=e=>e>="0"&&e<="9";function Us(e,t,r,n){let o=e.split(Bs).filter(a=>a!==""),i=0,c="";for(;;){let a=o[i++];c+=a;let s=Ls(a[0]),f=s?parseInt(a):a;if(s&&(c+=o[i++]),i===o.length){r[f]=t;break}else{let p=o[i++],m=p==="[",y=r[f]||(m?[]:{});r[f]=y,r=y,n[c]=n[c]||function(h){return function(l){$n(h,l)}}(y),c+=p}}}function Ds(e,t){let r=0;function n(a,s,f){let u=s.name.endsWith("[0]"),p=s.type,m=S[p];if(!m)throw new Error(`unknown type: 0x${p.toString(16)}`);let y;if(m.bindPoint){let h=r;r+=s.size,u?y=m.arraySetter(e,p,h,f,s.size):y=m.setter(e,p,h,f,s.size)}else m.arraySetter&&u?y=m.arraySetter(e,f):y=m.setter(e,f);return y.location=f,y}let o={},i={},c=e.getProgramParameter(t,hn);for(let a=0;a<c;++a){let s=e.getActiveUniform(t,a);if(kn(s))continue;let f=s.name;f.endsWith("[0]")&&(f=f.substr(0,f.length-3));let u=e.getUniformLocation(t,s.name);if(u){let p=n(t,s,u);o[f]=p,Us(f,p,i,o)}}return o}function zs(e,t){let r={},n=e.getProgramParameter(t,Ca);for(let o=0;o<n;++o){let i=e.getTransformFeedbackVarying(t,o);r[i.name]={index:o,type:i.type,size:i.size}}return r}function Os(e,t){let r=e.getProgramParameter(t,hn),n=[],o=[];for(let a=0;a<r;++a){o.push(a),n.push({});let s=e.getActiveUniform(t,a);n[a].name=s.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach(function(a){let s=a[0],f=a[1];e.getActiveUniforms(t,o,e[s]).forEach(function(u,p){n[p][f]=u})});let i={},c=e.getProgramParameter(t,Na);for(let a=0;a<c;++a){let s=e.getActiveUniformBlockName(t,a),f={index:e.getUniformBlockIndex(t,s),usedByVertexShader:e.getActiveUniformBlockParameter(t,a,Ba),usedByFragmentShader:e.getActiveUniformBlockParameter(t,a,La),size:e.getActiveUniformBlockParameter(t,a,Ua),uniformIndices:e.getActiveUniformBlockParameter(t,a,Da)};f.used=f.usedByVertexShader||f.usedByFragmentShader,i[s]=f}return{blockSpecs:i,uniformData:n}}function $n(e,t){for(let r in t){let n=e[r];typeof n=="function"?n(t[r]):$n(e[r],t[r])}}function q(e,...t){let r=e.uniformSetters||e,n=t.length;for(let o=0;o<n;++o){let i=t[o];if(Array.isArray(i)){let c=i.length;for(let a=0;a<c;++a)q(r,i[a])}else for(let c in i){let a=r[c];a&&a(i[c])}}}function Gs(e,t){let r={},n=e.getProgramParameter(t,Ra);for(let o=0;o<n;++o){let i=e.getActiveAttrib(t,o);if(kn(i))continue;let c=e.getAttribLocation(t,i.name),a=D[i.type],s=a.setter(e,c,a);s.location=c,r[i.name]=s}return r}function Vs(e,t){for(let r in t){let n=e[r];n&&n(t[r])}}function ht(e,t,r){r.vertexArrayObject?e.bindVertexArray(r.vertexArrayObject):(Vs(t.attribSetters||t,r.attribs),r.indices&&e.bindBuffer(wa,r.indices))}function Ut(e,t){let r=Ds(e,t),n=Gs(e,t),o={program:t,uniformSetters:r,attribSetters:n};return Ce(e)&&(o.uniformBlockSpec=Os(e,t),o.transformFeedbackInfo=zs(e,t)),o}var ks=/\s|{|}|;/;function Ue(e,t,r,n,o){let i=Le(r,n,o),c=[];if(t=t.map(function(f){if(!ks.test(f)){let u=xn(f);if(u)f=u.text;else{let p=`no element with id: ${f}`;i.errorCallback(p),c.push(p)}}return f}),c.length)return Ss(i,"");let a=i.callback;a&&(i.callback=(f,u)=>{a(f,f?void 0:Ut(e,u))});let s=Ns(e,t,i);return s?Ut(e,s):null}function Br(e,t,r,n,o){for(let[i,c]of Object.entries(t)){let a={...o},s=r[i];Array.isArray(s)||Object.assign(a,s);let f=Vn(e,c,a.errorCallback);if(f){for(let u of Object.values(t)){let p=e.getAttachedShaders(u);e.deleteProgram(u);for(let m of p)n.has(m)||e.deleteShader(m)}return f}}}function Hn(e,t,r={}){let n=new Set,o=Object.fromEntries(Object.entries(t).map(([c,a])=>{let s={...r},f=Array.isArray(a)?a:a.shaders;return Array.isArray(a)||Object.assign(s,a),f.forEach(n.add,n),[c,zn(e,f,s)]}));if(r.callback){Cs(e,o).then(()=>{let c=Br(e,o,t,n,r);r.callback(c,c?void 0:o)});return}return Br(e,o,t,n,r)?void 0:o}function $s(e,t,r){r=Le(r);function n(c,a){return Object.fromEntries(Object.entries(a).map(([s,f])=>[s,Ut(c,f)]))}let o=r.callback;o&&(r.callback=(c,a)=>{o(c,c?void 0:n(e,a))});let i=Hn(e,t,r);if(!(o||!i))return n(e,i)}var i0=xt(Hn),c0=xt($s);var Hs=4,Lr=5123;function pt(e,t,r,n,o,i){r=r===void 0?Hs:r;let c=t.indices,a=t.elementType,s=n===void 0?t.numElements:n;o=o===void 0?0:o,a||c?i!==void 0?e.drawElementsInstanced(r,s,a===void 0?Lr:t.elementType,o,i):e.drawElements(r,s,a===void 0?Lr:t.elementType,o):i!==void 0?e.drawArraysInstanced(r,o,s,i):e.drawArrays(r,o,s)}var js=6402;var Xs=33190,Ys=36012,Ws=35056,Ks=36013,Zs=32854,qs=32855,Qs=36194,jn=33189,Xn=6401,Yn=36168,Wn=34041;var yt=36096,Kn=36128,yr=33306;var Q={};Q[Wn]=yr;Q[Xn]=Kn;Q[Yn]=Kn;Q[js]=yt;Q[jn]=yt;Q[Xs]=yt;Q[Ys]=yt;Q[Ws]=yr;Q[Ks]=yr;var he={};he[Zs]=!0;he[qs]=!0;he[Qs]=!0;he[Wn]=!0;he[jn]=!0;he[Xn]=!0;he[Yn]=!0;function Zn(e,t){t=t||1,t=Math.max(0,t);let r=e.clientWidth*t|0,n=e.clientHeight*t|0;return e.width!==r||e.height!==n?(e.width=r,e.height=n,!0):!1}var U=1e-6,pe=typeof Float32Array<"u"?Float32Array:Array;var s0=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var N={};So(N,{add:()=>zf,adjoint:()=>sf,clone:()=>tf,copy:()=>rf,create:()=>ef,determinant:()=>ff,equals:()=>kf,exactEquals:()=>Vf,frob:()=>Df,fromQuat:()=>Ff,fromQuat2:()=>Af,fromRotation:()=>Ef,fromRotationTranslation:()=>Jn,fromRotationTranslationScale:()=>wf,fromRotationTranslationScaleOrigin:()=>Sf,fromScaling:()=>bf,fromTranslation:()=>yf,fromValues:()=>nf,fromXRotation:()=>Tf,fromYRotation:()=>_f,fromZRotation:()=>vf,frustum:()=>Pf,getRotation:()=>df,getScaling:()=>eo,getTranslation:()=>gf,identity:()=>qn,invert:()=>af,lookAt:()=>Bf,mul:()=>$f,multiply:()=>Qn,multiplyScalar:()=>Of,multiplyScalarAndAdd:()=>Gf,ortho:()=>Cf,orthoNO:()=>ro,orthoZO:()=>Nf,perspective:()=>If,perspectiveFromFieldOfView:()=>Rf,perspectiveNO:()=>to,perspectiveZO:()=>Mf,rotate:()=>mf,rotateX:()=>xf,rotateY:()=>hf,rotateZ:()=>pf,scale:()=>uf,set:()=>of,str:()=>Uf,sub:()=>Hf,subtract:()=>no,targetTo:()=>Lf,translate:()=>lf,transpose:()=>cf});function ef(){var e=new pe(16);return pe!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function tf(e){var t=new pe(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function rf(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function nf(e,t,r,n,o,i,c,a,s,f,u,p,m,y,h,l){var x=new pe(16);return x[0]=e,x[1]=t,x[2]=r,x[3]=n,x[4]=o,x[5]=i,x[6]=c,x[7]=a,x[8]=s,x[9]=f,x[10]=u,x[11]=p,x[12]=m,x[13]=y,x[14]=h,x[15]=l,x}function of(e,t,r,n,o,i,c,a,s,f,u,p,m,y,h,l,x){return e[0]=t,e[1]=r,e[2]=n,e[3]=o,e[4]=i,e[5]=c,e[6]=a,e[7]=s,e[8]=f,e[9]=u,e[10]=p,e[11]=m,e[12]=y,e[13]=h,e[14]=l,e[15]=x,e}function qn(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function cf(e,t){if(e===t){var r=t[1],n=t[2],o=t[3],i=t[6],c=t[7],a=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=i,e[11]=t[14],e[12]=o,e[13]=c,e[14]=a}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function af(e,t){var r=t[0],n=t[1],o=t[2],i=t[3],c=t[4],a=t[5],s=t[6],f=t[7],u=t[8],p=t[9],m=t[10],y=t[11],h=t[12],l=t[13],x=t[14],b=t[15],_=r*a-n*c,E=r*s-o*c,v=r*f-i*c,T=n*s-o*a,A=n*f-i*a,d=o*f-i*s,g=u*l-p*h,w=u*x-m*h,F=u*b-y*h,I=p*x-m*l,R=p*b-y*l,C=m*b-y*x,P=_*C-E*R+v*I+T*F-A*w+d*g;return P?(P=1/P,e[0]=(a*C-s*R+f*I)*P,e[1]=(o*R-n*C-i*I)*P,e[2]=(l*d-x*A+b*T)*P,e[3]=(m*A-p*d-y*T)*P,e[4]=(s*F-c*C-f*w)*P,e[5]=(r*C-o*F+i*w)*P,e[6]=(x*v-h*d-b*E)*P,e[7]=(u*d-m*v+y*E)*P,e[8]=(c*R-a*F+f*g)*P,e[9]=(n*F-r*R-i*g)*P,e[10]=(h*A-l*v+b*_)*P,e[11]=(p*v-u*A-y*_)*P,e[12]=(a*w-c*I-s*g)*P,e[13]=(r*I-n*w+o*g)*P,e[14]=(l*E-h*T-x*_)*P,e[15]=(u*T-p*E+m*_)*P,e):null}function sf(e,t){var r=t[0],n=t[1],o=t[2],i=t[3],c=t[4],a=t[5],s=t[6],f=t[7],u=t[8],p=t[9],m=t[10],y=t[11],h=t[12],l=t[13],x=t[14],b=t[15];return e[0]=a*(m*b-y*x)-p*(s*b-f*x)+l*(s*y-f*m),e[1]=-(n*(m*b-y*x)-p*(o*b-i*x)+l*(o*y-i*m)),e[2]=n*(s*b-f*x)-a*(o*b-i*x)+l*(o*f-i*s),e[3]=-(n*(s*y-f*m)-a*(o*y-i*m)+p*(o*f-i*s)),e[4]=-(c*(m*b-y*x)-u*(s*b-f*x)+h*(s*y-f*m)),e[5]=r*(m*b-y*x)-u*(o*b-i*x)+h*(o*y-i*m),e[6]=-(r*(s*b-f*x)-c*(o*b-i*x)+h*(o*f-i*s)),e[7]=r*(s*y-f*m)-c*(o*y-i*m)+u*(o*f-i*s),e[8]=c*(p*b-y*l)-u*(a*b-f*l)+h*(a*y-f*p),e[9]=-(r*(p*b-y*l)-u*(n*b-i*l)+h*(n*y-i*p)),e[10]=r*(a*b-f*l)-c*(n*b-i*l)+h*(n*f-i*a),e[11]=-(r*(a*y-f*p)-c*(n*y-i*p)+u*(n*f-i*a)),e[12]=-(c*(p*x-m*l)-u*(a*x-s*l)+h*(a*m-s*p)),e[13]=r*(p*x-m*l)-u*(n*x-o*l)+h*(n*m-o*p),e[14]=-(r*(a*x-s*l)-c*(n*x-o*l)+h*(n*s-o*a)),e[15]=r*(a*m-s*p)-c*(n*m-o*p)+u*(n*s-o*a),e}function ff(e){var t=e[0],r=e[1],n=e[2],o=e[3],i=e[4],c=e[5],a=e[6],s=e[7],f=e[8],u=e[9],p=e[10],m=e[11],y=e[12],h=e[13],l=e[14],x=e[15],b=t*c-r*i,_=t*a-n*i,E=t*s-o*i,v=r*a-n*c,T=r*s-o*c,A=n*s-o*a,d=f*h-u*y,g=f*l-p*y,w=f*x-m*y,F=u*l-p*h,I=u*x-m*h,R=p*x-m*l;return b*R-_*I+E*F+v*w-T*g+A*d}function Qn(e,t,r){var n=t[0],o=t[1],i=t[2],c=t[3],a=t[4],s=t[5],f=t[6],u=t[7],p=t[8],m=t[9],y=t[10],h=t[11],l=t[12],x=t[13],b=t[14],_=t[15],E=r[0],v=r[1],T=r[2],A=r[3];return e[0]=E*n+v*a+T*p+A*l,e[1]=E*o+v*s+T*m+A*x,e[2]=E*i+v*f+T*y+A*b,e[3]=E*c+v*u+T*h+A*_,E=r[4],v=r[5],T=r[6],A=r[7],e[4]=E*n+v*a+T*p+A*l,e[5]=E*o+v*s+T*m+A*x,e[6]=E*i+v*f+T*y+A*b,e[7]=E*c+v*u+T*h+A*_,E=r[8],v=r[9],T=r[10],A=r[11],e[8]=E*n+v*a+T*p+A*l,e[9]=E*o+v*s+T*m+A*x,e[10]=E*i+v*f+T*y+A*b,e[11]=E*c+v*u+T*h+A*_,E=r[12],v=r[13],T=r[14],A=r[15],e[12]=E*n+v*a+T*p+A*l,e[13]=E*o+v*s+T*m+A*x,e[14]=E*i+v*f+T*y+A*b,e[15]=E*c+v*u+T*h+A*_,e}function lf(e,t,r){var n=r[0],o=r[1],i=r[2],c,a,s,f,u,p,m,y,h,l,x,b;return t===e?(e[12]=t[0]*n+t[4]*o+t[8]*i+t[12],e[13]=t[1]*n+t[5]*o+t[9]*i+t[13],e[14]=t[2]*n+t[6]*o+t[10]*i+t[14],e[15]=t[3]*n+t[7]*o+t[11]*i+t[15]):(c=t[0],a=t[1],s=t[2],f=t[3],u=t[4],p=t[5],m=t[6],y=t[7],h=t[8],l=t[9],x=t[10],b=t[11],e[0]=c,e[1]=a,e[2]=s,e[3]=f,e[4]=u,e[5]=p,e[6]=m,e[7]=y,e[8]=h,e[9]=l,e[10]=x,e[11]=b,e[12]=c*n+u*o+h*i+t[12],e[13]=a*n+p*o+l*i+t[13],e[14]=s*n+m*o+x*i+t[14],e[15]=f*n+y*o+b*i+t[15]),e}function uf(e,t,r){var n=r[0],o=r[1],i=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*o,e[5]=t[5]*o,e[6]=t[6]*o,e[7]=t[7]*o,e[8]=t[8]*i,e[9]=t[9]*i,e[10]=t[10]*i,e[11]=t[11]*i,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function mf(e,t,r,n){var o=n[0],i=n[1],c=n[2],a=Math.hypot(o,i,c),s,f,u,p,m,y,h,l,x,b,_,E,v,T,A,d,g,w,F,I,R,C,P,z;return a<U?null:(a=1/a,o*=a,i*=a,c*=a,s=Math.sin(r),f=Math.cos(r),u=1-f,p=t[0],m=t[1],y=t[2],h=t[3],l=t[4],x=t[5],b=t[6],_=t[7],E=t[8],v=t[9],T=t[10],A=t[11],d=o*o*u+f,g=i*o*u+c*s,w=c*o*u-i*s,F=o*i*u-c*s,I=i*i*u+f,R=c*i*u+o*s,C=o*c*u+i*s,P=i*c*u-o*s,z=c*c*u+f,e[0]=p*d+l*g+E*w,e[1]=m*d+x*g+v*w,e[2]=y*d+b*g+T*w,e[3]=h*d+_*g+A*w,e[4]=p*F+l*I+E*R,e[5]=m*F+x*I+v*R,e[6]=y*F+b*I+T*R,e[7]=h*F+_*I+A*R,e[8]=p*C+l*P+E*z,e[9]=m*C+x*P+v*z,e[10]=y*C+b*P+T*z,e[11]=h*C+_*P+A*z,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function xf(e,t,r){var n=Math.sin(r),o=Math.cos(r),i=t[4],c=t[5],a=t[6],s=t[7],f=t[8],u=t[9],p=t[10],m=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=i*o+f*n,e[5]=c*o+u*n,e[6]=a*o+p*n,e[7]=s*o+m*n,e[8]=f*o-i*n,e[9]=u*o-c*n,e[10]=p*o-a*n,e[11]=m*o-s*n,e}function hf(e,t,r){var n=Math.sin(r),o=Math.cos(r),i=t[0],c=t[1],a=t[2],s=t[3],f=t[8],u=t[9],p=t[10],m=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*o-f*n,e[1]=c*o-u*n,e[2]=a*o-p*n,e[3]=s*o-m*n,e[8]=i*n+f*o,e[9]=c*n+u*o,e[10]=a*n+p*o,e[11]=s*n+m*o,e}function pf(e,t,r){var n=Math.sin(r),o=Math.cos(r),i=t[0],c=t[1],a=t[2],s=t[3],f=t[4],u=t[5],p=t[6],m=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=i*o+f*n,e[1]=c*o+u*n,e[2]=a*o+p*n,e[3]=s*o+m*n,e[4]=f*o-i*n,e[5]=u*o-c*n,e[6]=p*o-a*n,e[7]=m*o-s*n,e}function yf(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function bf(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ef(e,t,r){var n=r[0],o=r[1],i=r[2],c=Math.hypot(n,o,i),a,s,f;return c<U?null:(c=1/c,n*=c,o*=c,i*=c,a=Math.sin(t),s=Math.cos(t),f=1-s,e[0]=n*n*f+s,e[1]=o*n*f+i*a,e[2]=i*n*f-o*a,e[3]=0,e[4]=n*o*f-i*a,e[5]=o*o*f+s,e[6]=i*o*f+n*a,e[7]=0,e[8]=n*i*f+o*a,e[9]=o*i*f-n*a,e[10]=i*i*f+s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function Tf(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function _f(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function vf(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Jn(e,t,r){var n=t[0],o=t[1],i=t[2],c=t[3],a=n+n,s=o+o,f=i+i,u=n*a,p=n*s,m=n*f,y=o*s,h=o*f,l=i*f,x=c*a,b=c*s,_=c*f;return e[0]=1-(y+l),e[1]=p+_,e[2]=m-b,e[3]=0,e[4]=p-_,e[5]=1-(u+l),e[6]=h+x,e[7]=0,e[8]=m+b,e[9]=h-x,e[10]=1-(u+y),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function Af(e,t){var r=new pe(3),n=-t[0],o=-t[1],i=-t[2],c=t[3],a=t[4],s=t[5],f=t[6],u=t[7],p=n*n+o*o+i*i+c*c;return p>0?(r[0]=(a*c+u*n+s*i-f*o)*2/p,r[1]=(s*c+u*o+f*n-a*i)*2/p,r[2]=(f*c+u*i+a*o-s*n)*2/p):(r[0]=(a*c+u*n+s*i-f*o)*2,r[1]=(s*c+u*o+f*n-a*i)*2,r[2]=(f*c+u*i+a*o-s*n)*2),Jn(e,t,r),e}function gf(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function eo(e,t){var r=t[0],n=t[1],o=t[2],i=t[4],c=t[5],a=t[6],s=t[8],f=t[9],u=t[10];return e[0]=Math.hypot(r,n,o),e[1]=Math.hypot(i,c,a),e[2]=Math.hypot(s,f,u),e}function df(e,t){var r=new pe(3);eo(r,t);var n=1/r[0],o=1/r[1],i=1/r[2],c=t[0]*n,a=t[1]*o,s=t[2]*i,f=t[4]*n,u=t[5]*o,p=t[6]*i,m=t[8]*n,y=t[9]*o,h=t[10]*i,l=c+u+h,x=0;return l>0?(x=Math.sqrt(l+1)*2,e[3]=.25*x,e[0]=(p-y)/x,e[1]=(m-s)/x,e[2]=(a-f)/x):c>u&&c>h?(x=Math.sqrt(1+c-u-h)*2,e[3]=(p-y)/x,e[0]=.25*x,e[1]=(a+f)/x,e[2]=(m+s)/x):u>h?(x=Math.sqrt(1+u-c-h)*2,e[3]=(m-s)/x,e[0]=(a+f)/x,e[1]=.25*x,e[2]=(p+y)/x):(x=Math.sqrt(1+h-c-u)*2,e[3]=(a-f)/x,e[0]=(m+s)/x,e[1]=(p+y)/x,e[2]=.25*x),e}function wf(e,t,r,n){var o=t[0],i=t[1],c=t[2],a=t[3],s=o+o,f=i+i,u=c+c,p=o*s,m=o*f,y=o*u,h=i*f,l=i*u,x=c*u,b=a*s,_=a*f,E=a*u,v=n[0],T=n[1],A=n[2];return e[0]=(1-(h+x))*v,e[1]=(m+E)*v,e[2]=(y-_)*v,e[3]=0,e[4]=(m-E)*T,e[5]=(1-(p+x))*T,e[6]=(l+b)*T,e[7]=0,e[8]=(y+_)*A,e[9]=(l-b)*A,e[10]=(1-(p+h))*A,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function Sf(e,t,r,n,o){var i=t[0],c=t[1],a=t[2],s=t[3],f=i+i,u=c+c,p=a+a,m=i*f,y=i*u,h=i*p,l=c*u,x=c*p,b=a*p,_=s*f,E=s*u,v=s*p,T=n[0],A=n[1],d=n[2],g=o[0],w=o[1],F=o[2],I=(1-(l+b))*T,R=(y+v)*T,C=(h-E)*T,P=(y-v)*A,z=(1-(m+b))*A,$=(x+_)*A,H=(h+E)*d,K=(x-_)*d,Z=(1-(m+l))*d;return e[0]=I,e[1]=R,e[2]=C,e[3]=0,e[4]=P,e[5]=z,e[6]=$,e[7]=0,e[8]=H,e[9]=K,e[10]=Z,e[11]=0,e[12]=r[0]+g-(I*g+P*w+H*F),e[13]=r[1]+w-(R*g+z*w+K*F),e[14]=r[2]+F-(C*g+$*w+Z*F),e[15]=1,e}function Ff(e,t){var r=t[0],n=t[1],o=t[2],i=t[3],c=r+r,a=n+n,s=o+o,f=r*c,u=n*c,p=n*a,m=o*c,y=o*a,h=o*s,l=i*c,x=i*a,b=i*s;return e[0]=1-p-h,e[1]=u+b,e[2]=m-x,e[3]=0,e[4]=u-b,e[5]=1-f-h,e[6]=y+l,e[7]=0,e[8]=m+x,e[9]=y-l,e[10]=1-f-p,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Pf(e,t,r,n,o,i,c){var a=1/(r-t),s=1/(o-n),f=1/(i-c);return e[0]=i*2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i*2*s,e[6]=0,e[7]=0,e[8]=(r+t)*a,e[9]=(o+n)*s,e[10]=(c+i)*f,e[11]=-1,e[12]=0,e[13]=0,e[14]=c*i*2*f,e[15]=0,e}function to(e,t,r,n,o){var i=1/Math.tan(t/2),c;return e[0]=i/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,o!=null&&o!==1/0?(c=1/(n-o),e[10]=(o+n)*c,e[14]=2*o*n*c):(e[10]=-1,e[14]=-2*n),e}var If=to;function Mf(e,t,r,n,o){var i=1/Math.tan(t/2),c;return e[0]=i/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,o!=null&&o!==1/0?(c=1/(n-o),e[10]=o*c,e[14]=o*n*c):(e[10]=-1,e[14]=-n),e}function Rf(e,t,r,n){var o=Math.tan(t.upDegrees*Math.PI/180),i=Math.tan(t.downDegrees*Math.PI/180),c=Math.tan(t.leftDegrees*Math.PI/180),a=Math.tan(t.rightDegrees*Math.PI/180),s=2/(c+a),f=2/(o+i);return e[0]=s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=f,e[6]=0,e[7]=0,e[8]=-((c-a)*s*.5),e[9]=(o-i)*f*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e}function ro(e,t,r,n,o,i,c){var a=1/(t-r),s=1/(n-o),f=1/(i-c);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*f,e[11]=0,e[12]=(t+r)*a,e[13]=(o+n)*s,e[14]=(c+i)*f,e[15]=1,e}var Cf=ro;function Nf(e,t,r,n,o,i,c){var a=1/(t-r),s=1/(n-o),f=1/(i-c);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=f,e[11]=0,e[12]=(t+r)*a,e[13]=(o+n)*s,e[14]=i*f,e[15]=1,e}function Bf(e,t,r,n){var o,i,c,a,s,f,u,p,m,y,h=t[0],l=t[1],x=t[2],b=n[0],_=n[1],E=n[2],v=r[0],T=r[1],A=r[2];return Math.abs(h-v)<U&&Math.abs(l-T)<U&&Math.abs(x-A)<U?qn(e):(u=h-v,p=l-T,m=x-A,y=1/Math.hypot(u,p,m),u*=y,p*=y,m*=y,o=_*m-E*p,i=E*u-b*m,c=b*p-_*u,y=Math.hypot(o,i,c),y?(y=1/y,o*=y,i*=y,c*=y):(o=0,i=0,c=0),a=p*c-m*i,s=m*o-u*c,f=u*i-p*o,y=Math.hypot(a,s,f),y?(y=1/y,a*=y,s*=y,f*=y):(a=0,s=0,f=0),e[0]=o,e[1]=a,e[2]=u,e[3]=0,e[4]=i,e[5]=s,e[6]=p,e[7]=0,e[8]=c,e[9]=f,e[10]=m,e[11]=0,e[12]=-(o*h+i*l+c*x),e[13]=-(a*h+s*l+f*x),e[14]=-(u*h+p*l+m*x),e[15]=1,e)}function Lf(e,t,r,n){var o=t[0],i=t[1],c=t[2],a=n[0],s=n[1],f=n[2],u=o-r[0],p=i-r[1],m=c-r[2],y=u*u+p*p+m*m;y>0&&(y=1/Math.sqrt(y),u*=y,p*=y,m*=y);var h=s*m-f*p,l=f*u-a*m,x=a*p-s*u;return y=h*h+l*l+x*x,y>0&&(y=1/Math.sqrt(y),h*=y,l*=y,x*=y),e[0]=h,e[1]=l,e[2]=x,e[3]=0,e[4]=p*x-m*l,e[5]=m*h-u*x,e[6]=u*l-p*h,e[7]=0,e[8]=u,e[9]=p,e[10]=m,e[11]=0,e[12]=o,e[13]=i,e[14]=c,e[15]=1,e}function Uf(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function Df(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function zf(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e}function no(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}function Of(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e}function Gf(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e}function Vf(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function kf(e,t){var r=e[0],n=e[1],o=e[2],i=e[3],c=e[4],a=e[5],s=e[6],f=e[7],u=e[8],p=e[9],m=e[10],y=e[11],h=e[12],l=e[13],x=e[14],b=e[15],_=t[0],E=t[1],v=t[2],T=t[3],A=t[4],d=t[5],g=t[6],w=t[7],F=t[8],I=t[9],R=t[10],C=t[11],P=t[12],z=t[13],$=t[14],H=t[15];return Math.abs(r-_)<=U*Math.max(1,Math.abs(r),Math.abs(_))&&Math.abs(n-E)<=U*Math.max(1,Math.abs(n),Math.abs(E))&&Math.abs(o-v)<=U*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(i-T)<=U*Math.max(1,Math.abs(i),Math.abs(T))&&Math.abs(c-A)<=U*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(a-d)<=U*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(s-g)<=U*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(f-w)<=U*Math.max(1,Math.abs(f),Math.abs(w))&&Math.abs(u-F)<=U*Math.max(1,Math.abs(u),Math.abs(F))&&Math.abs(p-I)<=U*Math.max(1,Math.abs(p),Math.abs(I))&&Math.abs(m-R)<=U*Math.max(1,Math.abs(m),Math.abs(R))&&Math.abs(y-C)<=U*Math.max(1,Math.abs(y),Math.abs(C))&&Math.abs(h-P)<=U*Math.max(1,Math.abs(h),Math.abs(P))&&Math.abs(l-z)<=U*Math.max(1,Math.abs(l),Math.abs(z))&&Math.abs(x-$)<=U*Math.max(1,Math.abs(x),Math.abs($))&&Math.abs(b-H)<=U*Math.max(1,Math.abs(b),Math.abs(H))}var $f=Qn,Hf=no;var br=de(Te(),1),De;function ye(e=!0,t="canvas"){return De||(br.default.info(`\u{1F58C}\uFE0F Creating WebGL2 context in ${t}`),De=document.querySelector(t).getContext("webgl2",{antialias:e})??void 0,De||br.default.error("\u{1F4A5} Unable to create WebGL2 context!"),De)}var oo=de(Te(),1),bt=class{constructor(){this.cache=new Map}get(t){if(!this.cache.has(t))throw new Error(`Model ${t} not found in cache`);return this.cache.get(t)}add(t){oo.default.debug(`\u{1F9F0} Adding model '${t.name}' to cache`),this.cache.set(t.name,t)}};var io="u_light",Et=class{constructor(){this.position=[0,0,0],this.colour=[1,1,1],this.intensity=1}apply(t){q(t,this.Uniforms)}get Uniforms(){return{[`${io}Position`]:[...this.position,1],[`${io}Colour`]:[...this.colour,1]}}};var co=(r=>(r[r.PERSPECTIVE=1]="PERSPECTIVE",r[r.ORTHOGRAPHIC=2]="ORTHOGRAPHIC",r))(co||{}),Tt=class{constructor(t=1){this.position=[0,0,30],this.lookAt=[0,0,0],this.up=[0,1,0],this.near=.1,this.far=100,this.fov=45,this.type=t,this.orthoZoom=20}get matrix(){return N.targetTo(N.create(),this.position,this.lookAt,this.up)}projectionMatrix(t){return this.type===2?N.ortho(N.create(),-t*this.orthoZoom,t*this.orthoZoom,-this.orthoZoom,this.orthoZoom,this.near,this.far):N.perspective(N.create(),this.fov*(Math.PI/180),t,this.near,this.far)}};var be=class{constructor(t){this.renderable=t}rotateX(t){this.rotate||(this.rotate=[0,0,0]),this.rotate[0]+=t}rotateY(t){this.rotate||(this.rotate=[0,0,0]),this.rotate[1]+=t}rotateZ(t){this.rotate||(this.rotate=[0,0,0]),this.rotate[2]+=t}render(t,r,n,o){if(!this.renderable||!t)return;let i=N.create();this.scale&&N.scale(i,i,this.scale),this.position&&N.translate(i,i,this.position),this.rotate&&(N.rotateX(i,i,this.rotate[0]),N.rotateY(i,i,this.rotate[1]),N.rotateZ(i,i,this.rotate[2])),r.u&&(r.u_world=i),N.invert(r.u_worldInverseTranspose,i),N.transpose(r.u_worldInverseTranspose,r.u_worldInverseTranspose),N.multiply(r.u_worldViewProjection,n,i),this.renderable.render(t,r,o)}};var ze=class{constructor(){this.material=new Ee}render(t,r,n){this.bufferInfo&&(this.material.apply(n),ht(t,n,this.bufferInfo),q(n,r),pt(t,this.bufferInfo))}},_t=class extends ze{constructor(t,r,n,o){super(),this.bufferInfo=ot.createSphereBufferInfo(t,r,n,o)}},vt=class extends ze{constructor(t,r){super(),this.bufferInfo=ot.createCubeBufferInfo(t,r)}},At=class extends ze{constructor(t,r,n,o,i){super(),this.bufferInfo=ot.createPlaneBufferInfo(t,r,n,o,i)}};var ao=`#version 300 es

// ============================================================================
// Phong vertex shader
// Ben Coleman, 2023
// ============================================================================

precision highp float;

// From vertex shader
in vec3 v_normal;
in vec2 v_texCoord;
in vec4 v_position;

uniform mat4 u_world;
uniform mat4 u_camMatrix;

// Material properties
uniform vec4 u_matAmbient;
uniform vec4 u_matDiffuse;
uniform vec4 u_matSpecular;
uniform float u_matShininess;
uniform sampler2D u_matTexture;

// Light properties
uniform vec4 u_lightPosition;
uniform vec4 u_lightColour;
uniform vec4 u_ambientLight;

// Output colour of this pixel/fragment
out vec4 outColour;

// lightCalc function returns two floats (packed into a vec2)
// One for diffuse component of lighting, the second for specular
// - normalN:          Surface normal (normalized)
// - surfaceToLightN:  Vector towards light (normalized)
// - halfVector:       Half vector towards camera (normalized)
// - shininess:        Hardness or size of specular highlights
vec2 lightCalc(vec3 normalN, vec3 surfaceToLightN, vec3 halfVector, float shininess) {
  float NdotL = dot(normalN, surfaceToLightN);
  float NdotH = dot(normalN, halfVector);

  return vec2(
    NdotL,
    NdotL > 0.0
      ? pow(max(0.0, NdotH), shininess)
      : 0.0 // Specular term in y
  );
}

void main(void ) {
  vec3 surfaceToLight = u_lightPosition.xyz - v_position.xyz;
  vec3 surfaceToView = (u_camMatrix[3] - u_world * v_position).xyz;
  vec3 normalN = normalize(v_normal);
  vec3 surfaceToLightN = normalize(surfaceToLight);
  vec3 surfaceToViewN = normalize(surfaceToView);
  vec3 halfVector = normalize(surfaceToLightN + surfaceToViewN);

  vec2 l = lightCalc(normalN, surfaceToLightN, halfVector, u_matShininess);

  vec4 diffuseColour = texture(u_matTexture, v_texCoord) * u_matDiffuse;

  outColour =
    u_ambientLight * diffuseColour * u_matAmbient +
    diffuseColour * max(l.x, 0.0) * u_lightColour +
    u_matSpecular * l.y * u_lightColour;
}
`;var so=`#version 300 es

// ============================================================================
// Phong vertex shader
// Ben Coleman, 2023
// ============================================================================

precision highp float;

// Input attributes from buffers
in vec4 position;
in vec3 normal;
in vec2 texcoord;

uniform mat4 u_worldViewProjection;
uniform mat4 u_worldInverseTranspose;
uniform mat4 u_world;

// Output varying's to pass to fragment shader
out vec2 v_texCoord;
out vec3 v_normal;
out vec4 v_position;

void main() {
  v_texCoord = texcoord;
  v_normal = (u_worldInverseTranspose * vec4(normal, 0)).xyz;
  v_position = u_world * position;

  gl_Position = u_worldViewProjection * position;
}
`;var fo=`#version 300 es

// ============================================================================
// Gouraud fragment shader
// Ben Coleman, 2023
// ============================================================================

precision highp float;

// From vertex shader
in vec4 v_lightingDiffuse;
in vec4 v_lightingSpecular;
in vec2 v_texCoord;

uniform sampler2D u_matTexture;
uniform vec4 u_matDiffuse;

// Output colour of this pixel/fragment
out vec4 outColour;

void main() {
  // Tried to set the objectColour in the vertex shader, rather than here.
  // But texture mapping + Gouraud shading, it looks terrible
  vec4 objectColour = texture(u_matTexture, v_texCoord) * u_matDiffuse;

  outColour = objectColour * v_lightingDiffuse + v_lightingSpecular;
}
`;var lo=`#version 300 es

// ============================================================================
// Gouraud vertex shader
// Ben Coleman, 2023
// ============================================================================

precision highp float;

// Input attributes from buffers
in vec4 position;
in vec3 normal;
in vec2 texcoord;

uniform mat4 u_world;
uniform mat4 u_camMatrix;
uniform mat4 u_worldViewProjection;
uniform mat4 u_worldInverseTranspose;

// Material properties
uniform vec4 u_matAmbient;
uniform vec4 u_matSpecular;
uniform float u_matShininess;

// Light properties
uniform vec4 u_lightPosition;
uniform vec4 u_lightColour;
uniform vec4 u_ambientLight;

out vec4 v_lightingDiffuse;
out vec4 v_lightingSpecular;
out vec2 v_texCoord;

// lightCalc function returns two floats (packed into a vec2)
// One for diffuse component of lighting, the second for specular
// - normalN:          Surface normal (normalized)
// - surfaceToLightN:  Vector towards light (normalized)
// - halfVector:       Half vector towards camera (normalized)
// - shininess:        Hardness or size of specular highlights
vec2 lightCalc(vec3 normalN, vec3 surfaceToLightN, vec3 halfVector, float shininess) {
  float NdotL = dot(normalN, surfaceToLightN);
  float NdotH = dot(normalN, halfVector);

  return vec2(
    NdotL,
    NdotL > 0.0
      ? pow(max(0.0, NdotH), shininess)
      : 0.0 // Specular term in y
  );
}

void main(void ) {
  vec3 worldNormal = (u_worldInverseTranspose * vec4(normal, 0)).xyz;
  vec4 worldPos = u_world * position;

  vec3 surfaceToLight = u_lightPosition.xyz - worldPos.xyz;
  vec3 surfaceToView = (u_camMatrix[3] - u_world * worldPos).xyz;
  vec3 normalN = normalize(worldNormal);
  vec3 surfaceToLightN = normalize(surfaceToLight);
  vec3 surfaceToViewN = normalize(surfaceToView);
  vec3 halfVector = normalize(surfaceToLightN + surfaceToViewN);

  vec2 light = lightCalc(normalN, surfaceToLightN, halfVector, u_matShininess);

  // Output lighting value for fragment shader to use, no color
  v_lightingDiffuse = u_ambientLight * u_matAmbient + u_lightColour * max(light.x, 0.0);

  // Pass specular in a seperate varying
  v_lightingSpecular = u_lightColour * u_matSpecular * light.y;

  // Pass through varying texture coordinate, so we can get the colour there
  v_texCoord = texcoord;

  gl_Position = u_worldViewProjection * position;
}
`;var uo=`#version 300 es

// ============================================================================
// Gouraud fragment shader with flat shading
// Ben Coleman, 2023
// ============================================================================

precision highp float;

// From vertex shader
flat in vec4 v_lightingDiffuse;
flat in vec4 v_lightingSpecular;
in vec2 v_texCoord;

uniform sampler2D u_matTexture;
uniform vec4 u_matDiffuse;

// Output colour of this pixel/fragment
out vec4 outColour;

void main() {
  // Tried to set the objectColour in the vertex shader, rather than here.
  // But texture mapping + Gouraud shading, it looks terrible
  vec4 objectColour = texture(u_matTexture, v_texCoord) * u_matDiffuse;

  outColour = objectColour * v_lightingDiffuse + v_lightingSpecular;
}
`;var mo=`#version 300 es

// ============================================================================
// Gouraud vertex shader
// Ben Coleman, 2023
// ============================================================================

precision highp float;

// Input attributes from buffers
in vec4 position;
in vec3 normal;
in vec2 texcoord;

uniform mat4 u_world;
uniform mat4 u_camMatrix;
uniform mat4 u_worldViewProjection;
uniform mat4 u_worldInverseTranspose;

// Material properties
uniform vec4 u_matAmbient;
uniform vec4 u_matSpecular;
uniform float u_matShininess;

// Light properties
uniform vec4 u_lightPosition;
uniform vec4 u_lightColour;
uniform vec4 u_ambientLight;

flat out vec4 v_lightingDiffuse;
flat out vec4 v_lightingSpecular;
out vec2 v_texCoord;

// lightCalc function returns two floats (packed into a vec2)
// One for diffuse component of lighting, the second for specular
// - normalN:          Surface normal (normalized)
// - surfaceToLightN:  Vector towards light (normalized)
// - halfVector:       Half vector towards camera (normalized)
// - shininess:        Hardness or size of specular highlights
vec2 lightCalc(vec3 normalN, vec3 surfaceToLightN, vec3 halfVector, float shininess) {
  float NdotL = dot(normalN, surfaceToLightN);
  float NdotH = dot(normalN, halfVector);

  return vec2(
    NdotL,
    NdotL > 0.0
      ? pow(max(0.0, NdotH), shininess)
      : 0.0 // Specular term in y
  );
}

void main(void ) {
  vec3 worldNormal = (u_worldInverseTranspose * vec4(normal, 0)).xyz;
  vec4 worldPos = u_world * position;

  vec3 surfaceToLight = u_lightPosition.xyz - worldPos.xyz;
  vec3 surfaceToView = (u_camMatrix[3] - u_world * worldPos).xyz;
  vec3 normalN = normalize(worldNormal);
  vec3 surfaceToLightN = normalize(surfaceToLight);
  vec3 surfaceToViewN = normalize(surfaceToView);
  vec3 halfVector = normalize(surfaceToLightN + surfaceToViewN);

  vec2 light = lightCalc(normalN, surfaceToLightN, halfVector, u_matShininess);

  // Output lighting value for fragment shader to use, no color
  v_lightingDiffuse = u_ambientLight * u_matAmbient + u_lightColour * max(light.x, 0.0);

  // Pass specular in a seperate varying
  v_lightingSpecular = u_lightColour * u_matSpecular * light.y;

  // Pass through varying texture coordinate, so we can get the colour there
  v_texCoord = texcoord;

  gl_Position = u_worldViewProjection * position;
}
`;var xo="0.0.1-pre.0";var Qf=(n=>(n.PHONG="phong",n.GOURAUD="gouraud",n.GOURAUD_FLAT="gouraud-flat",n))(Qf||{}),ho=class e{constructor(t){this.aspectRatio=1;this.programs={};this.started=!1;this.instances=[];this.lights=[];this.resizeable=!0;this.debug=!1;this.ambientLight=[.05,.05,.05];this.shaderProgram="phong";this.gl=t,this.models=new bt,this.prevTime=0,this.totalTime=0;let r=new Et;r.position=[0,40,50],r.colour=[1,1,1],this.lights[0]=r,this.camera=new Tt(1),this.update=()=>{},ce.default.info(`\u{1F451} GSOTS-3D context created, v${xo}`)}static async init(t,r="#000"){let n=ye(!0,t);if(!n)throw ce.default.error("\u{1F4A5} Failed to get WebGL context"),new Error("Failed to get WebGL context");let o=new e(n),i=n.canvas;o.aspectRatio=i.clientWidth/i.clientHeight,i.style.backgroundColor=r;try{let c=Ue(n,[so,ao]);o.programs.phong=c;let a=Ue(n,[lo,fo]);o.programs.gouraud=a;let s=Ue(n,[mo,uo]);o.programs["gouraud-flat"]=s,ce.default.info("\u{1F3A8} Loaded all shaders & programs, GL is ready")}catch(c){throw ce.default.error(c),c}return n.enable(n.DEPTH_TEST),n.enable(n.CULL_FACE),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA),o.render=o.render.bind(o),o}async render(t){if(!this.gl)return;t*=.001;let r=t-this.prevTime;this.prevTime=t,this.totalTime+=r,this.update(r);let n={u_worldInverseTranspose:N.create(),u_worldViewProjection:N.create(),u_ambientLight:[...this.ambientLight,1]},o=this.programs[this.shaderProgram];this.resizeable&&(Zn(this.gl.canvas),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.aspectRatio=this.gl.canvas.width/this.gl.canvas.height);let i=this.camera.matrix,c=N.invert(N.create(),i);n.u_camMatrix=i;let a=this.camera.projectionMatrix(this.aspectRatio),s=N.multiply(N.create(),a,c);this.gl.useProgram(o.program),this.lights[0].apply(o);for(let f of this.instances)f.render(this.gl,n,s,o);this.started&&requestAnimationFrame(this.render)}get defaultLight(){return this.lights[0]}start(){this.started=!0,requestAnimationFrame(this.render)}stop(){this.started=!1}createModelInstance(t){let r=this.models.get(t);if(!r)throw new Error(`\u{1F4A5} Model ${t} not found`);let n=new be(r);return this.instances.push(n),n}createSphereInstance(t,r=5,n=16,o=8){let i=new _t(this.gl,r,n,o);i.material=t;let c=new be(i);return this.instances.push(c),ce.default.debug(`\u{1F7E2} Created sphere instance, r:${r}`),c}createPlaneInstance(t,r=5,n=5,o=1,i=1){let c=new At(this.gl,r,n,o,i);c.material=t;let a=new be(c);return this.instances.push(a),ce.default.debug(`\u{1F7E8} Created plane instance, w:${r} h:${n}`),a}createCubeInstance(t,r=5){let n=new vt(this.gl,r);n.material=t;let o=new be(n);return this.instances.push(o),ce.default.debug(`\u{1F4E6} Created cube instance, size:${r}`),o}};var Oe="u_mat",Ee=class e{constructor(){this.diffuse=[1,1,1],this.specular=void 0,this.shininess=void 0,this.ambient=void 0,this.emissive=void 0;let t=ye();t&&(this.texture=lr(t,{min:t.NEAREST,mag:t.NEAREST,src:[255,255,255,255]}))}static fromMtl(t){let r=new e;return r.diffuse=t.kd,r.specular=t.ks,r.shininess=t.ns,r.ambient=t.ka,r.emissive=t.ke,r}static createDiffuse(t,r,n){let o=new e;return o.diffuse=[t,r,n],o}static createTexture(t,r=!0){let n=new e,o=ye();return o&&(o.LINEAR_MIPMAP_LINEAR,n.texture=lr(o,{min:r?o.LINEAR_MIPMAP_LINEAR:o.NEAREST,mag:r?o.LINEAR:o.NEAREST,src:t})),n}static get RED(){return e.createDiffuse(1,0,0)}static get GREEN(){return e.createDiffuse(0,1,0)}static get BLUE(){return e.createDiffuse(0,0,1)}apply(t){q(t,this.Uniforms)}get Uniforms(){return{[`${Oe}Texture`]:this.texture?this.texture:null,[`${Oe}Shininess`]:this.shininess?this.shininess:0,[`${Oe}Diffuse`]:this.diffuse?[...this.diffuse,1]:[1,1,1,1],[`${Oe}Specular`]:this.specular?[...this.specular,1]:[0,0,0,1],[`${Oe}Ambient`]:this.ambient?[...this.ambient,1]:[1,1,1,1]}}};var Eo=de(Te(),1);function po(e){let t=new Map,r={},n={newmtl(c,a){r={},t.set(a,r)},Ns(c){r.ns=parseFloat(c[0])},Ka(c){r.ka=c.map(parseFloat)},Kd(c){r.kd=c.map(parseFloat)},Ks(c){r.ks=c.map(parseFloat)},Ke(c){r.ke=c.map(parseFloat)},Ni(c){r.ni=parseFloat(c[0])},d(c){r.d=parseFloat(c[0])},illum(c){r.illum=parseInt(c[0])}},o=/(\w*)(?: )*(.*)/,i=e.split(`
`);for(let c=0;c<i.length;++c){let a=i[c].trim();if(a===""||a.startsWith("#"))continue;let s=o.exec(a);if(!s)continue;let[,f,u]=s,p=a.split(/\s+/).slice(1),m=n[f];if(!m){console.warn("unhandled keyword:",f);continue}m(p,u)}return t}var Jf=/(\w*)(?: )*(.*)/;function yo(e){let t=e.split(`
`),r=[[0,0,0]],n=[[0,0]],o=[[0,0,0]],i=[r,n,o],c=[[],[],[]],a=Array(),s={},f="__default",u=Array(),p={v(l){r.push(l.map(parseFloat))},vn(l){o.push(l.map(parseFloat))},vt(l){n.push(l.map(parseFloat))},f(l){h();let x=l.length-2;for(let b=0;b<x;++b)m(l[0]),m(l[b+1]),m(l[b+2])},usemtl(l,x){f=x,y()},mtllib(l,x){u.push(x)},s(){},o(){}};function m(l){l.split("/").forEach((b,_)=>{if(!b)return;let E=parseInt(b),v=E+(E>=0?0:i[_].length);c[_].push(...i[_][v])})}function y(){s.material&&(s={})}function h(){if(!s.material){let l=[],x=[],b=[];c=[l,x,b],s={material:f,data:{position:l,texcoord:x,normal:b}},a.push(s)}}for(let l=0;l<t.length;++l){let x=t[l].trim();if(x===""||x.startsWith("#"))continue;let b=Jf.exec(x);if(!b)continue;let[,_,E]=b,v=x.split(/\s+/).slice(1),T=p[_];if(!T){console.warn("unhandled keyword:",_,"at line",l+1);continue}T(v,E)}for(let l of a)l.data.texcoord&&l.data.texcoord.length<=0&&delete l.data.texcoord;return{matLibNames:u,geometries:a}}async function Er(e){let t=await fetch(e);if(!t.ok)throw new Error(`File fetch failed: ${t.statusText}`);return await t.text()}var bo=class e{constructor(t){this.parts=[];this.materials={};this.name=t}render(t,r,n){for(let o of this.parts){let i=o.bufferInfo;this.materials[o.materialName].apply(n),ht(t,n,i),q(n,r),pt(t,i)}}static async parse(t=".",r){let n=r.split(".")[0],o=new e(n),i;try{i=await Er(`${t}/${r}`)}catch{throw new Error(`\u{1F4A5} Unable to load model ${r}`)}let c=yo(i);if(!c.geometries||c.geometries.length===0)throw new Error(`\u{1F4A5} Error parsing model ${r}`);if(c.matLibNames&&c.matLibNames.length>0)try{let s=await Er(`${t}/${c.matLibNames[0]}`),f=po(s);for(let[u,p]of f)o.materials[u]=Ee.fromMtl(p)}catch{console.warn(`Unable to load material library ${c.matLibNames[0]}`)}o.materials.__default=new Ee;let a=ye();if(!a)throw new Error("Unable to get WebGL context");for(let s of c.geometries){let f=Zt(a,s.data);o.parts.push(new Tr(f,s.material))}return Eo.default.debug(`\u265F\uFE0F Model '${r}' loaded with ${o.parts.length} parts, ${Object.keys(o.materials).length} materials`),o}},Tr=class{constructor(t,r){this.bufferInfo=t,this.materialName=r}};export{Tt as Camera,co as CameraType,ho as Context,be as Instance,Et as Light,Ee as Material,bo as Model,bt as ModelCache,ze as Primitive,vt as PrimitiveCube,At as PrimitivePlane,_t as PrimitiveSphere,Qf as ShaderProgram,t0 as setLogLevel};
/*! Bundled license information:

twgl.js/dist/5.x/twgl-full.module.js:
  (* @license twgl.js 5.3.1 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
  Available via the MIT license.
  see: http://github.com/greggman/twgl.js for details *)
*/
//# sourceMappingURL=index.js.map