var Eo=Object.create;var gr=Object.defineProperty;var _o=Object.getOwnPropertyDescriptor;var To=Object.getOwnPropertyNames;var vo=Object.getPrototypeOf,Ao=Object.prototype.hasOwnProperty;var go=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports),So=(e,r)=>{for(var t in r)gr(e,t,{get:r[t],enumerable:!0})},wo=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of To(r))!Ao.call(e,o)&&o!==t&&gr(e,o,{get:()=>r[o],enumerable:!(n=_o(r,o))||n.enumerable});return e};var de=(e,r,t)=>(t=e!=null?Eo(vo(e)):{},wo(r||!e||!e.__esModule?gr(t,"default",{value:e,enumerable:!0}):t,e));var _e=go((dt,Xe)=>{"use strict";(function(e,r){"use strict";typeof define=="function"&&define.amd?define(r):typeof Xe=="object"&&Xe.exports?Xe.exports=r():e.log=r()})(dt,function(){"use strict";var e=function(){},r="undefined",t=typeof window!==r&&typeof window.navigator!==r&&/Trident\/|MSIE /.test(window.navigator.userAgent),n=["trace","debug","info","warn","error"];function o(h,l){var x=h[l];if(typeof x.bind=="function")return x.bind(h);try{return Function.prototype.bind.call(x,h)}catch{return function(){return Function.prototype.apply.apply(x,[h,arguments])}}}function i(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function c(h){return h==="debug"&&(h="log"),typeof console===r?!1:h==="trace"&&t?i:console[h]!==void 0?o(console,h):console.log!==void 0?o(console,"log"):e}function a(h,l){for(var x=0;x<n.length;x++){var b=n[x];this[b]=x<h?e:this.methodFactory(b,h,l)}this.log=this.debug}function s(h,l,x){return function(){typeof console!==r&&(a.call(this,l,x),this[h].apply(this,arguments))}}function f(h,l,x){return c(h)||s.apply(this,arguments)}function u(h,l,x){var b=this,T;l=l??"WARN";var E="loglevel";typeof h=="string"?E+=":"+h:typeof h=="symbol"&&(E=void 0);function v(g){var S=(n[g]||"silent").toUpperCase();if(!(typeof window===r||!E)){try{window.localStorage[E]=S;return}catch{}try{window.document.cookie=encodeURIComponent(E)+"="+S+";"}catch{}}}function _(){var g;if(!(typeof window===r||!E)){try{g=window.localStorage[E]}catch{}if(typeof g===r)try{var S=window.document.cookie,F=S.indexOf(encodeURIComponent(E)+"=");F!==-1&&(g=/^([^;]+)/.exec(S.slice(F))[1])}catch{}return b.levels[g]===void 0&&(g=void 0),g}}function A(){if(!(typeof window===r||!E)){try{window.localStorage.removeItem(E);return}catch{}try{window.document.cookie=encodeURIComponent(E)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}b.name=h,b.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},b.methodFactory=x||f,b.getLevel=function(){return T},b.setLevel=function(g,S){if(typeof g=="string"&&b.levels[g.toUpperCase()]!==void 0&&(g=b.levels[g.toUpperCase()]),typeof g=="number"&&g>=0&&g<=b.levels.SILENT){if(T=g,S!==!1&&v(g),a.call(b,g,h),typeof console===r&&g<b.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+g},b.setDefaultLevel=function(g){l=g,_()||b.setLevel(g,!1)},b.resetLevel=function(){b.setLevel(l,!1),A()},b.enableAll=function(g){b.setLevel(b.levels.TRACE,g)},b.disableAll=function(g){b.setLevel(b.levels.SILENT,g)};var d=_();d==null&&(d=l),b.setLevel(d,!1)}var p=new u,m={};p.getLogger=function(l){if(typeof l!="symbol"&&typeof l!="string"||l==="")throw new TypeError("You must supply a name when creating a logger.");var x=m[l];return x||(x=m[l]=new u(l,p.getLevel(),p.methodFactory)),x};var y=typeof window!==r?window.log:void 0;return p.noConflict=function(){return typeof window!==r&&window.log===p&&(window.log=y),p},p.getLoggers=function(){return m},p.default=p,p})});var St=de(_e(),1);function Jf(e){St.default.setLevel(e)}var ce=de(_e(),1);var Dr=Float32Array;function zr(e,r,t){let n=new Dr(3);return e&&(n[0]=e),r&&(n[1]=r),t&&(n[2]=t),n}function Fo(e,r,t){return t=t||new Dr(3),t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}function Po(e,r,t){return t=t||new Dr(3),t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}var Ut=Float32Array;function Io(e){return e=e||new Ut(16),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Mo(e,r){r=r||new Ut(16);let t=e[0*4+0],n=e[0*4+1],o=e[0*4+2],i=e[0*4+3],c=e[1*4+0],a=e[1*4+1],s=e[1*4+2],f=e[1*4+3],u=e[2*4+0],p=e[2*4+1],m=e[2*4+2],y=e[2*4+3],h=e[3*4+0],l=e[3*4+1],x=e[3*4+2],b=e[3*4+3],T=m*b,E=x*y,v=s*b,_=x*f,A=s*y,d=m*f,g=o*b,S=x*i,F=o*y,I=m*i,R=o*f,N=s*i,P=u*l,z=h*p,$=c*l,H=h*a,K=c*p,Z=u*a,Ge=t*l,Ve=h*n,ke=t*p,$e=u*n,He=t*a,je=c*n,Tt=T*a+_*p+A*l-(E*a+v*p+d*l),vt=E*n+g*p+I*l-(T*n+S*p+F*l),At=v*n+S*a+R*l-(_*n+g*a+N*l),gt=d*n+F*a+N*p-(A*n+I*a+R*p),O=1/(t*Tt+c*vt+u*At+h*gt);return r[0]=O*Tt,r[1]=O*vt,r[2]=O*At,r[3]=O*gt,r[4]=O*(E*c+v*u+d*h-(T*c+_*u+A*h)),r[5]=O*(T*t+S*u+F*h-(E*t+g*u+I*h)),r[6]=O*(_*t+g*c+N*h-(v*t+S*c+R*h)),r[7]=O*(A*t+I*c+R*u-(d*t+F*c+N*u)),r[8]=O*(P*f+H*y+K*b-(z*f+$*y+Z*b)),r[9]=O*(z*i+Ge*y+$e*b-(P*i+Ve*y+ke*b)),r[10]=O*($*i+Ve*f+He*b-(H*i+Ge*f+je*b)),r[11]=O*(Z*i+ke*f+je*y-(K*i+$e*f+He*y)),r[12]=O*($*m+Z*x+z*s-(K*x+P*s+H*m)),r[13]=O*(ke*x+P*o+Ve*m-(Ge*m+$e*x+z*o)),r[14]=O*(Ge*s+je*x+H*o-(He*x+$*o+Ve*s)),r[15]=O*(He*m+K*o+$e*s-(ke*s+je*m+Z*o)),r}function Ro(e,r,t){t=t||zr();let n=r[0],o=r[1],i=r[2],c=n*e[0*4+3]+o*e[1*4+3]+i*e[2*4+3]+e[3*4+3];return t[0]=(n*e[0*4+0]+o*e[1*4+0]+i*e[2*4+0]+e[3*4+0])/c,t[1]=(n*e[0*4+1]+o*e[1*4+1]+i*e[2*4+1]+e[3*4+1])/c,t[2]=(n*e[0*4+2]+o*e[1*4+2]+i*e[2*4+2]+e[3*4+2])/c,t}function No(e,r,t){t=t||zr();let n=r[0],o=r[1],i=r[2];return t[0]=n*e[0*4+0]+o*e[1*4+0]+i*e[2*4+0],t[1]=n*e[0*4+1]+o*e[1*4+1]+i*e[2*4+1],t[2]=n*e[0*4+2]+o*e[1*4+2]+i*e[2*4+2],t}var Or=5120,Pe=5121,Gr=5122,Vr=5123,kr=5124,$r=5125,Hr=5126,Co=32819,Bo=32820,Lo=33635,Uo=5131,Do=33640,zo=35899,Oo=35902,Go=36269,Vo=34042,Dt={};{let e=Dt;e[Or]=Int8Array,e[Pe]=Uint8Array,e[Gr]=Int16Array,e[Vr]=Uint16Array,e[kr]=Int32Array,e[$r]=Uint32Array,e[Hr]=Float32Array,e[Co]=Uint16Array,e[Bo]=Uint16Array,e[Lo]=Uint16Array,e[Uo]=Uint16Array,e[Do]=Uint32Array,e[zo]=Uint32Array,e[Oo]=Uint32Array,e[Go]=Uint32Array,e[Vo]=Uint32Array}function er(e){if(e instanceof Int8Array)return Or;if(e instanceof Uint8Array||e instanceof Uint8ClampedArray)return Pe;if(e instanceof Int16Array)return Gr;if(e instanceof Uint16Array)return Vr;if(e instanceof Int32Array)return kr;if(e instanceof Uint32Array)return $r;if(e instanceof Float32Array)return Hr;throw new Error("unsupported typed array type")}function zt(e){if(e===Int8Array)return Or;if(e===Uint8Array||e===Uint8ClampedArray)return Pe;if(e===Int16Array)return Gr;if(e===Uint16Array)return Vr;if(e===Int32Array)return kr;if(e===Uint32Array)return $r;if(e===Float32Array)return Hr;throw new Error("unsupported typed array type")}function Ot(e){let r=Dt[e];if(!r)throw new Error("unknown gl type");return r}var Ie=typeof SharedArrayBuffer<"u"?function(r){return r&&r.buffer&&(r.buffer instanceof ArrayBuffer||r.buffer instanceof SharedArrayBuffer)}:function(r){return r&&r.buffer&&r.buffer instanceof ArrayBuffer};function ko(e,r,t){e.forEach(function(n){let o=r[n];o!==void 0&&(t[n]=o)})}function Gt(...e){console.error(...e)}var wt=new Map;function jr(e,r){if(!e||typeof e!="object")return!1;let t=wt.get(r);t||(t=new WeakMap,wt.set(r,t));let n=t.get(e);if(n===void 0){let o=Object.prototype.toString.call(e);n=o.substring(8,o.length-1)===r,t.set(e,n)}return n}function $o(e,r){return typeof WebGLBuffer<"u"&&jr(r,"WebGLBuffer")}function Vt(e,r){return typeof WebGLTexture<"u"&&jr(r,"WebGLTexture")}function Ho(e,r){return typeof WebGLSampler<"u"&&jr(r,"WebGLSampler")}var kt=35044,re=34962,$t=34963,jo=34660,Xo=5120,Yo=5121,Wo=5122,Ko=5123,Zo=5124,qo=5125,Ht=5126,jt={attribPrefix:""};function Qo(e,r,t,n,o){e.bindBuffer(r,t),e.bufferData(r,n,o||kt)}function Xr(e,r,t,n){if($o(e,r))return r;t=t||re;let o=e.createBuffer();return Qo(e,t,o,r,n),o}function Xt(e){return e==="indices"}function Jo(e){return e===Int8Array||e===Uint8Array}function Yr(e){return e.length?e:e.data}var ei=/coord|texture/i,ri=/color|colour/i;function ti(e,r){let t;if(ei.test(e)?t=2:ri.test(e)?t=4:t=3,r%t>0)throw new Error(`Can not guess numComponents for attribute '${e}'. Tried ${t} but ${r} values is not evenly divisible by ${t}. You should specify it.`);return t}function Wr(e,r,t){return e.numComponents||e.size||ti(r,t||Yr(e).length)}function rr(e,r){if(Ie(e))return e;if(Ie(e.data))return e.data;Array.isArray(e)&&(e={data:e});let t=e.type?Kr(e.type):void 0;return t||(Xt(r)?t=Uint16Array:t=Float32Array),new t(e.data)}function ni(e){return typeof e=="number"?e:e?zt(e):Ht}function Kr(e){return typeof e=="number"?Ot(e):e||Float32Array}function oi(e,r){return{buffer:r.buffer,numValues:2*3*4,type:ni(r.type),arrayType:Kr(r.type)}}function ii(e,r){let t=r.data||r,n=Kr(r.type),o=t*n.BYTES_PER_ELEMENT,i=e.createBuffer();return e.bindBuffer(re,i),e.bufferData(re,o,r.drawType||kt),{buffer:i,numValues:t,type:zt(n),arrayType:n}}function ci(e,r,t){let n=rr(r,t);return{arrayType:n.constructor,buffer:Xr(e,n,void 0,r.drawType),type:er(n),numValues:0}}function ai(e,r){let t={};return Object.keys(r).forEach(function(n){if(!Xt(n)){let o=r[n],i=o.attrib||o.name||o.attribName||jt.attribPrefix+n;if(o.value){if(!Array.isArray(o.value)&&!Ie(o.value))throw new Error("array.value is not array or typedarray");t[i]={value:o.value}}else{let c;o.buffer&&o.buffer instanceof WebGLBuffer?c=oi:typeof o=="number"||typeof o.data=="number"?c=ii:c=ci;let{buffer:a,type:s,numValues:f,arrayType:u}=c(e,o,n),p=o.normalize!==void 0?o.normalize:Jo(u),m=Wr(o,n,f);t[i]={buffer:a,numComponents:m,type:s,normalize:p,stride:o.stride||0,offset:o.offset||0,divisor:o.divisor===void 0?void 0:o.divisor,drawType:o.drawType}}}}),e.bindBuffer(re,null),t}function si(e,r){return r===Xo||r===Yo?1:r===Wo||r===Ko?2:r===Zo||r===qo||r===Ht?4:0}var Ae=["position","positions","a_position"];function fi(e){let r,t;for(t=0;t<Ae.length&&(r=Ae[t],!(r in e));++t);t===Ae.length&&(r=Object.keys(e)[0]);let n=e[r],o=Yr(n).length;if(o===void 0)return 1;let i=Wr(n,r),c=o/i;if(o%i>0)throw new Error(`numComponents ${i} not correct for length ${o}`);return c}function li(e,r){let t,n;for(n=0;n<Ae.length&&(t=Ae[n],!(t in r||(t=jt.attribPrefix+t,t in r)));++n);n===Ae.length&&(t=Object.keys(r)[0]);let o=r[t];if(!o.buffer)return 1;e.bindBuffer(re,o.buffer);let i=e.getBufferParameter(re,jo);e.bindBuffer(re,null);let c=si(e,o.type),a=i/c,s=o.numComponents||o.size,f=a/s;if(f%1!==0)throw new Error(`numComponents ${s} not correct for length ${length}`);return f}function Zr(e,r,t){let n=ai(e,r),o=Object.assign({},t||{});o.attribs=Object.assign({},t?t.attribs:{},n);let i=r.indices;if(i){let c=rr(i,"indices");o.indices=Xr(e,c,$t),o.numElements=c.length,o.elementType=er(c)}else o.numElements||(o.numElements=li(e,o.attribs));return o}function ui(e,r,t){let n=t==="indices"?$t:re,o=rr(r,t);return Xr(e,o,n)}function mi(e,r){let t={};return Object.keys(r).forEach(function(n){t[n]=ui(e,r[n],n)}),r.indices?(t.numElements=r.indices.length,t.elementType=er(rr(r.indices))):t.numElements=fi(r),t}var ue=Yr,xi=Wr;function Yt(e,r){let t=0;return e.push=function(){for(let n=0;n<arguments.length;++n){let o=arguments[n];if(o instanceof Array||Ie(o))for(let i=0;i<o.length;++i)e[t++]=o[i];else e[t++]=o}},e.reset=function(n){t=n||0},e.numComponents=r,Object.defineProperty(e,"numElements",{get:function(){return this.length/this.numComponents|0}}),e}function M(e,r,t){let n=t||Float32Array;return Yt(new n(e*r),e)}function hi(e){return e!=="indices"}function pi(e){let r=e.indices,t={},n=r.length;function o(i){let c=e[i],a=c.numComponents,s=M(a,n,c.constructor);for(let f=0;f<n;++f){let p=r[f]*a;for(let m=0;m<a;++m)s.push(c[p+m])}t[i]=s}return Object.keys(e).filter(hi).forEach(o),t}function yi(e){if(e.indices)throw new Error("can not flatten normals of indexed vertices. deindex them first");let r=e.normal,t=r.length;for(let n=0;n<t;n+=9){let o=r[n+0],i=r[n+1],c=r[n+2],a=r[n+3],s=r[n+4],f=r[n+5],u=r[n+6],p=r[n+7],m=r[n+8],y=o+a+u,h=i+s+p,l=c+f+m,x=Math.sqrt(y*y+h*h+l*l);y/=x,h/=x,l/=x,r[n+0]=y,r[n+1]=h,r[n+2]=l,r[n+3]=y,r[n+4]=h,r[n+5]=l,r[n+6]=y,r[n+7]=h,r[n+8]=l}return e}function qr(e,r,t){let n=e.length,o=new Float32Array(3);for(let i=0;i<n;i+=3)t(r,[e[i],e[i+1],e[i+2]],o),e[i]=o[0],e[i+1]=o[1],e[i+2]=o[2]}function bi(e,r,t){t=t||zr();let n=r[0],o=r[1],i=r[2];return t[0]=n*e[0*4+0]+o*e[0*4+1]+i*e[0*4+2],t[1]=n*e[1*4+0]+o*e[1*4+1]+i*e[1*4+2],t[2]=n*e[2*4+0]+o*e[2*4+1]+i*e[2*4+2],t}function Wt(e,r){return qr(e,r,No),e}function Kt(e,r){return qr(e,Mo(r),bi),e}function Zt(e,r){return qr(e,r,Ro),e}function qt(e,r){return Object.keys(e).forEach(function(t){let n=e[t];t.indexOf("pos")>=0?Zt(n,r):t.indexOf("tan")>=0||t.indexOf("binorm")>=0?Wt(n,r):t.indexOf("norm")>=0&&Kt(n,r)}),e}function Qr(e,r,t){return e=e||2,r=r||0,t=t||0,e*=.5,{position:{numComponents:2,data:[r+-1*e,t+-1*e,r+1*e,t+-1*e,r+-1*e,t+1*e,r+1*e,t+1*e]},normal:[0,0,1,0,0,1,0,0,1,0,0,1],texcoord:[0,0,1,0,0,1,1,1],indices:[0,1,2,2,1,3]}}function Jr(e,r,t,n,o){e=e||1,r=r||1,t=t||1,n=n||1,o=o||Io();let i=(t+1)*(n+1),c=M(3,i),a=M(3,i),s=M(2,i);for(let m=0;m<=n;m++)for(let y=0;y<=t;y++){let h=y/t,l=m/n;c.push(e*h-e*.5,0,r*l-r*.5),a.push(0,1,0),s.push(h,l)}let f=t+1,u=M(3,t*n*2,Uint16Array);for(let m=0;m<n;m++)for(let y=0;y<t;y++)u.push((m+0)*f+y,(m+1)*f+y,(m+0)*f+y+1),u.push((m+1)*f+y,(m+1)*f+y+1,(m+0)*f+y+1);return qt({position:c,normal:a,texcoord:s,indices:u},o)}function et(e,r,t,n,o,i,c){if(r<=0||t<=0)throw new Error("subdivisionAxis and subdivisionHeight must be > 0");n=n||0,o=o||Math.PI,i=i||0,c=c||Math.PI*2;let a=o-n,s=c-i,f=(r+1)*(t+1),u=M(3,f),p=M(3,f),m=M(2,f);for(let l=0;l<=t;l++)for(let x=0;x<=r;x++){let b=x/r,T=l/t,E=s*b+i,v=a*T+n,_=Math.sin(E),A=Math.cos(E),d=Math.sin(v),g=Math.cos(v),S=A*d,F=g,I=_*d;u.push(e*S,e*F,e*I),p.push(S,F,I),m.push(1-b,T)}let y=r+1,h=M(3,r*t*2,Uint16Array);for(let l=0;l<r;l++)for(let x=0;x<t;x++)h.push((x+0)*y+l,(x+0)*y+l+1,(x+1)*y+l),h.push((x+1)*y+l,(x+0)*y+l+1,(x+1)*y+l+1);return{position:u,normal:p,texcoord:m,indices:h}}var Ei=[[3,7,5,1],[6,2,0,4],[6,7,3,2],[0,1,5,4],[7,6,4,5],[2,3,1,0]];function rt(e){e=e||1;let r=e/2,t=[[-r,-r,-r],[+r,-r,-r],[-r,+r,-r],[+r,+r,-r],[-r,-r,+r],[+r,-r,+r],[-r,+r,+r],[+r,+r,+r]],n=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],o=[[1,0],[0,0],[0,1],[1,1]],i=6*4,c=M(3,i),a=M(3,i),s=M(2,i),f=M(3,6*2,Uint16Array);for(let u=0;u<6;++u){let p=Ei[u];for(let y=0;y<4;++y){let h=t[p[y]],l=n[u],x=o[y];c.push(h),a.push(l),s.push(x)}let m=4*u;f.push(m+0,m+1,m+2),f.push(m+0,m+2,m+3)}return{position:c,normal:a,texcoord:s,indices:f}}function tr(e,r,t,n,o,i,c){if(n<3)throw new Error("radialSubdivisions must be 3 or greater");if(o<1)throw new Error("verticalSubdivisions must be 1 or greater");let a=i===void 0?!0:i,s=c===void 0?!0:c,f=(a?2:0)+(s?2:0),u=(n+1)*(o+1+f),p=M(3,u),m=M(3,u),y=M(2,u),h=M(3,n*(o+f/2)*2,Uint16Array),l=n+1,x=Math.atan2(e-r,t),b=Math.cos(x),T=Math.sin(x),E=a?-2:0,v=o+(s?2:0);for(let _=E;_<=v;++_){let A=_/o,d=t*A,g;_<0?(d=0,A=1,g=e):_>o?(d=t,A=1,g=r):g=e+(r-e)*(_/o),(_===-2||_===o+2)&&(g=0,A=0),d-=t/2;for(let S=0;S<l;++S){let F=Math.sin(S*Math.PI*2/n),I=Math.cos(S*Math.PI*2/n);p.push(F*g,d,I*g),_<0?m.push(0,-1,0):_>o?m.push(0,1,0):g===0?m.push(0,0,0):m.push(F*b,T,I*b),y.push(S/n,1-A)}}for(let _=0;_<o+f;++_)if(!(_===1&&a||_===o+f-2&&s))for(let A=0;A<n;++A)h.push(l*(_+0)+0+A,l*(_+0)+1+A,l*(_+1)+1+A),h.push(l*(_+0)+0+A,l*(_+1)+1+A,l*(_+1)+0+A);return{position:p,normal:m,texcoord:y,indices:h}}function Ft(e,r){r=r||[];let t=[];for(let n=0;n<e.length;n+=4){let o=e[n],i=e.slice(n+1,n+4);i.push.apply(i,r);for(let c=0;c<o;++c)t.push.apply(t,i)}return t}function tt(){let e=[0,0,0,0,150,0,30,0,0,0,150,0,30,150,0,30,0,0,30,0,0,30,30,0,100,0,0,30,30,0,100,30,0,100,0,0,30,60,0,30,90,0,67,60,0,30,90,0,67,90,0,67,60,0,0,0,30,30,0,30,0,150,30,0,150,30,30,0,30,30,150,30,30,0,30,100,0,30,30,30,30,30,30,30,100,0,30,100,30,30,30,60,30,67,60,30,30,90,30,30,90,30,67,60,30,67,90,30,0,0,0,100,0,0,100,0,30,0,0,0,100,0,30,0,0,30,100,0,0,100,30,0,100,30,30,100,0,0,100,30,30,100,0,30,30,30,0,30,30,30,100,30,30,30,30,0,100,30,30,100,30,0,30,30,0,30,60,30,30,30,30,30,30,0,30,60,0,30,60,30,30,60,0,67,60,30,30,60,30,30,60,0,67,60,0,67,60,30,67,60,0,67,90,30,67,60,30,67,60,0,67,90,0,67,90,30,30,90,0,30,90,30,67,90,30,30,90,0,67,90,30,67,90,0,30,90,0,30,150,30,30,90,30,30,90,0,30,150,0,30,150,30,0,150,0,0,150,30,30,150,30,0,150,0,30,150,30,30,150,0,0,0,0,0,0,30,0,150,30,0,0,0,0,150,30,0,150,0],r=[.22,.19,.22,.79,.34,.19,.22,.79,.34,.79,.34,.19,.34,.19,.34,.31,.62,.19,.34,.31,.62,.31,.62,.19,.34,.43,.34,.55,.49,.43,.34,.55,.49,.55,.49,.43,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0],t=Ft([18,0,0,1,18,0,0,-1,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,-1,0,6,-1,0,0]),n=Ft([18,200,70,120,18,80,70,200,6,70,200,210,6,200,200,70,6,210,100,70,6,210,160,70,6,70,180,210,6,100,70,210,6,76,210,100,6,140,210,80,6,90,130,110,6,160,160,220],[255]),o=e.length/3,i={position:M(3,o),texcoord:M(2,o),normal:M(3,o),color:M(4,o,Uint8Array),indices:M(3,o/3,Uint16Array)};i.position.push(e),i.texcoord.push(r),i.normal.push(t),i.color.push(n);for(let c=0;c<o;++c)i.indices.push(c);return i}function nr(e,r,t,n,o,i,c){if(o<=0)throw new Error("subdivisionDown must be > 0");i=i||0,c=c||1;let a=2,s=c-i,f=(o+1)*2*(2+a),u=M(3,f),p=M(3,f),m=M(2,f);function y(T,E,v){return T+(E-T)*v}function h(T,E,v,_,A,d){for(let g=0;g<=o;g++){let S=E/(a-1),F=g/o,I=(S-.5)*2,R=(i+F*s)*Math.PI,N=Math.sin(R),P=Math.cos(R),z=y(e,T,N),$=I*n,H=P*e,K=N*z;u.push($,H,K);let Z=Fo(Po([0,N,P],v),_);p.push(Z),m.push(S*A+d,F)}}for(let T=0;T<a;T++){let E=(T/(a-1)-.5)*2;h(r,T,[1,1,1],[0,0,0],1,0),h(r,T,[0,0,0],[E,0,0],0,0),h(t,T,[1,1,1],[0,0,0],1,0),h(t,T,[0,0,0],[E,0,0],0,1)}let l=M(3,o*2*(2+a),Uint16Array);function x(T,E){for(let v=0;v<o;++v)l.push(T+v+0,T+v+1,E+v+0),l.push(T+v+1,E+v+1,E+v+0)}let b=o+1;return x(b*0,b*4),x(b*5,b*7),x(b*6,b*2),x(b*3,b*1),{position:u,normal:p,texcoord:m,indices:l}}function nt(e,r,t,n,o,i){return tr(e,e,r,t,n,o,i)}function ot(e,r,t,n,o,i){if(t<3)throw new Error("radialSubdivisions must be 3 or greater");if(n<3)throw new Error("verticalSubdivisions must be 3 or greater");o=o||0,i=i||Math.PI*2;let c=i-o,a=t+1,s=n+1,f=a*s,u=M(3,f),p=M(3,f),m=M(2,f),y=M(3,t*n*2,Uint16Array);for(let h=0;h<s;++h){let l=h/n,x=l*Math.PI*2,b=Math.sin(x),T=e+b*r,E=Math.cos(x),v=E*r;for(let _=0;_<a;++_){let A=_/t,d=o+A*c,g=Math.sin(d),S=Math.cos(d),F=g*T,I=S*T,R=g*b,N=S*b;u.push(F,v,I),p.push(R,E,N),m.push(A,1-l)}}for(let h=0;h<n;++h)for(let l=0;l<t;++l){let x=1+l,b=1+h;y.push(a*h+l,a*b+l,a*h+x),y.push(a*b+l,a*b+x,a*h+x)}return{position:u,normal:p,texcoord:m,indices:y}}function it(e,r,t,n,o){if(r<3)throw new Error("divisions must be at least 3");t=t||1,o=o||1,n=n||0;let i=(r+1)*(t+1),c=M(3,i),a=M(3,i),s=M(2,i),f=M(3,t*r*2,Uint16Array),u=0,p=e-n,m=r+1;for(let y=0;y<=t;++y){let h=n+p*Math.pow(y/t,o);for(let l=0;l<=r;++l){let x=2*Math.PI*l/r,b=h*Math.cos(x),T=h*Math.sin(x);if(c.push(b,0,T),a.push(0,1,0),s.push(1-l/r,y/t),y>0&&l!==r){let E=u+(l+1),v=u+l,_=u+l-m,A=u+(l+1)-m;f.push(E,v,_),f.push(E,_,A)}}u+=r+1}return{position:c,normal:a,texcoord:s,indices:f}}function _i(e){return Math.random()*e|0}function Ti(e,r){r=r||{};let t=e.position.numElements,n=M(4,t,Uint8Array),o=r.rand||function(i,c){return c<3?_i(256):255};if(e.color=n,e.indices)for(let i=0;i<t;++i)n.push(o(i,0),o(i,1),o(i,2),o(i,3));else{let i=r.vertsPerColor||3,c=t/i;for(let a=0;a<c;++a){let s=[o(a,0),o(a,1),o(a,2),o(a,3)];for(let f=0;f<i;++f)n.push(s)}}return e}function Y(e){return function(r){let t=e.apply(this,Array.prototype.slice.call(arguments,1));return mi(r,t)}}function W(e){return function(r){let t=e.apply(null,Array.prototype.slice.call(arguments,1));return Zr(r,t)}}var vi=["numComponents","size","type","normalize","stride","offset","attrib","name","attribName"];function wr(e,r,t,n){n=n||0;let o=e.length;for(let i=0;i<o;++i)r[t+i]=e[i]+n}function Qt(e,r){let t=ue(e),n=new t.constructor(r),o=n;return t.numComponents&&t.numElements&&Yt(n,t.numComponents),e.data&&(o={data:n},ko(vi,e,o)),o}function Ai(e){let r={},t;for(let a=0;a<e.length;++a){let s=e[a];Object.keys(s).forEach(function(f){r[f]||(r[f]=[]),!t&&f!=="indices"&&(t=f);let u=s[f],p=xi(u,f),y=ue(u).length/p;r[f].push(y)})}function n(a){let s=0,f;for(let u=0;u<e.length;++u){let m=e[u][a],y=ue(m);s+=y.length,(!f||m.data)&&(f=m)}return{length:s,spec:f}}function o(a,s,f){let u=0,p=0;for(let m=0;m<e.length;++m){let h=e[m][a],l=ue(h);a==="indices"?(wr(l,f,p,u),u+=s[m]):wr(l,f,p),p+=l.length}}let i=r[t],c={};return Object.keys(r).forEach(function(a){let s=n(a),f=Qt(s.spec,s.length);o(a,i,ue(f)),c[a]=f}),c}function gi(e){let r={};return Object.keys(e).forEach(function(t){let n=e[t],o=ue(n),i=Qt(n,o.length);wr(o,ue(i),0),r[t]=i}),r}var di=W(tt),Si=Y(tt),wi=W(rt),Fi=Y(rt),Pi=W(Jr),Ii=Y(Jr),Mi=W(et),Ri=Y(et),Ni=W(tr),Ci=Y(tr),Bi=W(Qr),Li=Y(Qr),Jt=W(nr),en=Y(nr),Ui=W(nt),Di=Y(nt),zi=W(ot),Oi=Y(ot),Gi=W(it),Vi=Y(it),ki=Jt,$i=en,Hi=nr,or=Object.freeze({__proto__:null,create3DFBufferInfo:di,create3DFBuffers:Si,create3DFVertices:tt,createAugmentedTypedArray:M,createCubeBufferInfo:wi,createCubeBuffers:Fi,createCubeVertices:rt,createPlaneBufferInfo:Pi,createPlaneBuffers:Ii,createPlaneVertices:Jr,createSphereBufferInfo:Mi,createSphereBuffers:Ri,createSphereVertices:et,createTruncatedConeBufferInfo:Ni,createTruncatedConeBuffers:Ci,createTruncatedConeVertices:tr,createXYQuadBufferInfo:Bi,createXYQuadBuffers:Li,createXYQuadVertices:Qr,createCresentBufferInfo:ki,createCresentBuffers:$i,createCresentVertices:Hi,createCrescentBufferInfo:Jt,createCrescentBuffers:en,createCrescentVertices:nr,createCylinderBufferInfo:Ui,createCylinderBuffers:Di,createCylinderVertices:nt,createTorusBufferInfo:zi,createTorusBuffers:Oi,createTorusVertices:ot,createDiscBufferInfo:Gi,createDiscBuffers:Vi,createDiscVertices:it,deindexVertices:pi,flattenNormals:yi,makeRandomVertexColors:Ti,reorientDirections:Wt,reorientNormals:Kt,reorientPositions:Zt,reorientVertices:qt,concatVertices:Ai,duplicateVertices:gi});function Ne(e){return!!e.texStorage2D}var rn=function(){let e={},r={};function t(n){let o=n.constructor.name;if(!e[o]){for(let i in n)if(typeof n[i]=="number"){let c=r[n[i]];r[n[i]]=c?`${c} | ${i}`:i}e[o]=!0}}return function(o,i){return t(o),r[i]||(typeof i=="number"?`0x${i.toString(16)}`:i)}}();var ne={textureColor:new Uint8Array([128,192,255,255]),textureOptions:{},crossOrigin:void 0},Me=Ie,tn=function(){let e;return function(){return e=e||(typeof document<"u"&&document.createElement?document.createElement("canvas").getContext("2d"):null),e}}(),Fr=6406,j=6407,B=6408,Pr=6409,Ir=6410,ve=6402,Mr=34041,Ze=33071,ji=9728,Xi=9729,oe=3553,te=34067,me=32879,xe=35866,ct=34069,Yi=34070,Wi=34071,Ki=34072,Zi=34073,qi=34074,Rr=10241,Nr=10240,qe=10242,Qe=10243,Pt=32882,Qi=33082,Ji=33083,ec=33084,rc=33085,at=3317,nn=3314,on=32878,cn=3316,an=3315,sn=32877,tc=37443,nc=37441,oc=37440,ic=33321,cc=36756,ac=33325,sc=33326,fc=33330,lc=33329,uc=33338,mc=33337,xc=33340,hc=33339,pc=33323,yc=36757,bc=33327,Ec=33328,_c=33336,Tc=33335,vc=33332,Ac=33331,gc=33334,dc=33333,Sc=32849,wc=35905,Fc=36194,Pc=36758,Ic=35898,Mc=35901,Rc=34843,Nc=34837,Cc=36221,Bc=36239,Lc=36215,Uc=36233,Dc=36209,zc=36227,Oc=32856,Gc=35907,Vc=36759,kc=32855,$c=32854,Hc=32857,jc=34842,Xc=34836,Yc=36220,Wc=36238,Kc=36975,Zc=36214,qc=36232,Qc=36226,Jc=36208,ea=33189,ra=33190,ta=36012,na=36013,oa=35056,J=5120,L=5121,Ye=5122,Te=5123,We=5124,ae=5125,G=5126,It=32819,Mt=32820,Rt=33635,X=5131,Se=36193,dr=33640,ia=35899,ca=35902,aa=36269,sa=34042,we=33319,se=33320,Fe=6403,fe=36244,le=36248,ee=36249,fa={};{let e=fa;e[Fr]={numColorComponents:1},e[Pr]={numColorComponents:1},e[Ir]={numColorComponents:2},e[j]={numColorComponents:3},e[B]={numColorComponents:4},e[Fe]={numColorComponents:1},e[fe]={numColorComponents:1},e[we]={numColorComponents:2},e[se]={numColorComponents:2},e[j]={numColorComponents:3},e[le]={numColorComponents:3},e[B]={numColorComponents:4},e[ee]={numColorComponents:4},e[ve]={numColorComponents:1},e[Mr]={numColorComponents:2}}var Sr;function ir(e){if(!Sr){let r={};r[Fr]={textureFormat:Fr,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[L,X,Se,G]},r[Pr]={textureFormat:Pr,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[L,X,Se,G]},r[Ir]={textureFormat:Ir,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4,4,8],type:[L,X,Se,G]},r[j]={textureFormat:j,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,6,6,12,2],type:[L,X,Se,G,Rt]},r[B]={textureFormat:B,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,8,8,16,2,2],type:[L,X,Se,G,It,Mt]},r[ve]={textureFormat:ve,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[ae,Te]},r[ic]={textureFormat:Fe,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1],type:[L]},r[cc]={textureFormat:Fe,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[1],type:[J]},r[ac]={textureFormat:Fe,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4,2],type:[G,X]},r[sc]={textureFormat:Fe,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[4],type:[G]},r[fc]={textureFormat:fe,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[L]},r[lc]={textureFormat:fe,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[J]},r[vc]={textureFormat:fe,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[Te]},r[Ac]={textureFormat:fe,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[Ye]},r[gc]={textureFormat:fe,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[ae]},r[dc]={textureFormat:fe,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[We]},r[pc]={textureFormat:we,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2],type:[L]},r[yc]={textureFormat:we,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[2],type:[J]},r[bc]={textureFormat:we,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[8,4],type:[G,X]},r[Ec]={textureFormat:we,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[8],type:[G]},r[_c]={textureFormat:se,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[L]},r[Tc]={textureFormat:se,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[J]},r[uc]={textureFormat:se,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Te]},r[mc]={textureFormat:se,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Ye]},r[xc]={textureFormat:se,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[ae]},r[hc]={textureFormat:se,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[We]},r[Sc]={textureFormat:j,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3],type:[L]},r[wc]={textureFormat:j,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[L]},r[Fc]={textureFormat:j,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,2],type:[L,Rt]},r[Pc]={textureFormat:j,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[J]},r[Ic]={textureFormat:j,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[G,X,ia]},r[Mc]={textureFormat:j,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[G,X,ca]},r[Rc]={textureFormat:j,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6],type:[G,X]},r[Nc]={textureFormat:j,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[G]},r[Cc]={textureFormat:le,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[L]},r[Bc]={textureFormat:le,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[J]},r[Lc]={textureFormat:le,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[Te]},r[Uc]={textureFormat:le,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[Ye]},r[Dc]={textureFormat:le,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[ae]},r[zc]={textureFormat:le,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[We]},r[Oc]={textureFormat:B,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[L]},r[Gc]={textureFormat:B,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[L]},r[Vc]={textureFormat:B,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4],type:[J]},r[kc]={textureFormat:B,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2,4],type:[L,Mt,dr]},r[$c]={textureFormat:B,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2],type:[L,It]},r[Hc]={textureFormat:B,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[dr]},r[jc]={textureFormat:B,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[16,8],type:[G,X]},r[Xc]={textureFormat:B,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[16],type:[G]},r[Yc]={textureFormat:ee,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[L]},r[Wc]={textureFormat:ee,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[J]},r[Kc]={textureFormat:ee,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[dr]},r[Zc]={textureFormat:ee,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Te]},r[qc]={textureFormat:ee,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Ye]},r[Qc]={textureFormat:ee,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[We]},r[Jc]={textureFormat:ee,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[ae]},r[ea]={textureFormat:ve,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[Te,ae]},r[ra]={textureFormat:ve,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[ae]},r[ta]={textureFormat:ve,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[G]},r[oa]={textureFormat:Mr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[sa]},r[na]={textureFormat:Mr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[aa]},Object.keys(r).forEach(function(t){let n=r[t];n.bytesPerElementMap={},n.bytesPerElement.forEach(function(o,i){let c=n.type[i];n.bytesPerElementMap[c]=o})}),Sr=r}return Sr[e]}function la(e,r){let t=ir(e);if(!t)throw"unknown internal format";let n=t.bytesPerElementMap[r];if(n===void 0)throw"unknown internal format";return n}function Ce(e){let r=ir(e);if(!r)throw"unknown internal format";return{format:r.textureFormat,type:r.type[0]}}function Nt(e){return(e&e-1)===0}function ua(e,r,t,n){if(!Ne(e))return Nt(r)&&Nt(t);let o=ir(n);if(!o)throw"unknown internal format";return o.colorRenderable&&o.textureFilterable}function ma(e){let r=ir(e);if(!r)throw"unknown internal format";return r.textureFilterable}function xa(e,r,t){return Me(r)?er(r):t||L}function Ke(e,r,t,n,o){if(o%1!==0)throw"can't guess dimensions";if(!t&&!n){let i=Math.sqrt(o/(r===te?6:1));i%1===0?(t=i,n=i):(t=o,n=1)}else if(n){if(!t&&(t=o/n,t%1))throw"can't guess dimensions"}else if(n=o/t,n%1)throw"can't guess dimensions";return{width:t,height:n}}function ge(e,r){r.colorspaceConversion!==void 0&&e.pixelStorei(tc,r.colorspaceConversion),r.premultiplyAlpha!==void 0&&e.pixelStorei(nc,r.premultiplyAlpha),r.flipY!==void 0&&e.pixelStorei(oc,r.flipY)}function fn(e){e.pixelStorei(at,4),Ne(e)&&(e.pixelStorei(nn,0),e.pixelStorei(on,0),e.pixelStorei(cn,0),e.pixelStorei(an,0),e.pixelStorei(sn,0))}function ha(e,r,t,n){n.minMag&&(t.call(e,r,Rr,n.minMag),t.call(e,r,Nr,n.minMag)),n.min&&t.call(e,r,Rr,n.min),n.mag&&t.call(e,r,Nr,n.mag),n.wrap&&(t.call(e,r,qe,n.wrap),t.call(e,r,Qe,n.wrap),(r===me||Ho(e,r))&&t.call(e,r,Pt,n.wrap)),n.wrapR&&t.call(e,r,Pt,n.wrapR),n.wrapS&&t.call(e,r,qe,n.wrapS),n.wrapT&&t.call(e,r,Qe,n.wrapT),n.minLod&&t.call(e,r,Qi,n.minLod),n.maxLod&&t.call(e,r,Ji,n.maxLod),n.baseLevel&&t.call(e,r,ec,n.baseLevel),n.maxLevel&&t.call(e,r,rc,n.maxLevel)}function ln(e,r,t){let n=t.target||oe;e.bindTexture(n,r),ha(e,n,e.texParameteri,t)}function pa(e){return e=e||ne.textureColor,Me(e)?e:new Uint8Array([e[0]*255,e[1]*255,e[2]*255,e[3]*255])}function Cr(e,r,t,n,o,i){t=t||ne.textureOptions,i=i||B;let c=t.target||oe;if(n=n||t.width,o=o||t.height,e.bindTexture(c,r),ua(e,n,o,i))e.generateMipmap(c);else{let a=ma(i)?Xi:ji;e.texParameteri(c,Rr,a),e.texParameteri(c,Nr,a),e.texParameteri(c,qe,Ze),e.texParameteri(c,Qe,Ze)}}function Re(e){return e.auto===!0||e.auto===void 0&&e.level===void 0}function Br(e,r){return r=r||{},r.cubeFaceOrder||[ct,Yi,Wi,Ki,Zi,qi]}function Lr(e,r){let n=Br(e,r).map(function(o,i){return{face:o,ndx:i}});return n.sort(function(o,i){return o.face-i.face}),n}function un(e,r,t,n){n=n||ne.textureOptions;let o=n.target||oe,i=n.level||0,c=t.width,a=t.height,s=n.internalFormat||n.format||B,f=Ce(s),u=n.format||f.format,p=n.type||f.type;if(ge(e,n),e.bindTexture(o,r),o===te){let m=t.width,y=t.height,h,l;if(m/6===y)h=y,l=[0,0,1,0,2,0,3,0,4,0,5,0];else if(y/6===m)h=m,l=[0,0,0,1,0,2,0,3,0,4,0,5];else if(m/3===y/2)h=m/3,l=[0,0,1,0,2,0,0,1,1,1,2,1];else if(m/2===y/3)h=m/2,l=[0,0,1,0,0,1,1,1,0,2,1,2];else throw"can't figure out cube map from element: "+(t.src?t.src:t.nodeName);let x=tn();x?(x.canvas.width=h,x.canvas.height=h,c=h,a=h,Lr(e,n).forEach(function(b){let T=l[b.ndx*2+0]*h,E=l[b.ndx*2+1]*h;x.drawImage(t,T,E,h,h,0,0,h,h),e.texImage2D(b.face,i,s,u,p,x.canvas)}),x.canvas.width=1,x.canvas.height=1):typeof createImageBitmap<"u"&&(c=h,a=h,Lr(e,n).forEach(function(b){let T=l[b.ndx*2+0]*h,E=l[b.ndx*2+1]*h;e.texImage2D(b.face,i,s,h,h,0,u,p,null),createImageBitmap(t,T,E,h,h,{premultiplyAlpha:"none",colorSpaceConversion:"none"}).then(function(v){ge(e,n),e.bindTexture(o,r),e.texImage2D(b.face,i,s,u,p,v),Re(n)&&Cr(e,r,n,c,a,s)})}))}else if(o===me||o===xe){let m=Math.min(t.width,t.height),y=Math.max(t.width,t.height),h=y/m;if(h%1!==0)throw"can not compute 3D dimensions of element";let l=t.width===y?1:0,x=t.height===y?1:0;e.pixelStorei(at,1),e.pixelStorei(nn,t.width),e.pixelStorei(on,0),e.pixelStorei(sn,0),e.texImage3D(o,i,s,m,m,m,0,u,p,null);for(let b=0;b<h;++b){let T=b*m*l,E=b*m*x;e.pixelStorei(cn,T),e.pixelStorei(an,E),e.texSubImage3D(o,i,0,0,b,m,m,1,u,p,t)}fn(e)}else e.texImage2D(o,i,s,u,p,t);Re(n)&&Cr(e,r,n,c,a,s),ln(e,r,n)}function Be(){}function ya(e){if(typeof document<"u"){let r=document.createElement("a");return r.href=e,r.hostname===location.hostname&&r.port===location.port&&r.protocol===location.protocol}else{let r=new URL(location.href).origin;return new URL(e,location.href).origin===r}}function ba(e,r){return r===void 0&&!ya(e)?"anonymous":r}function Ea(e,r,t){t=t||Be;let n;if(r=r!==void 0?r:ne.crossOrigin,r=ba(e,r),typeof Image<"u"){n=new Image,r!==void 0&&(n.crossOrigin=r);let o=function(){n.removeEventListener("error",i),n.removeEventListener("load",c),n=null},i=function(){let s="couldn't load image: "+e;Gt(s),t(s,n),o()},c=function(){t(null,n),o()};return n.addEventListener("error",i),n.addEventListener("load",c),n.src=e,n}else if(typeof ImageBitmap<"u"){let o,i,c=function(){t(o,i)},a={};r&&(a.mode="cors"),fetch(e,a).then(function(s){if(!s.ok)throw s;return s.blob()}).then(function(s){return createImageBitmap(s,{premultiplyAlpha:"none",colorSpaceConversion:"none"})}).then(function(s){i=s,setTimeout(c)}).catch(function(s){o=s,setTimeout(c)}),n=null}return n}function mn(e){return typeof ImageBitmap<"u"&&e instanceof ImageBitmap||typeof ImageData<"u"&&e instanceof ImageData||typeof HTMLElement<"u"&&e instanceof HTMLElement}function st(e,r,t){return mn(e)?(setTimeout(function(){t(null,e)}),e):Ea(e,r,t)}function ft(e,r,t){t=t||ne.textureOptions;let n=t.target||oe;if(e.bindTexture(n,r),t.color===!1)return;let o=pa(t.color);if(n===te)for(let i=0;i<6;++i)e.texImage2D(ct+i,0,B,1,1,0,B,L,o);else n===me||n===xe?e.texImage3D(n,0,B,1,1,1,0,B,L,o):e.texImage2D(n,0,B,1,1,0,B,L,o)}function _a(e,r,t,n){return n=n||Be,t=t||ne.textureOptions,ft(e,r,t),t=Object.assign({},t),st(t.src,t.crossOrigin,function(i,c){i?n(i,r,c):(un(e,r,c,t),n(null,r,c))})}function Ta(e,r,t,n){n=n||Be;let o=t.src;if(o.length!==6)throw"there must be 6 urls for a cubemap";let i=t.level||0,c=t.internalFormat||t.format||B,a=Ce(c),s=t.format||a.format,f=t.type||L,u=t.target||oe;if(u!==te)throw"target must be TEXTURE_CUBE_MAP";ft(e,r,t),t=Object.assign({},t);let p=6,m=[],y=Br(e,t),h;function l(x){return function(b,T){--p,b?m.push(b):T.width!==T.height?m.push("cubemap face img is not a square: "+T.src):(ge(e,t),e.bindTexture(u,r),p===5?Br().forEach(function(E){e.texImage2D(E,i,c,s,f,T)}):e.texImage2D(x,i,c,s,f,T),Re(t)&&e.generateMipmap(u)),p===0&&n(m.length?m:void 0,r,h)}}h=o.map(function(x,b){return st(x,t.crossOrigin,l(y[b]))})}function va(e,r,t,n){n=n||Be;let o=t.src,i=t.internalFormat||t.format||B,c=Ce(i),a=t.format||c.format,s=t.type||L,f=t.target||xe;if(f!==me&&f!==xe)throw"target must be TEXTURE_3D or TEXTURE_2D_ARRAY";ft(e,r,t),t=Object.assign({},t);let u=o.length,p=[],m,y=t.level||0,h=t.width,l=t.height,x=o.length,b=!0;function T(E){return function(v,_){if(--u,v)p.push(v);else{if(ge(e,t),e.bindTexture(f,r),b){b=!1,h=t.width||_.width,l=t.height||_.height,e.texImage3D(f,y,i,h,l,x,0,a,s,null);for(let A=0;A<x;++A)e.texSubImage3D(f,y,0,0,A,h,l,1,a,s,_)}else{let A=_,d;(_.width!==h||_.height!==l)&&(d=tn(),A=d.canvas,d.canvas.width=h,d.canvas.height=l,d.drawImage(_,0,0,h,l)),e.texSubImage3D(f,y,0,0,E,h,l,1,a,s,A),d&&A===d.canvas&&(d.canvas.width=0,d.canvas.height=0)}Re(t)&&e.generateMipmap(f)}u===0&&n(p.length?p:void 0,r,m)}}m=o.map(function(E,v){return st(E,t.crossOrigin,T(v))})}function Aa(e,r,t,n){n=n||ne.textureOptions;let o=n.target||oe;e.bindTexture(o,r);let i=n.width,c=n.height,a=n.depth,s=n.level||0,f=n.internalFormat||n.format||B,u=Ce(f),p=n.format||u.format,m=n.type||xa(e,t,u.type);if(Me(t))t instanceof Uint8ClampedArray&&(t=new Uint8Array(t.buffer));else{let x=Ot(m);t=new x(t)}let y=la(f,m),h=t.byteLength/y;if(h%1)throw"length wrong size for format: "+rn(e,p);let l;if(o===me||o===xe)if(!i&&!c&&!a){let x=Math.cbrt(h);if(x%1!==0)throw"can't guess cube size of array of numElements: "+h;i=x,c=x,a=x}else i&&(!c||!a)?(l=Ke(e,o,c,a,h/i),c=l.width,a=l.height):c&&(!i||!a)?(l=Ke(e,o,i,a,h/c),i=l.width,a=l.height):(l=Ke(e,o,i,c,h/a),i=l.width,c=l.height);else l=Ke(e,o,i,c,h),i=l.width,c=l.height;if(fn(e),e.pixelStorei(at,n.unpackAlignment||1),ge(e,n),o===te){let x=y/t.BYTES_PER_ELEMENT,b=h/6*x;Lr(e,n).forEach(T=>{let E=b*T.ndx,v=t.subarray(E,E+b);e.texImage2D(T.face,s,f,i,c,0,p,m,v)})}else o===me||o===xe?e.texImage3D(o,s,f,i,c,a,0,p,m,t):e.texImage2D(o,s,f,i,c,0,p,m,t);return{width:i,height:c,depth:a,type:m}}function ga(e,r,t){let n=t.target||oe;e.bindTexture(n,r);let o=t.level||0,i=t.internalFormat||t.format||B,c=Ce(i),a=t.format||c.format,s=t.type||c.type;if(ge(e,t),n===te)for(let f=0;f<6;++f)e.texImage2D(ct+f,o,i,t.width,t.height,0,a,s,null);else n===me||n===xe?e.texImage3D(n,o,i,t.width,t.height,t.depth,0,a,s,null):e.texImage2D(n,o,i,t.width,t.height,0,a,s,null)}function lt(e,r,t){t=t||Be,r=r||ne.textureOptions;let n=e.createTexture(),o=r.target||oe,i=r.width||1,c=r.height||1,a=r.internalFormat||B;e.bindTexture(o,n),o===te&&(e.texParameteri(o,qe,Ze),e.texParameteri(o,Qe,Ze));let s=r.src;if(s)if(typeof s=="function"&&(s=s(e,r)),typeof s=="string")_a(e,n,r,t);else if(Me(s)||Array.isArray(s)&&(typeof s[0]=="number"||Array.isArray(s[0])||Me(s[0]))){let f=Aa(e,n,s,r);i=f.width,c=f.height}else Array.isArray(s)&&(typeof s[0]=="string"||mn(s[0]))?o===te?Ta(e,n,r,t):va(e,n,r,t):(un(e,n,s,r),i=s.width,c=s.height);else ga(e,n,r);return Re(r)&&Cr(e,n,r,i,c,a),ln(e,n,r),n}var ut=Gt;function xn(e){return typeof document<"u"&&document.getElementById?document.getElementById(e):null}var Je=33984;var cr=34962,da=34963;var Sa=35713,wa=35714,Fa=35632,Pa=35633,Ia=35981,hn=35718,Ma=35721,Ra=35971,Na=35382,Ca=35396,Ba=35398,La=35392,Ua=35395,ar=5126,pn=35664,yn=35665,bn=35666,mt=5124,En=35667,_n=35668,Tn=35669,vn=35670,An=35671,gn=35672,dn=35673,Sn=35674,wn=35675,Fn=35676,Da=35678,za=35680,Oa=35679,Ga=35682,Va=35685,ka=35686,$a=35687,Ha=35688,ja=35689,Xa=35690,Ya=36289,Wa=36292,Ka=36293,xt=5125,Pn=36294,In=36295,Mn=36296,Za=36298,qa=36299,Qa=36300,Ja=36303,es=36306,rs=36307,ts=36308,ns=36311,sr=3553,fr=34067,ht=32879,lr=35866,w={};function Rn(e,r){return w[r].bindPoint}function os(e,r){return function(t){e.uniform1f(r,t)}}function is(e,r){return function(t){e.uniform1fv(r,t)}}function cs(e,r){return function(t){e.uniform2fv(r,t)}}function as(e,r){return function(t){e.uniform3fv(r,t)}}function ss(e,r){return function(t){e.uniform4fv(r,t)}}function Nn(e,r){return function(t){e.uniform1i(r,t)}}function Cn(e,r){return function(t){e.uniform1iv(r,t)}}function Bn(e,r){return function(t){e.uniform2iv(r,t)}}function Ln(e,r){return function(t){e.uniform3iv(r,t)}}function Un(e,r){return function(t){e.uniform4iv(r,t)}}function fs(e,r){return function(t){e.uniform1ui(r,t)}}function ls(e,r){return function(t){e.uniform1uiv(r,t)}}function us(e,r){return function(t){e.uniform2uiv(r,t)}}function ms(e,r){return function(t){e.uniform3uiv(r,t)}}function xs(e,r){return function(t){e.uniform4uiv(r,t)}}function hs(e,r){return function(t){e.uniformMatrix2fv(r,!1,t)}}function ps(e,r){return function(t){e.uniformMatrix3fv(r,!1,t)}}function ys(e,r){return function(t){e.uniformMatrix4fv(r,!1,t)}}function bs(e,r){return function(t){e.uniformMatrix2x3fv(r,!1,t)}}function Es(e,r){return function(t){e.uniformMatrix3x2fv(r,!1,t)}}function _s(e,r){return function(t){e.uniformMatrix2x4fv(r,!1,t)}}function Ts(e,r){return function(t){e.uniformMatrix4x2fv(r,!1,t)}}function vs(e,r){return function(t){e.uniformMatrix3x4fv(r,!1,t)}}function As(e,r){return function(t){e.uniformMatrix4x3fv(r,!1,t)}}function V(e,r,t,n){let o=Rn(e,r);return Ne(e)?function(i){let c,a;!i||Vt(e,i)?(c=i,a=null):(c=i.texture,a=i.sampler),e.uniform1i(n,t),e.activeTexture(Je+t),e.bindTexture(o,c),e.bindSampler(t,a)}:function(i){e.uniform1i(n,t),e.activeTexture(Je+t),e.bindTexture(o,i)}}function k(e,r,t,n,o){let i=Rn(e,r),c=new Int32Array(o);for(let a=0;a<o;++a)c[a]=t+a;return Ne(e)?function(a){e.uniform1iv(n,c),a.forEach(function(s,f){e.activeTexture(Je+c[f]);let u,p;!s||Vt(e,s)?(u=s,p=null):(u=s.texture,p=s.sampler),e.bindSampler(t,p),e.bindTexture(i,u)})}:function(a){e.uniform1iv(n,c),a.forEach(function(s,f){e.activeTexture(Je+c[f]),e.bindTexture(i,s)})}}w[ar]={Type:Float32Array,size:4,setter:os,arraySetter:is};w[pn]={Type:Float32Array,size:8,setter:cs,cols:2};w[yn]={Type:Float32Array,size:12,setter:as,cols:3};w[bn]={Type:Float32Array,size:16,setter:ss,cols:4};w[mt]={Type:Int32Array,size:4,setter:Nn,arraySetter:Cn};w[En]={Type:Int32Array,size:8,setter:Bn,cols:2};w[_n]={Type:Int32Array,size:12,setter:Ln,cols:3};w[Tn]={Type:Int32Array,size:16,setter:Un,cols:4};w[xt]={Type:Uint32Array,size:4,setter:fs,arraySetter:ls};w[Pn]={Type:Uint32Array,size:8,setter:us,cols:2};w[In]={Type:Uint32Array,size:12,setter:ms,cols:3};w[Mn]={Type:Uint32Array,size:16,setter:xs,cols:4};w[vn]={Type:Uint32Array,size:4,setter:Nn,arraySetter:Cn};w[An]={Type:Uint32Array,size:8,setter:Bn,cols:2};w[gn]={Type:Uint32Array,size:12,setter:Ln,cols:3};w[dn]={Type:Uint32Array,size:16,setter:Un,cols:4};w[Sn]={Type:Float32Array,size:32,setter:hs,rows:2,cols:2};w[wn]={Type:Float32Array,size:48,setter:ps,rows:3,cols:3};w[Fn]={Type:Float32Array,size:64,setter:ys,rows:4,cols:4};w[Va]={Type:Float32Array,size:32,setter:bs,rows:2,cols:3};w[ka]={Type:Float32Array,size:32,setter:_s,rows:2,cols:4};w[$a]={Type:Float32Array,size:48,setter:Es,rows:3,cols:2};w[Ha]={Type:Float32Array,size:48,setter:vs,rows:3,cols:4};w[ja]={Type:Float32Array,size:64,setter:Ts,rows:4,cols:2};w[Xa]={Type:Float32Array,size:64,setter:As,rows:4,cols:3};w[Da]={Type:null,size:0,setter:V,arraySetter:k,bindPoint:sr};w[za]={Type:null,size:0,setter:V,arraySetter:k,bindPoint:fr};w[Oa]={Type:null,size:0,setter:V,arraySetter:k,bindPoint:ht};w[Ga]={Type:null,size:0,setter:V,arraySetter:k,bindPoint:sr};w[Ya]={Type:null,size:0,setter:V,arraySetter:k,bindPoint:lr};w[Wa]={Type:null,size:0,setter:V,arraySetter:k,bindPoint:lr};w[Ka]={Type:null,size:0,setter:V,arraySetter:k,bindPoint:fr};w[Za]={Type:null,size:0,setter:V,arraySetter:k,bindPoint:sr};w[qa]={Type:null,size:0,setter:V,arraySetter:k,bindPoint:ht};w[Qa]={Type:null,size:0,setter:V,arraySetter:k,bindPoint:fr};w[Ja]={Type:null,size:0,setter:V,arraySetter:k,bindPoint:lr};w[es]={Type:null,size:0,setter:V,arraySetter:k,bindPoint:sr};w[rs]={Type:null,size:0,setter:V,arraySetter:k,bindPoint:ht};w[ts]={Type:null,size:0,setter:V,arraySetter:k,bindPoint:fr};w[ns]={Type:null,size:0,setter:V,arraySetter:k,bindPoint:lr};function ur(e,r){return function(t){if(t.value)switch(e.disableVertexAttribArray(r),t.value.length){case 4:e.vertexAttrib4fv(r,t.value);break;case 3:e.vertexAttrib3fv(r,t.value);break;case 2:e.vertexAttrib2fv(r,t.value);break;case 1:e.vertexAttrib1fv(r,t.value);break;default:throw new Error("the length of a float constant value must be between 1 and 4!")}else e.bindBuffer(cr,t.buffer),e.enableVertexAttribArray(r),e.vertexAttribPointer(r,t.numComponents||t.size,t.type||ar,t.normalize||!1,t.stride||0,t.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(r,t.divisor||0)}}function ie(e,r){return function(t){if(t.value)if(e.disableVertexAttribArray(r),t.value.length===4)e.vertexAttrib4iv(r,t.value);else throw new Error("The length of an integer constant value must be 4!");else e.bindBuffer(cr,t.buffer),e.enableVertexAttribArray(r),e.vertexAttribIPointer(r,t.numComponents||t.size,t.type||mt,t.stride||0,t.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(r,t.divisor||0)}}function mr(e,r){return function(t){if(t.value)if(e.disableVertexAttribArray(r),t.value.length===4)e.vertexAttrib4uiv(r,t.value);else throw new Error("The length of an unsigned integer constant value must be 4!");else e.bindBuffer(cr,t.buffer),e.enableVertexAttribArray(r),e.vertexAttribIPointer(r,t.numComponents||t.size,t.type||xt,t.stride||0,t.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(r,t.divisor||0)}}function pt(e,r,t){let n=t.size,o=t.count;return function(i){e.bindBuffer(cr,i.buffer);let c=i.size||i.numComponents||n,a=c/o,s=i.type||ar,u=w[s].size*c,p=i.normalize||!1,m=i.offset||0,y=u/o;for(let h=0;h<o;++h)e.enableVertexAttribArray(r+h),e.vertexAttribPointer(r+h,a,s,p,u,m+y*h),e.vertexAttribDivisor&&e.vertexAttribDivisor(r+h,i.divisor||0)}}var D={};D[ar]={size:4,setter:ur};D[pn]={size:8,setter:ur};D[yn]={size:12,setter:ur};D[bn]={size:16,setter:ur};D[mt]={size:4,setter:ie};D[En]={size:8,setter:ie};D[_n]={size:12,setter:ie};D[Tn]={size:16,setter:ie};D[xt]={size:4,setter:mr};D[Pn]={size:8,setter:mr};D[In]={size:12,setter:mr};D[Mn]={size:16,setter:mr};D[vn]={size:4,setter:ie};D[An]={size:8,setter:ie};D[gn]={size:12,setter:ie};D[dn]={size:16,setter:ie};D[Sn]={size:4,setter:pt,count:2};D[wn]={size:9,setter:pt,count:3};D[Fn]={size:16,setter:pt,count:4};var gs=/ERROR:\s*\d+:(\d+)/gi;function ds(e,r="",t=0){let n=[...r.matchAll(gs)],o=new Map(n.map((i,c)=>{let a=parseInt(i[1]),s=n[c+1],f=s?s.index:r.length,u=r.substring(i.index,f);return[a-1,u]}));return e.split(`
`).map((i,c)=>{let a=o.get(c);return`${c+1+t}: ${i}${a?`

^^^ ${a}`:""}`}).join(`
`)}var Ct=/^[ \t]*\n/;function Dn(e){let r=0;return Ct.test(e)&&(r=1,e=e.replace(Ct,"")),{lineOffset:r,shaderSource:e}}function Ss(e,r){return e.errorCallback(r),e.callback&&setTimeout(()=>{e.callback(`${r}
${e.errors.join(`
`)}`)}),null}function ws(e,r,t,n){if(n=n||ut,!e.getShaderParameter(t,Sa)){let i=e.getShaderInfoLog(t),{lineOffset:c,shaderSource:a}=Dn(e.getShaderSource(t)),s=`${ds(a,i,c)}
Error compiling ${rn(e,r)}: ${i}`;return n(s),s}return""}function Le(e,r,t){let n,o,i;if(typeof r=="function"&&(t=r,r=void 0),typeof e=="function")t=e,e=void 0;else if(e&&!Array.isArray(e)){let f=e;t=f.errorCallback,e=f.attribLocations,n=f.transformFeedbackVaryings,o=f.transformFeedbackMode,i=f.callback}let c=t||ut,a=[],s={errorCallback(f,...u){a.push(f),c(f,...u)},transformFeedbackVaryings:n,transformFeedbackMode:o,callback:i,errors:a};{let f={};Array.isArray(e)?e.forEach(function(u,p){f[u]=r?r[p]:p}):f=e||{},s.attribLocations=f}return s}var Fs=["VERTEX_SHADER","FRAGMENT_SHADER"];function Ps(e,r){if(r.indexOf("frag")>=0)return Fa;if(r.indexOf("vert")>=0)return Pa}function Is(e,r,t){let n=e.getAttachedShaders(r);for(let o of n)t.has(o)&&e.deleteShader(o);e.deleteProgram(r)}var Ms=(e=0)=>new Promise(r=>setTimeout(r,e));function zn(e,r,t){let n=e.createProgram(),{attribLocations:o,transformFeedbackVaryings:i,transformFeedbackMode:c}=Le(t);for(let a=0;a<r.length;++a){let s=r[a];if(typeof s=="string"){let f=xn(s),u=f?f.text:s,p=e[Fs[a]];f&&f.type&&(p=Ps(e,f.type)||p),s=e.createShader(p),e.shaderSource(s,Dn(u).shaderSource),e.compileShader(s),e.attachShader(n,s)}}Object.entries(o).forEach(([a,s])=>e.bindAttribLocation(n,s,a));{let a=i;a&&(a.attribs&&(a=a.attribs),Array.isArray(a)||(a=Object.keys(a)),e.transformFeedbackVaryings(n,a,c||Ia))}return e.linkProgram(n),n}function On(e,r,t,n,o){let i=Le(t,n,o),c=new Set(r),a=zn(e,r,i);function s(f,u){let p=Vn(f,u,i.errorCallback);return p&&Is(f,u,c),p}if(i.callback){Gn(e,a).then(()=>{let f=s(e,a);i.callback(f,f?void 0:a)});return}return s(e,a)?void 0:a}function xr(e){return function(r,t,...n){return new Promise((o,i)=>{let c=Le(...n);c.callback=(a,s)=>{a?i(a):o(s)},e(r,t,c)})}}var r0=xr(On),t0=xr(Ue);async function Gn(e,r){let t=e.getExtension("KHR_parallel_shader_compile"),n=t?(i,c)=>i.getProgramParameter(c,t.COMPLETION_STATUS_KHR):()=>!0,o=0;do await Ms(o),o=1e3/60;while(!n(e,r))}async function Rs(e,r){for(let t of Object.values(r))await Gn(e,t)}function Vn(e,r,t){if(t=t||ut,!e.getProgramParameter(r,wa)){let o=e.getProgramInfoLog(r);t(`Error in program linking: ${o}`);let c=e.getAttachedShaders(r).map(a=>ws(e,e.getShaderParameter(a,e.SHADER_TYPE),a,t));return`${o}
${c.filter(a=>a).join(`
`)}`}}function Ns(e,r,t,n,o){return On(e,r,t,n,o)}function kn(e){let r=e.name;return r.startsWith("gl_")||r.startsWith("webgl_")}var Cs=/(\.|\[|]|\w+)/g,Bs=e=>e>="0"&&e<="9";function Ls(e,r,t,n){let o=e.split(Cs).filter(a=>a!==""),i=0,c="";for(;;){let a=o[i++];c+=a;let s=Bs(a[0]),f=s?parseInt(a):a;if(s&&(c+=o[i++]),i===o.length){t[f]=r;break}else{let p=o[i++],m=p==="[",y=t[f]||(m?[]:{});t[f]=y,t=y,n[c]=n[c]||function(h){return function(l){$n(h,l)}}(y),c+=p}}}function Us(e,r){let t=0;function n(a,s,f){let u=s.name.endsWith("[0]"),p=s.type,m=w[p];if(!m)throw new Error(`unknown type: 0x${p.toString(16)}`);let y;if(m.bindPoint){let h=t;t+=s.size,u?y=m.arraySetter(e,p,h,f,s.size):y=m.setter(e,p,h,f,s.size)}else m.arraySetter&&u?y=m.arraySetter(e,f):y=m.setter(e,f);return y.location=f,y}let o={},i={},c=e.getProgramParameter(r,hn);for(let a=0;a<c;++a){let s=e.getActiveUniform(r,a);if(kn(s))continue;let f=s.name;f.endsWith("[0]")&&(f=f.substr(0,f.length-3));let u=e.getUniformLocation(r,s.name);if(u){let p=n(r,s,u);o[f]=p,Ls(f,p,i,o)}}return o}function Ds(e,r){let t={},n=e.getProgramParameter(r,Ra);for(let o=0;o<n;++o){let i=e.getTransformFeedbackVarying(r,o);t[i.name]={index:o,type:i.type,size:i.size}}return t}function zs(e,r){let t=e.getProgramParameter(r,hn),n=[],o=[];for(let a=0;a<t;++a){o.push(a),n.push({});let s=e.getActiveUniform(r,a);n[a].name=s.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach(function(a){let s=a[0],f=a[1];e.getActiveUniforms(r,o,e[s]).forEach(function(u,p){n[p][f]=u})});let i={},c=e.getProgramParameter(r,Na);for(let a=0;a<c;++a){let s=e.getActiveUniformBlockName(r,a),f={index:e.getUniformBlockIndex(r,s),usedByVertexShader:e.getActiveUniformBlockParameter(r,a,Ca),usedByFragmentShader:e.getActiveUniformBlockParameter(r,a,Ba),size:e.getActiveUniformBlockParameter(r,a,La),uniformIndices:e.getActiveUniformBlockParameter(r,a,Ua)};f.used=f.usedByVertexShader||f.usedByFragmentShader,i[s]=f}return{blockSpecs:i,uniformData:n}}function $n(e,r){for(let t in r){let n=e[t];typeof n=="function"?n(r[t]):$n(e[t],r[t])}}function q(e,...r){let t=e.uniformSetters||e,n=r.length;for(let o=0;o<n;++o){let i=r[o];if(Array.isArray(i)){let c=i.length;for(let a=0;a<c;++a)q(t,i[a])}else for(let c in i){let a=t[c];a&&a(i[c])}}}function Os(e,r){let t={},n=e.getProgramParameter(r,Ma);for(let o=0;o<n;++o){let i=e.getActiveAttrib(r,o);if(kn(i))continue;let c=e.getAttribLocation(r,i.name),a=D[i.type],s=a.setter(e,c,a);s.location=c,t[i.name]=s}return t}function Gs(e,r){for(let t in r){let n=e[t];n&&n(r[t])}}function hr(e,r,t){t.vertexArrayObject?e.bindVertexArray(t.vertexArrayObject):(Gs(r.attribSetters||r,t.attribs),t.indices&&e.bindBuffer(da,t.indices))}function Ur(e,r){let t=Us(e,r),n=Os(e,r),o={program:r,uniformSetters:t,attribSetters:n};return Ne(e)&&(o.uniformBlockSpec=zs(e,r),o.transformFeedbackInfo=Ds(e,r)),o}var Vs=/\s|{|}|;/;function Ue(e,r,t,n,o){let i=Le(t,n,o),c=[];if(r=r.map(function(f){if(!Vs.test(f)){let u=xn(f);if(u)f=u.text;else{let p=`no element with id: ${f}`;i.errorCallback(p),c.push(p)}}return f}),c.length)return Ss(i,"");let a=i.callback;a&&(i.callback=(f,u)=>{a(f,f?void 0:Ur(e,u))});let s=Ns(e,r,i);return s?Ur(e,s):null}function Bt(e,r,t,n,o){for(let[i,c]of Object.entries(r)){let a={...o},s=t[i];Array.isArray(s)||Object.assign(a,s);let f=Vn(e,c,a.errorCallback);if(f){for(let u of Object.values(r)){let p=e.getAttachedShaders(u);e.deleteProgram(u);for(let m of p)n.has(m)||e.deleteShader(m)}return f}}}function Hn(e,r,t={}){let n=new Set,o=Object.fromEntries(Object.entries(r).map(([c,a])=>{let s={...t},f=Array.isArray(a)?a:a.shaders;return Array.isArray(a)||Object.assign(s,a),f.forEach(n.add,n),[c,zn(e,f,s)]}));if(t.callback){Rs(e,o).then(()=>{let c=Bt(e,o,r,n,t);t.callback(c,c?void 0:o)});return}return Bt(e,o,r,n,t)?void 0:o}function ks(e,r,t){t=Le(t);function n(c,a){return Object.fromEntries(Object.entries(a).map(([s,f])=>[s,Ur(c,f)]))}let o=t.callback;o&&(t.callback=(c,a)=>{o(c,c?void 0:n(e,a))});let i=Hn(e,r,t);if(!(o||!i))return n(e,i)}var n0=xr(Hn),o0=xr(ks);var $s=4,Lt=5123;function pr(e,r,t,n,o,i){t=t===void 0?$s:t;let c=r.indices,a=r.elementType,s=n===void 0?r.numElements:n;o=o===void 0?0:o,a||c?i!==void 0?e.drawElementsInstanced(t,s,a===void 0?Lt:r.elementType,o,i):e.drawElements(t,s,a===void 0?Lt:r.elementType,o):i!==void 0?e.drawArraysInstanced(t,o,s,i):e.drawArrays(t,o,s)}var Hs=6402;var js=33190,Xs=36012,Ys=35056,Ws=36013,Ks=32854,Zs=32855,qs=36194,jn=33189,Xn=6401,Yn=36168,Wn=34041;var yr=36096,Kn=36128,yt=33306;var Q={};Q[Wn]=yt;Q[Xn]=Kn;Q[Yn]=Kn;Q[Hs]=yr;Q[jn]=yr;Q[js]=yr;Q[Xs]=yr;Q[Ys]=yt;Q[Ws]=yt;var he={};he[Ks]=!0;he[Zs]=!0;he[qs]=!0;he[Wn]=!0;he[jn]=!0;he[Xn]=!0;he[Yn]=!0;function Zn(e,r){r=r||1,r=Math.max(0,r);let t=e.clientWidth*r|0,n=e.clientHeight*r|0;return e.width!==t||e.height!==n?(e.width=t,e.height=n,!0):!1}var U=1e-6,pe=typeof Float32Array<"u"?Float32Array:Array;var c0=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var e=0,r=arguments.length;r--;)e+=arguments[r]*arguments[r];return Math.sqrt(e)});var C={};So(C,{add:()=>Df,adjoint:()=>af,clone:()=>ef,copy:()=>rf,create:()=>Js,determinant:()=>sf,equals:()=>Vf,exactEquals:()=>Gf,frob:()=>Uf,fromQuat:()=>wf,fromQuat2:()=>vf,fromRotation:()=>bf,fromRotationTranslation:()=>Jn,fromRotationTranslationScale:()=>df,fromRotationTranslationScaleOrigin:()=>Sf,fromScaling:()=>yf,fromTranslation:()=>pf,fromValues:()=>tf,fromXRotation:()=>Ef,fromYRotation:()=>_f,fromZRotation:()=>Tf,frustum:()=>Ff,getRotation:()=>gf,getScaling:()=>eo,getTranslation:()=>Af,identity:()=>qn,invert:()=>cf,lookAt:()=>Cf,mul:()=>kf,multiply:()=>Qn,multiplyScalar:()=>zf,multiplyScalarAndAdd:()=>Of,ortho:()=>Rf,orthoNO:()=>to,orthoZO:()=>Nf,perspective:()=>Pf,perspectiveFromFieldOfView:()=>Mf,perspectiveNO:()=>ro,perspectiveZO:()=>If,rotate:()=>uf,rotateX:()=>mf,rotateY:()=>xf,rotateZ:()=>hf,scale:()=>lf,set:()=>nf,str:()=>Lf,sub:()=>$f,subtract:()=>no,targetTo:()=>Bf,translate:()=>ff,transpose:()=>of});function Js(){var e=new pe(16);return pe!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function ef(e){var r=new pe(16);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function rf(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function tf(e,r,t,n,o,i,c,a,s,f,u,p,m,y,h,l){var x=new pe(16);return x[0]=e,x[1]=r,x[2]=t,x[3]=n,x[4]=o,x[5]=i,x[6]=c,x[7]=a,x[8]=s,x[9]=f,x[10]=u,x[11]=p,x[12]=m,x[13]=y,x[14]=h,x[15]=l,x}function nf(e,r,t,n,o,i,c,a,s,f,u,p,m,y,h,l,x){return e[0]=r,e[1]=t,e[2]=n,e[3]=o,e[4]=i,e[5]=c,e[6]=a,e[7]=s,e[8]=f,e[9]=u,e[10]=p,e[11]=m,e[12]=y,e[13]=h,e[14]=l,e[15]=x,e}function qn(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function of(e,r){if(e===r){var t=r[1],n=r[2],o=r[3],i=r[6],c=r[7],a=r[11];e[1]=r[4],e[2]=r[8],e[3]=r[12],e[4]=t,e[6]=r[9],e[7]=r[13],e[8]=n,e[9]=i,e[11]=r[14],e[12]=o,e[13]=c,e[14]=a}else e[0]=r[0],e[1]=r[4],e[2]=r[8],e[3]=r[12],e[4]=r[1],e[5]=r[5],e[6]=r[9],e[7]=r[13],e[8]=r[2],e[9]=r[6],e[10]=r[10],e[11]=r[14],e[12]=r[3],e[13]=r[7],e[14]=r[11],e[15]=r[15];return e}function cf(e,r){var t=r[0],n=r[1],o=r[2],i=r[3],c=r[4],a=r[5],s=r[6],f=r[7],u=r[8],p=r[9],m=r[10],y=r[11],h=r[12],l=r[13],x=r[14],b=r[15],T=t*a-n*c,E=t*s-o*c,v=t*f-i*c,_=n*s-o*a,A=n*f-i*a,d=o*f-i*s,g=u*l-p*h,S=u*x-m*h,F=u*b-y*h,I=p*x-m*l,R=p*b-y*l,N=m*b-y*x,P=T*N-E*R+v*I+_*F-A*S+d*g;return P?(P=1/P,e[0]=(a*N-s*R+f*I)*P,e[1]=(o*R-n*N-i*I)*P,e[2]=(l*d-x*A+b*_)*P,e[3]=(m*A-p*d-y*_)*P,e[4]=(s*F-c*N-f*S)*P,e[5]=(t*N-o*F+i*S)*P,e[6]=(x*v-h*d-b*E)*P,e[7]=(u*d-m*v+y*E)*P,e[8]=(c*R-a*F+f*g)*P,e[9]=(n*F-t*R-i*g)*P,e[10]=(h*A-l*v+b*T)*P,e[11]=(p*v-u*A-y*T)*P,e[12]=(a*S-c*I-s*g)*P,e[13]=(t*I-n*S+o*g)*P,e[14]=(l*E-h*_-x*T)*P,e[15]=(u*_-p*E+m*T)*P,e):null}function af(e,r){var t=r[0],n=r[1],o=r[2],i=r[3],c=r[4],a=r[5],s=r[6],f=r[7],u=r[8],p=r[9],m=r[10],y=r[11],h=r[12],l=r[13],x=r[14],b=r[15];return e[0]=a*(m*b-y*x)-p*(s*b-f*x)+l*(s*y-f*m),e[1]=-(n*(m*b-y*x)-p*(o*b-i*x)+l*(o*y-i*m)),e[2]=n*(s*b-f*x)-a*(o*b-i*x)+l*(o*f-i*s),e[3]=-(n*(s*y-f*m)-a*(o*y-i*m)+p*(o*f-i*s)),e[4]=-(c*(m*b-y*x)-u*(s*b-f*x)+h*(s*y-f*m)),e[5]=t*(m*b-y*x)-u*(o*b-i*x)+h*(o*y-i*m),e[6]=-(t*(s*b-f*x)-c*(o*b-i*x)+h*(o*f-i*s)),e[7]=t*(s*y-f*m)-c*(o*y-i*m)+u*(o*f-i*s),e[8]=c*(p*b-y*l)-u*(a*b-f*l)+h*(a*y-f*p),e[9]=-(t*(p*b-y*l)-u*(n*b-i*l)+h*(n*y-i*p)),e[10]=t*(a*b-f*l)-c*(n*b-i*l)+h*(n*f-i*a),e[11]=-(t*(a*y-f*p)-c*(n*y-i*p)+u*(n*f-i*a)),e[12]=-(c*(p*x-m*l)-u*(a*x-s*l)+h*(a*m-s*p)),e[13]=t*(p*x-m*l)-u*(n*x-o*l)+h*(n*m-o*p),e[14]=-(t*(a*x-s*l)-c*(n*x-o*l)+h*(n*s-o*a)),e[15]=t*(a*m-s*p)-c*(n*m-o*p)+u*(n*s-o*a),e}function sf(e){var r=e[0],t=e[1],n=e[2],o=e[3],i=e[4],c=e[5],a=e[6],s=e[7],f=e[8],u=e[9],p=e[10],m=e[11],y=e[12],h=e[13],l=e[14],x=e[15],b=r*c-t*i,T=r*a-n*i,E=r*s-o*i,v=t*a-n*c,_=t*s-o*c,A=n*s-o*a,d=f*h-u*y,g=f*l-p*y,S=f*x-m*y,F=u*l-p*h,I=u*x-m*h,R=p*x-m*l;return b*R-T*I+E*F+v*S-_*g+A*d}function Qn(e,r,t){var n=r[0],o=r[1],i=r[2],c=r[3],a=r[4],s=r[5],f=r[6],u=r[7],p=r[8],m=r[9],y=r[10],h=r[11],l=r[12],x=r[13],b=r[14],T=r[15],E=t[0],v=t[1],_=t[2],A=t[3];return e[0]=E*n+v*a+_*p+A*l,e[1]=E*o+v*s+_*m+A*x,e[2]=E*i+v*f+_*y+A*b,e[3]=E*c+v*u+_*h+A*T,E=t[4],v=t[5],_=t[6],A=t[7],e[4]=E*n+v*a+_*p+A*l,e[5]=E*o+v*s+_*m+A*x,e[6]=E*i+v*f+_*y+A*b,e[7]=E*c+v*u+_*h+A*T,E=t[8],v=t[9],_=t[10],A=t[11],e[8]=E*n+v*a+_*p+A*l,e[9]=E*o+v*s+_*m+A*x,e[10]=E*i+v*f+_*y+A*b,e[11]=E*c+v*u+_*h+A*T,E=t[12],v=t[13],_=t[14],A=t[15],e[12]=E*n+v*a+_*p+A*l,e[13]=E*o+v*s+_*m+A*x,e[14]=E*i+v*f+_*y+A*b,e[15]=E*c+v*u+_*h+A*T,e}function ff(e,r,t){var n=t[0],o=t[1],i=t[2],c,a,s,f,u,p,m,y,h,l,x,b;return r===e?(e[12]=r[0]*n+r[4]*o+r[8]*i+r[12],e[13]=r[1]*n+r[5]*o+r[9]*i+r[13],e[14]=r[2]*n+r[6]*o+r[10]*i+r[14],e[15]=r[3]*n+r[7]*o+r[11]*i+r[15]):(c=r[0],a=r[1],s=r[2],f=r[3],u=r[4],p=r[5],m=r[6],y=r[7],h=r[8],l=r[9],x=r[10],b=r[11],e[0]=c,e[1]=a,e[2]=s,e[3]=f,e[4]=u,e[5]=p,e[6]=m,e[7]=y,e[8]=h,e[9]=l,e[10]=x,e[11]=b,e[12]=c*n+u*o+h*i+r[12],e[13]=a*n+p*o+l*i+r[13],e[14]=s*n+m*o+x*i+r[14],e[15]=f*n+y*o+b*i+r[15]),e}function lf(e,r,t){var n=t[0],o=t[1],i=t[2];return e[0]=r[0]*n,e[1]=r[1]*n,e[2]=r[2]*n,e[3]=r[3]*n,e[4]=r[4]*o,e[5]=r[5]*o,e[6]=r[6]*o,e[7]=r[7]*o,e[8]=r[8]*i,e[9]=r[9]*i,e[10]=r[10]*i,e[11]=r[11]*i,e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function uf(e,r,t,n){var o=n[0],i=n[1],c=n[2],a=Math.hypot(o,i,c),s,f,u,p,m,y,h,l,x,b,T,E,v,_,A,d,g,S,F,I,R,N,P,z;return a<U?null:(a=1/a,o*=a,i*=a,c*=a,s=Math.sin(t),f=Math.cos(t),u=1-f,p=r[0],m=r[1],y=r[2],h=r[3],l=r[4],x=r[5],b=r[6],T=r[7],E=r[8],v=r[9],_=r[10],A=r[11],d=o*o*u+f,g=i*o*u+c*s,S=c*o*u-i*s,F=o*i*u-c*s,I=i*i*u+f,R=c*i*u+o*s,N=o*c*u+i*s,P=i*c*u-o*s,z=c*c*u+f,e[0]=p*d+l*g+E*S,e[1]=m*d+x*g+v*S,e[2]=y*d+b*g+_*S,e[3]=h*d+T*g+A*S,e[4]=p*F+l*I+E*R,e[5]=m*F+x*I+v*R,e[6]=y*F+b*I+_*R,e[7]=h*F+T*I+A*R,e[8]=p*N+l*P+E*z,e[9]=m*N+x*P+v*z,e[10]=y*N+b*P+_*z,e[11]=h*N+T*P+A*z,r!==e&&(e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e)}function mf(e,r,t){var n=Math.sin(t),o=Math.cos(t),i=r[4],c=r[5],a=r[6],s=r[7],f=r[8],u=r[9],p=r[10],m=r[11];return r!==e&&(e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[4]=i*o+f*n,e[5]=c*o+u*n,e[6]=a*o+p*n,e[7]=s*o+m*n,e[8]=f*o-i*n,e[9]=u*o-c*n,e[10]=p*o-a*n,e[11]=m*o-s*n,e}function xf(e,r,t){var n=Math.sin(t),o=Math.cos(t),i=r[0],c=r[1],a=r[2],s=r[3],f=r[8],u=r[9],p=r[10],m=r[11];return r!==e&&(e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[0]=i*o-f*n,e[1]=c*o-u*n,e[2]=a*o-p*n,e[3]=s*o-m*n,e[8]=i*n+f*o,e[9]=c*n+u*o,e[10]=a*n+p*o,e[11]=s*n+m*o,e}function hf(e,r,t){var n=Math.sin(t),o=Math.cos(t),i=r[0],c=r[1],a=r[2],s=r[3],f=r[4],u=r[5],p=r[6],m=r[7];return r!==e&&(e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[0]=i*o+f*n,e[1]=c*o+u*n,e[2]=a*o+p*n,e[3]=s*o+m*n,e[4]=f*o-i*n,e[5]=u*o-c*n,e[6]=p*o-a*n,e[7]=m*o-s*n,e}function pf(e,r){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function yf(e,r){return e[0]=r[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=r[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function bf(e,r,t){var n=t[0],o=t[1],i=t[2],c=Math.hypot(n,o,i),a,s,f;return c<U?null:(c=1/c,n*=c,o*=c,i*=c,a=Math.sin(r),s=Math.cos(r),f=1-s,e[0]=n*n*f+s,e[1]=o*n*f+i*a,e[2]=i*n*f-o*a,e[3]=0,e[4]=n*o*f-i*a,e[5]=o*o*f+s,e[6]=i*o*f+n*a,e[7]=0,e[8]=n*i*f+o*a,e[9]=o*i*f-n*a,e[10]=i*i*f+s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function Ef(e,r){var t=Math.sin(r),n=Math.cos(r);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=t,e[7]=0,e[8]=0,e[9]=-t,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function _f(e,r){var t=Math.sin(r),n=Math.cos(r);return e[0]=n,e[1]=0,e[2]=-t,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=t,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Tf(e,r){var t=Math.sin(r),n=Math.cos(r);return e[0]=n,e[1]=t,e[2]=0,e[3]=0,e[4]=-t,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Jn(e,r,t){var n=r[0],o=r[1],i=r[2],c=r[3],a=n+n,s=o+o,f=i+i,u=n*a,p=n*s,m=n*f,y=o*s,h=o*f,l=i*f,x=c*a,b=c*s,T=c*f;return e[0]=1-(y+l),e[1]=p+T,e[2]=m-b,e[3]=0,e[4]=p-T,e[5]=1-(u+l),e[6]=h+x,e[7]=0,e[8]=m+b,e[9]=h-x,e[10]=1-(u+y),e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function vf(e,r){var t=new pe(3),n=-r[0],o=-r[1],i=-r[2],c=r[3],a=r[4],s=r[5],f=r[6],u=r[7],p=n*n+o*o+i*i+c*c;return p>0?(t[0]=(a*c+u*n+s*i-f*o)*2/p,t[1]=(s*c+u*o+f*n-a*i)*2/p,t[2]=(f*c+u*i+a*o-s*n)*2/p):(t[0]=(a*c+u*n+s*i-f*o)*2,t[1]=(s*c+u*o+f*n-a*i)*2,t[2]=(f*c+u*i+a*o-s*n)*2),Jn(e,r,t),e}function Af(e,r){return e[0]=r[12],e[1]=r[13],e[2]=r[14],e}function eo(e,r){var t=r[0],n=r[1],o=r[2],i=r[4],c=r[5],a=r[6],s=r[8],f=r[9],u=r[10];return e[0]=Math.hypot(t,n,o),e[1]=Math.hypot(i,c,a),e[2]=Math.hypot(s,f,u),e}function gf(e,r){var t=new pe(3);eo(t,r);var n=1/t[0],o=1/t[1],i=1/t[2],c=r[0]*n,a=r[1]*o,s=r[2]*i,f=r[4]*n,u=r[5]*o,p=r[6]*i,m=r[8]*n,y=r[9]*o,h=r[10]*i,l=c+u+h,x=0;return l>0?(x=Math.sqrt(l+1)*2,e[3]=.25*x,e[0]=(p-y)/x,e[1]=(m-s)/x,e[2]=(a-f)/x):c>u&&c>h?(x=Math.sqrt(1+c-u-h)*2,e[3]=(p-y)/x,e[0]=.25*x,e[1]=(a+f)/x,e[2]=(m+s)/x):u>h?(x=Math.sqrt(1+u-c-h)*2,e[3]=(m-s)/x,e[0]=(a+f)/x,e[1]=.25*x,e[2]=(p+y)/x):(x=Math.sqrt(1+h-c-u)*2,e[3]=(a-f)/x,e[0]=(m+s)/x,e[1]=(p+y)/x,e[2]=.25*x),e}function df(e,r,t,n){var o=r[0],i=r[1],c=r[2],a=r[3],s=o+o,f=i+i,u=c+c,p=o*s,m=o*f,y=o*u,h=i*f,l=i*u,x=c*u,b=a*s,T=a*f,E=a*u,v=n[0],_=n[1],A=n[2];return e[0]=(1-(h+x))*v,e[1]=(m+E)*v,e[2]=(y-T)*v,e[3]=0,e[4]=(m-E)*_,e[5]=(1-(p+x))*_,e[6]=(l+b)*_,e[7]=0,e[8]=(y+T)*A,e[9]=(l-b)*A,e[10]=(1-(p+h))*A,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Sf(e,r,t,n,o){var i=r[0],c=r[1],a=r[2],s=r[3],f=i+i,u=c+c,p=a+a,m=i*f,y=i*u,h=i*p,l=c*u,x=c*p,b=a*p,T=s*f,E=s*u,v=s*p,_=n[0],A=n[1],d=n[2],g=o[0],S=o[1],F=o[2],I=(1-(l+b))*_,R=(y+v)*_,N=(h-E)*_,P=(y-v)*A,z=(1-(m+b))*A,$=(x+T)*A,H=(h+E)*d,K=(x-T)*d,Z=(1-(m+l))*d;return e[0]=I,e[1]=R,e[2]=N,e[3]=0,e[4]=P,e[5]=z,e[6]=$,e[7]=0,e[8]=H,e[9]=K,e[10]=Z,e[11]=0,e[12]=t[0]+g-(I*g+P*S+H*F),e[13]=t[1]+S-(R*g+z*S+K*F),e[14]=t[2]+F-(N*g+$*S+Z*F),e[15]=1,e}function wf(e,r){var t=r[0],n=r[1],o=r[2],i=r[3],c=t+t,a=n+n,s=o+o,f=t*c,u=n*c,p=n*a,m=o*c,y=o*a,h=o*s,l=i*c,x=i*a,b=i*s;return e[0]=1-p-h,e[1]=u+b,e[2]=m-x,e[3]=0,e[4]=u-b,e[5]=1-f-h,e[6]=y+l,e[7]=0,e[8]=m+x,e[9]=y-l,e[10]=1-f-p,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ff(e,r,t,n,o,i,c){var a=1/(t-r),s=1/(o-n),f=1/(i-c);return e[0]=i*2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i*2*s,e[6]=0,e[7]=0,e[8]=(t+r)*a,e[9]=(o+n)*s,e[10]=(c+i)*f,e[11]=-1,e[12]=0,e[13]=0,e[14]=c*i*2*f,e[15]=0,e}function ro(e,r,t,n,o){var i=1/Math.tan(r/2),c;return e[0]=i/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,o!=null&&o!==1/0?(c=1/(n-o),e[10]=(o+n)*c,e[14]=2*o*n*c):(e[10]=-1,e[14]=-2*n),e}var Pf=ro;function If(e,r,t,n,o){var i=1/Math.tan(r/2),c;return e[0]=i/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,o!=null&&o!==1/0?(c=1/(n-o),e[10]=o*c,e[14]=o*n*c):(e[10]=-1,e[14]=-n),e}function Mf(e,r,t,n){var o=Math.tan(r.upDegrees*Math.PI/180),i=Math.tan(r.downDegrees*Math.PI/180),c=Math.tan(r.leftDegrees*Math.PI/180),a=Math.tan(r.rightDegrees*Math.PI/180),s=2/(c+a),f=2/(o+i);return e[0]=s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=f,e[6]=0,e[7]=0,e[8]=-((c-a)*s*.5),e[9]=(o-i)*f*.5,e[10]=n/(t-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*t/(t-n),e[15]=0,e}function to(e,r,t,n,o,i,c){var a=1/(r-t),s=1/(n-o),f=1/(i-c);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*f,e[11]=0,e[12]=(r+t)*a,e[13]=(o+n)*s,e[14]=(c+i)*f,e[15]=1,e}var Rf=to;function Nf(e,r,t,n,o,i,c){var a=1/(r-t),s=1/(n-o),f=1/(i-c);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=f,e[11]=0,e[12]=(r+t)*a,e[13]=(o+n)*s,e[14]=i*f,e[15]=1,e}function Cf(e,r,t,n){var o,i,c,a,s,f,u,p,m,y,h=r[0],l=r[1],x=r[2],b=n[0],T=n[1],E=n[2],v=t[0],_=t[1],A=t[2];return Math.abs(h-v)<U&&Math.abs(l-_)<U&&Math.abs(x-A)<U?qn(e):(u=h-v,p=l-_,m=x-A,y=1/Math.hypot(u,p,m),u*=y,p*=y,m*=y,o=T*m-E*p,i=E*u-b*m,c=b*p-T*u,y=Math.hypot(o,i,c),y?(y=1/y,o*=y,i*=y,c*=y):(o=0,i=0,c=0),a=p*c-m*i,s=m*o-u*c,f=u*i-p*o,y=Math.hypot(a,s,f),y?(y=1/y,a*=y,s*=y,f*=y):(a=0,s=0,f=0),e[0]=o,e[1]=a,e[2]=u,e[3]=0,e[4]=i,e[5]=s,e[6]=p,e[7]=0,e[8]=c,e[9]=f,e[10]=m,e[11]=0,e[12]=-(o*h+i*l+c*x),e[13]=-(a*h+s*l+f*x),e[14]=-(u*h+p*l+m*x),e[15]=1,e)}function Bf(e,r,t,n){var o=r[0],i=r[1],c=r[2],a=n[0],s=n[1],f=n[2],u=o-t[0],p=i-t[1],m=c-t[2],y=u*u+p*p+m*m;y>0&&(y=1/Math.sqrt(y),u*=y,p*=y,m*=y);var h=s*m-f*p,l=f*u-a*m,x=a*p-s*u;return y=h*h+l*l+x*x,y>0&&(y=1/Math.sqrt(y),h*=y,l*=y,x*=y),e[0]=h,e[1]=l,e[2]=x,e[3]=0,e[4]=p*x-m*l,e[5]=m*h-u*x,e[6]=u*l-p*h,e[7]=0,e[8]=u,e[9]=p,e[10]=m,e[11]=0,e[12]=o,e[13]=i,e[14]=c,e[15]=1,e}function Lf(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function Uf(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function Df(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e[3]=r[3]+t[3],e[4]=r[4]+t[4],e[5]=r[5]+t[5],e[6]=r[6]+t[6],e[7]=r[7]+t[7],e[8]=r[8]+t[8],e[9]=r[9]+t[9],e[10]=r[10]+t[10],e[11]=r[11]+t[11],e[12]=r[12]+t[12],e[13]=r[13]+t[13],e[14]=r[14]+t[14],e[15]=r[15]+t[15],e}function no(e,r,t){return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e[2]=r[2]-t[2],e[3]=r[3]-t[3],e[4]=r[4]-t[4],e[5]=r[5]-t[5],e[6]=r[6]-t[6],e[7]=r[7]-t[7],e[8]=r[8]-t[8],e[9]=r[9]-t[9],e[10]=r[10]-t[10],e[11]=r[11]-t[11],e[12]=r[12]-t[12],e[13]=r[13]-t[13],e[14]=r[14]-t[14],e[15]=r[15]-t[15],e}function zf(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e[3]=r[3]*t,e[4]=r[4]*t,e[5]=r[5]*t,e[6]=r[6]*t,e[7]=r[7]*t,e[8]=r[8]*t,e[9]=r[9]*t,e[10]=r[10]*t,e[11]=r[11]*t,e[12]=r[12]*t,e[13]=r[13]*t,e[14]=r[14]*t,e[15]=r[15]*t,e}function Of(e,r,t,n){return e[0]=r[0]+t[0]*n,e[1]=r[1]+t[1]*n,e[2]=r[2]+t[2]*n,e[3]=r[3]+t[3]*n,e[4]=r[4]+t[4]*n,e[5]=r[5]+t[5]*n,e[6]=r[6]+t[6]*n,e[7]=r[7]+t[7]*n,e[8]=r[8]+t[8]*n,e[9]=r[9]+t[9]*n,e[10]=r[10]+t[10]*n,e[11]=r[11]+t[11]*n,e[12]=r[12]+t[12]*n,e[13]=r[13]+t[13]*n,e[14]=r[14]+t[14]*n,e[15]=r[15]+t[15]*n,e}function Gf(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]&&e[4]===r[4]&&e[5]===r[5]&&e[6]===r[6]&&e[7]===r[7]&&e[8]===r[8]&&e[9]===r[9]&&e[10]===r[10]&&e[11]===r[11]&&e[12]===r[12]&&e[13]===r[13]&&e[14]===r[14]&&e[15]===r[15]}function Vf(e,r){var t=e[0],n=e[1],o=e[2],i=e[3],c=e[4],a=e[5],s=e[6],f=e[7],u=e[8],p=e[9],m=e[10],y=e[11],h=e[12],l=e[13],x=e[14],b=e[15],T=r[0],E=r[1],v=r[2],_=r[3],A=r[4],d=r[5],g=r[6],S=r[7],F=r[8],I=r[9],R=r[10],N=r[11],P=r[12],z=r[13],$=r[14],H=r[15];return Math.abs(t-T)<=U*Math.max(1,Math.abs(t),Math.abs(T))&&Math.abs(n-E)<=U*Math.max(1,Math.abs(n),Math.abs(E))&&Math.abs(o-v)<=U*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(i-_)<=U*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(c-A)<=U*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(a-d)<=U*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(s-g)<=U*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(f-S)<=U*Math.max(1,Math.abs(f),Math.abs(S))&&Math.abs(u-F)<=U*Math.max(1,Math.abs(u),Math.abs(F))&&Math.abs(p-I)<=U*Math.max(1,Math.abs(p),Math.abs(I))&&Math.abs(m-R)<=U*Math.max(1,Math.abs(m),Math.abs(R))&&Math.abs(y-N)<=U*Math.max(1,Math.abs(y),Math.abs(N))&&Math.abs(h-P)<=U*Math.max(1,Math.abs(h),Math.abs(P))&&Math.abs(l-z)<=U*Math.max(1,Math.abs(l),Math.abs(z))&&Math.abs(x-$)<=U*Math.max(1,Math.abs(x),Math.abs($))&&Math.abs(b-H)<=U*Math.max(1,Math.abs(b),Math.abs(H))}var kf=Qn,$f=no;var bt=de(_e(),1),De;function ye(e=!0,r="canvas"){return De||(bt.default.info(`\u{1F58C}\uFE0F Creating WebGL2 context in ${r}`),De=document.querySelector(r).getContext("webgl2",{antialias:e})??void 0,De||bt.default.error("\u{1F4A5} Unable to create WebGL2 context!"),De)}var oo=de(_e(),1),br=class{constructor(){this.cache=new Map}get(r){if(!this.cache.has(r))throw new Error(`Model ${r} not found in cache`);return this.cache.get(r)}add(r){oo.default.debug(`\u{1F9F0} Adding model '${r.name}' to cache`),this.cache.set(r.name,r)}};var io="u_light",Er=class{constructor(){this.position=[0,0,0],this.colour=[1,1,1],this.intensity=1}apply(r){q(r,this.Uniforms)}get Uniforms(){return{[`${io}Position`]:[...this.position,1],[`${io}Colour`]:[...this.colour,1]}}};var co=(t=>(t[t.PERSPECTIVE=1]="PERSPECTIVE",t[t.ORTHOGRAPHIC=2]="ORTHOGRAPHIC",t))(co||{}),_r=class{constructor(r=1){this.position=[0,0,30],this.lookAt=[0,0,0],this.up=[0,1,0],this.near=.1,this.far=100,this.fov=45,this.type=r,this.orthoZoom=20}get matrix(){return C.targetTo(C.create(),this.position,this.lookAt,this.up)}projectionMatrix(r){return this.type===2?C.ortho(C.create(),-r*this.orthoZoom,r*this.orthoZoom,-this.orthoZoom,this.orthoZoom,this.near,this.far):C.perspective(C.create(),this.fov*(Math.PI/180),r,this.near,this.far)}};var be=class{constructor(r){this.renderable=r}rotateX(r){this.rotate||(this.rotate=[0,0,0]),this.rotate[0]+=r}rotateY(r){this.rotate||(this.rotate=[0,0,0]),this.rotate[1]+=r}rotateZ(r){this.rotate||(this.rotate=[0,0,0]),this.rotate[2]+=r}render(r,t,n,o){if(!this.renderable||!r)return;let i=C.create();this.scale&&C.scale(i,i,this.scale),this.position&&C.translate(i,i,this.position),this.rotate&&(C.rotateX(i,i,this.rotate[0]),C.rotateY(i,i,this.rotate[1]),C.rotateZ(i,i,this.rotate[2])),t.u&&(t.u_world=i),C.invert(t.u_worldInverseTranspose,i),C.transpose(t.u_worldInverseTranspose,t.u_worldInverseTranspose),C.multiply(t.u_worldViewProjection,n,i),this.renderable.render(r,t,o)}};var ze=class{constructor(){this.material=new Ee}render(r,t,n){this.bufferInfo&&(this.material.apply(n),hr(r,n,this.bufferInfo),q(n,t),pr(r,this.bufferInfo))}},Tr=class extends ze{constructor(r,t,n,o){super(),this.bufferInfo=or.createSphereBufferInfo(r,t,n,o)}},vr=class extends ze{constructor(r,t){super(),this.bufferInfo=or.createCubeBufferInfo(r,t)}},Ar=class extends ze{constructor(r,t,n,o,i){super(),this.bufferInfo=or.createPlaneBufferInfo(r,t,n,o,i)}};var ao=`#version 300 es

// ============================================================================
// Phong vertex shader
// Ben Coleman, 2023
// ============================================================================

precision highp float;

// From vertex shader
in vec3 v_normal;
in vec2 v_texCoord;
in vec4 v_position;

uniform mat4 u_world;
uniform mat4 u_camMatrix;

// Material properties
uniform vec4 u_matAmbient;
uniform vec4 u_matDiffuse;
uniform vec4 u_matSpecular;
uniform float u_matShininess;
uniform sampler2D u_matTexture;

// Light properties
uniform vec4 u_lightPosition;
uniform vec4 u_lightColour;
uniform vec4 u_ambientLight;

// Output colour of this pixel/fragment
out vec4 outColour;

// lightCalc function returns two floats (packed into a vec2)
// One for diffuse component of lighting, the second for specular
// - normalN:          Surface normal (normalized)
// - surfaceToLightN:  Vector towards light (normalized)
// - halfVector:       Half vector towards camera (normalized)
// - shininess:        Hardness or size of specular highlights
vec2 lightCalc(vec3 normalN, vec3 surfaceToLightN, vec3 halfVector, float shininess) {
  float NdotL = dot(normalN, surfaceToLightN);
  float NdotH = dot(normalN, halfVector);

  return vec2(
    NdotL,
    NdotL > 0.0
      ? pow(max(0.0, NdotH), shininess)
      : 0.0 // Specular term in y
  );
}

void main(void ) {
  vec3 surfaceToLight = u_lightPosition.xyz - v_position.xyz;
  vec3 surfaceToView = (u_camMatrix[3] - u_world * v_position).xyz;
  vec3 normalN = normalize(v_normal);
  vec3 surfaceToLightN = normalize(surfaceToLight);
  vec3 surfaceToViewN = normalize(surfaceToView);
  vec3 halfVector = normalize(surfaceToLightN + surfaceToViewN);

  vec2 l = lightCalc(normalN, surfaceToLightN, halfVector, u_matShininess);

  vec4 diffuseColour = texture(u_matTexture, v_texCoord) * u_matDiffuse;

  outColour =
    u_ambientLight * diffuseColour * u_matAmbient +
    diffuseColour * max(l.x, 0.0) * u_lightColour +
    u_matSpecular * l.y * u_lightColour;
}
`;var so=`#version 300 es

// ============================================================================
// Phong vertex shader
// Ben Coleman, 2023
// ============================================================================

precision highp float;

// Input attributes from buffers
in vec4 position;
in vec3 normal;
in vec2 texcoord;

uniform mat4 u_worldViewProjection;
uniform mat4 u_worldInverseTranspose;
uniform mat4 u_world;

// Output varying's to pass to fragment shader
out vec2 v_texCoord;
out vec3 v_normal;
out vec4 v_position;

void main() {
  v_texCoord = texcoord;
  v_normal = (u_worldInverseTranspose * vec4(normal, 0)).xyz;
  v_position = u_world * position;

  gl_Position = u_worldViewProjection * position;
}
`;var fo=`#version 300 es

// ============================================================================
// Gouraud fragment shader
// Ben Coleman, 2023
// ============================================================================

precision highp float;

// From vertex shader
in vec4 v_lightingDiffuse;
in vec4 v_lightingSpecular;
in vec2 v_texCoord;

uniform sampler2D u_matTexture;
uniform vec4 u_matDiffuse;

// Output colour of this pixel/fragment
out vec4 outColour;

void main() {
  // Tried to set the objectColour in the vertex shader, rather than here.
  // But texture mapping + Gouraud shading, it looks terrible
  vec4 objectColour = texture(u_matTexture, v_texCoord) * u_matDiffuse;

  outColour = objectColour * v_lightingDiffuse + v_lightingSpecular;
}
`;var lo=`#version 300 es

// ============================================================================
// Gouraud vertex shader
// Ben Coleman, 2023
// ============================================================================

precision highp float;

// Input attributes from buffers
in vec4 position;
in vec3 normal;
in vec2 texcoord;

uniform mat4 u_world;
uniform mat4 u_camMatrix;
uniform mat4 u_worldViewProjection;
uniform mat4 u_worldInverseTranspose;

// Material properties
uniform vec4 u_matAmbient;
uniform vec4 u_matSpecular;
uniform float u_matShininess;

// Light properties
uniform vec4 u_lightPosition;
uniform vec4 u_lightColour;
uniform vec4 u_ambientLight;

out vec4 v_lightingDiffuse;
out vec4 v_lightingSpecular;
out vec2 v_texCoord;

// lightCalc function returns two floats (packed into a vec2)
// One for diffuse component of lighting, the second for specular
// - normalN:          Surface normal (normalized)
// - surfaceToLightN:  Vector towards light (normalized)
// - halfVector:       Half vector towards camera (normalized)
// - shininess:        Hardness or size of specular highlights
vec2 lightCalc(vec3 normalN, vec3 surfaceToLightN, vec3 halfVector, float shininess) {
  float NdotL = dot(normalN, surfaceToLightN);
  float NdotH = dot(normalN, halfVector);

  return vec2(
    NdotL,
    NdotL > 0.0
      ? pow(max(0.0, NdotH), shininess)
      : 0.0 // Specular term in y
  );
}

void main(void ) {
  vec3 worldNormal = (u_worldInverseTranspose * vec4(normal, 0)).xyz;
  vec4 worldPos = u_world * position;

  vec3 surfaceToLight = u_lightPosition.xyz - worldPos.xyz;
  vec3 surfaceToView = (u_camMatrix[3] - u_world * worldPos).xyz;
  vec3 normalN = normalize(worldNormal);
  vec3 surfaceToLightN = normalize(surfaceToLight);
  vec3 surfaceToViewN = normalize(surfaceToView);
  vec3 halfVector = normalize(surfaceToLightN + surfaceToViewN);

  vec2 light = lightCalc(normalN, surfaceToLightN, halfVector, u_matShininess);

  // Output lighting value for fragment shader to use, no color
  v_lightingDiffuse = u_ambientLight * u_matAmbient + u_lightColour * max(light.x, 0.0);

  // Pass specular in a seperate varying
  v_lightingSpecular = u_lightColour * u_matSpecular * light.y;

  // Pass through varying texture coordinate, so we can get the colour there
  v_texCoord = texcoord;

  gl_Position = u_worldViewProjection * position;
}
`;var uo=`#version 300 es

// ============================================================================
// Gouraud fragment shader with flat shading
// Ben Coleman, 2023
// ============================================================================

precision highp float;

// From vertex shader
flat in vec4 v_lightingDiffuse;
flat in vec4 v_lightingSpecular;
in vec2 v_texCoord;

uniform sampler2D u_matTexture;
uniform vec4 u_matDiffuse;

// Output colour of this pixel/fragment
out vec4 outColour;

void main() {
  // Tried to set the objectColour in the vertex shader, rather than here.
  // But texture mapping + Gouraud shading, it looks terrible
  vec4 objectColour = texture(u_matTexture, v_texCoord) * u_matDiffuse;

  outColour = objectColour * v_lightingDiffuse + v_lightingSpecular;
}
`;var mo=`#version 300 es

// ============================================================================
// Gouraud vertex shader
// Ben Coleman, 2023
// ============================================================================

precision highp float;

// Input attributes from buffers
in vec4 position;
in vec3 normal;
in vec2 texcoord;

uniform mat4 u_world;
uniform mat4 u_camMatrix;
uniform mat4 u_worldViewProjection;
uniform mat4 u_worldInverseTranspose;

// Material properties
uniform vec4 u_matAmbient;
uniform vec4 u_matSpecular;
uniform float u_matShininess;

// Light properties
uniform vec4 u_lightPosition;
uniform vec4 u_lightColour;
uniform vec4 u_ambientLight;

flat out vec4 v_lightingDiffuse;
flat out vec4 v_lightingSpecular;
out vec2 v_texCoord;

// lightCalc function returns two floats (packed into a vec2)
// One for diffuse component of lighting, the second for specular
// - normalN:          Surface normal (normalized)
// - surfaceToLightN:  Vector towards light (normalized)
// - halfVector:       Half vector towards camera (normalized)
// - shininess:        Hardness or size of specular highlights
vec2 lightCalc(vec3 normalN, vec3 surfaceToLightN, vec3 halfVector, float shininess) {
  float NdotL = dot(normalN, surfaceToLightN);
  float NdotH = dot(normalN, halfVector);

  return vec2(
    NdotL,
    NdotL > 0.0
      ? pow(max(0.0, NdotH), shininess)
      : 0.0 // Specular term in y
  );
}

void main(void ) {
  vec3 worldNormal = (u_worldInverseTranspose * vec4(normal, 0)).xyz;
  vec4 worldPos = u_world * position;

  vec3 surfaceToLight = u_lightPosition.xyz - worldPos.xyz;
  vec3 surfaceToView = (u_camMatrix[3] - u_world * worldPos).xyz;
  vec3 normalN = normalize(worldNormal);
  vec3 surfaceToLightN = normalize(surfaceToLight);
  vec3 surfaceToViewN = normalize(surfaceToView);
  vec3 halfVector = normalize(surfaceToLightN + surfaceToViewN);

  vec2 light = lightCalc(normalN, surfaceToLightN, halfVector, u_matShininess);

  // Output lighting value for fragment shader to use, no color
  v_lightingDiffuse = u_ambientLight * u_matAmbient + u_lightColour * max(light.x, 0.0);

  // Pass specular in a seperate varying
  v_lightingSpecular = u_lightColour * u_matSpecular * light.y;

  // Pass through varying texture coordinate, so we can get the colour there
  v_texCoord = texcoord;

  gl_Position = u_worldViewProjection * position;
}
`;var Zf=(n=>(n.PHONG="phong",n.GOURAUD="gouraud",n.GOURAUD_FLAT="gouraud-flat",n))(Zf||{}),xo=class e{constructor(r){this.aspectRatio=1;this.programs={};this.started=!1;this.instances=[];this.lights=[];this.resizeable=!0;this.debug=!1;this.test=!1;this.ambientLight=[.05,.05,.05];this.shaderProgram="phong";this.gl=r,this.models=new br,this.prevTime=0,this.totalTime=0;let t=new Er;t.position=[0,40,50],t.colour=[1,1,1],this.lights[0]=t,this.camera=new _r(1),this.update=()=>{},ce.default.info("\u{1F451} GSOTS-3D context created")}static async init(r,t="#000"){let n=ye(!0,r);if(!n)throw ce.default.error("\u{1F4A5} Failed to get WebGL context"),new Error("Failed to get WebGL context");let o=new e(n),i=n.canvas;o.aspectRatio=i.clientWidth/i.clientHeight,i.style.backgroundColor=t;try{let c=Ue(n,[so,ao]);o.programs.phong=c;let a=Ue(n,[lo,fo]);o.programs.gouraud=a;let s=Ue(n,[mo,uo]);o.programs["gouraud-flat"]=s,ce.default.info("\u{1F3A8} Loaded all shaders & programs, GL is ready")}catch(c){throw ce.default.error(c),c}return n.enable(n.DEPTH_TEST),n.enable(n.CULL_FACE),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA),o.render=o.render.bind(o),o}async render(r){if(!this.gl)return;r*=.001;let t=r-this.prevTime;this.prevTime=r,this.totalTime+=t,this.update(t);let n={u_worldInverseTranspose:C.create(),u_worldViewProjection:C.create(),u_ambientLight:[...this.ambientLight,1]},o=this.programs[this.shaderProgram];this.resizeable&&(Zn(this.gl.canvas),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.aspectRatio=this.gl.canvas.width/this.gl.canvas.height);let i=this.camera.matrix,c=C.invert(C.create(),i);n.u_camMatrix=i;let a=this.camera.projectionMatrix(this.aspectRatio),s=C.multiply(C.create(),a,c);this.gl.useProgram(o.program),this.lights[0].apply(o);for(let f of this.instances)f.render(this.gl,n,s,o);this.started&&requestAnimationFrame(this.render)}get defaultLight(){return this.lights[0]}start(){this.started=!0,requestAnimationFrame(this.render)}stop(){this.started=!1}createModelInstance(r){let t=this.models.get(r);if(!t)throw new Error(`\u{1F4A5} Model ${r} not found`);let n=new be(t);return this.instances.push(n),n}createSphereInstance(r,t=5,n=16,o=8){let i=new Tr(this.gl,t,n,o);i.material=r;let c=new be(i);return this.instances.push(c),ce.default.debug(`\u{1F7E2} Created sphere instance, r:${t}`),c}createPlaneInstance(r,t=5,n=5,o=1,i=1){let c=new Ar(this.gl,t,n,o,i);c.material=r;let a=new be(c);return this.instances.push(a),ce.default.debug(`\u{1F7E8} Created plane instance, w:${t} h:${n}`),a}createCubeInstance(r,t=5){let n=new vr(this.gl,t);n.material=r;let o=new be(n);return this.instances.push(o),ce.default.debug(`\u{1F4E6} Created cube instance, size:${t}`),o}};var Oe="u_mat",Ee=class e{constructor(){this.diffuse=[1,1,1],this.specular=void 0,this.shininess=void 0,this.ambient=void 0,this.emissive=void 0;let r=ye();r&&(this.texture=lt(r,{min:r.NEAREST,mag:r.NEAREST,src:[255,255,255,255]}))}static fromMtl(r){let t=new e;return t.diffuse=r.kd,t.specular=r.ks,t.shininess=r.ns,t.ambient=r.ka,t.emissive=r.ke,t}static createDiffuse(r,t,n){let o=new e;return o.diffuse=[r,t,n],o}static createTexture(r,t=!0){let n=new e,o=ye();return o&&(o.LINEAR_MIPMAP_LINEAR,n.texture=lt(o,{min:t?o.LINEAR_MIPMAP_LINEAR:o.NEAREST,mag:t?o.LINEAR:o.NEAREST,src:r})),n}static get RED(){return e.createDiffuse(1,0,0)}static get GREEN(){return e.createDiffuse(0,1,0)}static get BLUE(){return e.createDiffuse(0,0,1)}apply(r){q(r,this.Uniforms)}get Uniforms(){return{[`${Oe}Texture`]:this.texture?this.texture:null,[`${Oe}Shininess`]:this.shininess?this.shininess:0,[`${Oe}Diffuse`]:this.diffuse?[...this.diffuse,1]:[1,1,1,1],[`${Oe}Specular`]:this.specular?[...this.specular,1]:[0,0,0,1],[`${Oe}Ambient`]:this.ambient?[...this.ambient,1]:[1,1,1,1]}}};var bo=de(_e(),1);function ho(e){let r=new Map,t={},n={newmtl(c,a){t={},r.set(a,t)},Ns(c){t.ns=parseFloat(c[0])},Ka(c){t.ka=c.map(parseFloat)},Kd(c){t.kd=c.map(parseFloat)},Ks(c){t.ks=c.map(parseFloat)},Ke(c){t.ke=c.map(parseFloat)},Ni(c){t.ni=parseFloat(c[0])},d(c){t.d=parseFloat(c[0])},illum(c){t.illum=parseInt(c[0])}},o=/(\w*)(?: )*(.*)/,i=e.split(`
`);for(let c=0;c<i.length;++c){let a=i[c].trim();if(a===""||a.startsWith("#"))continue;let s=o.exec(a);if(!s)continue;let[,f,u]=s,p=a.split(/\s+/).slice(1),m=n[f];if(!m){console.warn("unhandled keyword:",f);continue}m(p,u)}return r}var qf=/(\w*)(?: )*(.*)/;function po(e){let r=e.split(`
`),t=[[0,0,0]],n=[[0,0]],o=[[0,0,0]],i=[t,n,o],c=[[],[],[]],a=Array(),s={},f="__default",u=Array(),p={v(l){t.push(l.map(parseFloat))},vn(l){o.push(l.map(parseFloat))},vt(l){n.push(l.map(parseFloat))},f(l){h();let x=l.length-2;for(let b=0;b<x;++b)m(l[0]),m(l[b+1]),m(l[b+2])},usemtl(l,x){f=x,y()},mtllib(l,x){u.push(x)},s(){},o(){}};function m(l){l.split("/").forEach((b,T)=>{if(!b)return;let E=parseInt(b),v=E+(E>=0?0:i[T].length);c[T].push(...i[T][v])})}function y(){s.material&&(s={})}function h(){if(!s.material){let l=[],x=[],b=[];c=[l,x,b],s={material:f,data:{position:l,texcoord:x,normal:b}},a.push(s)}}for(let l=0;l<r.length;++l){let x=r[l].trim();if(x===""||x.startsWith("#"))continue;let b=qf.exec(x);if(!b)continue;let[,T,E]=b,v=x.split(/\s+/).slice(1),_=p[T];if(!_){console.warn("unhandled keyword:",T,"at line",l+1);continue}_(v,E)}for(let l of a)l.data.texcoord&&l.data.texcoord.length<=0&&delete l.data.texcoord;return{matLibNames:u,geometries:a}}async function Et(e){let r=await fetch(e);if(!r.ok)throw new Error(`File fetch failed: ${r.statusText}`);return await r.text()}var yo=class e{constructor(r){this.parts=[];this.materials={};this.name=r}render(r,t,n){for(let o of this.parts){let i=o.bufferInfo;this.materials[o.materialName].apply(n),hr(r,n,i),q(n,t),pr(r,i)}}static async parse(r=".",t){let n=t.split(".")[0],o=new e(n),i;try{i=await Et(`${r}/${t}`)}catch{throw new Error(`\u{1F4A5} Unable to load model ${t}`)}let c=po(i);if(!c.geometries||c.geometries.length===0)throw new Error(`\u{1F4A5} Error parsing model ${t}`);if(c.matLibNames&&c.matLibNames.length>0)try{let s=await Et(`${r}/${c.matLibNames[0]}`),f=ho(s);for(let[u,p]of f)o.materials[u]=Ee.fromMtl(p)}catch{console.warn(`Unable to load material library ${c.matLibNames[0]}`)}o.materials.__default=new Ee;let a=ye();if(!a)throw new Error("Unable to get WebGL context");for(let s of c.geometries){let f=Zr(a,s.data);o.parts.push(new _t(f,s.material))}return bo.default.debug(`\u265F\uFE0F Model '${t}' loaded with ${o.parts.length} parts, ${Object.keys(o.materials).length} materials`),o}},_t=class{constructor(r,t){this.bufferInfo=r,this.materialName=t}};var c1="0.0.1-alpha.6";export{_r as Camera,co as CameraType,xo as Context,be as Instance,Er as Light,Ee as Material,yo as Model,br as ModelCache,ze as Primitive,vr as PrimitiveCube,Ar as PrimitivePlane,Tr as PrimitiveSphere,Zf as ShaderProgram,c1 as VERSION,Jf as setLogLevel};
/*! Bundled license information:

twgl.js/dist/5.x/twgl-full.module.js:
  (* @license twgl.js 5.3.1 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
  Available via the MIT license.
  see: http://github.com/greggman/twgl.js for details *)
*/
//# sourceMappingURL=index.js.map