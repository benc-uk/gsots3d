var Ot=Object.create;var Re=Object.defineProperty;var zt=Object.getOwnPropertyDescriptor;var Gt=Object.getOwnPropertyNames;var Vt=Object.getPrototypeOf,kt=Object.prototype.hasOwnProperty;var $t=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports),Ht=(e,r)=>{for(var t in r)Re(e,t,{get:r[t],enumerable:!0})},Xt=(e,r,t,n)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of Gt(r))!kt.call(e,o)&&o!==t&&Re(e,o,{get:()=>r[o],enumerable:!(n=zt(r,o))||n.enumerable});return e};var ee=(e,r,t)=>(t=e!=null?Ot(Vt(e)):{},Xt(r||!e||!e.__esModule?Re(t,"default",{value:e,enumerable:!0}):t,e));var J=$t((_t,Me)=>{"use strict";(function(e,r){"use strict";typeof define=="function"&&define.amd?define(r):typeof Me=="object"&&Me.exports?Me.exports=r():e.log=r()})(_t,function(){"use strict";var e=function(){},r="undefined",t=typeof window!==r&&typeof window.navigator!==r&&/Trident\/|MSIE /.test(window.navigator.userAgent),n=["trace","debug","info","warn","error"];function o(h,m){var u=h[m];if(typeof u.bind=="function")return u.bind(h);try{return Function.prototype.bind.call(u,h)}catch{return function(){return Function.prototype.apply.apply(u,[h,arguments])}}}function c(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function i(h){return h==="debug"&&(h="log"),typeof console===r?!1:h==="trace"&&t?c:console[h]!==void 0?o(console,h):console.log!==void 0?o(console,"log"):e}function a(h,m){for(var u=0;u<n.length;u++){var E=n[u];this[E]=u<h?e:this.methodFactory(E,h,m)}this.log=this.debug}function f(h,m,u){return function(){typeof console!==r&&(a.call(this,m,u),this[h].apply(this,arguments))}}function s(h,m,u){return i(h)||f.apply(this,arguments)}function l(h,m,u){var E=this,v;m=m??"WARN";var T="loglevel";typeof h=="string"?T+=":"+h:typeof h=="symbol"&&(T=void 0);function A(F){var M=(n[F]||"silent").toUpperCase();if(!(typeof window===r||!T)){try{window.localStorage[T]=M;return}catch{}try{window.document.cookie=encodeURIComponent(T)+"="+M+";"}catch{}}}function b(){var F;if(!(typeof window===r||!T)){try{F=window.localStorage[T]}catch{}if(typeof F===r)try{var M=window.document.cookie,I=M.indexOf(encodeURIComponent(T)+"=");I!==-1&&(F=/^([^;]+)/.exec(M.slice(I))[1])}catch{}return E.levels[F]===void 0&&(F=void 0),F}}function _(){if(!(typeof window===r||!T)){try{window.localStorage.removeItem(T);return}catch{}try{window.document.cookie=encodeURIComponent(T)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}E.name=h,E.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},E.methodFactory=u||s,E.getLevel=function(){return v},E.setLevel=function(F,M){if(typeof F=="string"&&E.levels[F.toUpperCase()]!==void 0&&(F=E.levels[F.toUpperCase()]),typeof F=="number"&&F>=0&&F<=E.levels.SILENT){if(v=F,M!==!1&&A(F),a.call(E,F,h),typeof console===r&&F<E.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+F},E.setDefaultLevel=function(F){m=F,b()||E.setLevel(F,!1)},E.resetLevel=function(){E.setLevel(m,!1),_()},E.enableAll=function(F){E.setLevel(E.levels.TRACE,F)},E.disableAll=function(F){E.setLevel(E.levels.SILENT,F)};var g=b();g==null&&(g=m),E.setLevel(g,!1)}var x=new l,p={};x.getLogger=function(m){if(typeof m!="symbol"&&typeof m!="string"||m==="")throw new TypeError("You must supply a name when creating a logger.");var u=p[m];return u||(u=p[m]=new l(m,x.getLevel(),x.methodFactory)),u};var y=typeof window!==r?window.log:void 0;return x.noConflict=function(){return typeof window!==r&&window.log===x&&(window.log=y),x},x.getLoggers=function(){return p},x.default=x,x})});var Be=Float32Array;function Ce(e,r,t){let n=new Be(3);return e&&(n[0]=e),r&&(n[1]=r),t&&(n[2]=t),n}function Yt(e,r,t){return t=t||new Be(3),t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}function jt(e,r,t){return t=t||new Be(3),t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}var pr=Float32Array;function Wt(e){return e=e||new pr(16),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Kt(e,r){r=r||new pr(16);let t=e[0*4+0],n=e[0*4+1],o=e[0*4+2],c=e[0*4+3],i=e[1*4+0],a=e[1*4+1],f=e[1*4+2],s=e[1*4+3],l=e[2*4+0],x=e[2*4+1],p=e[2*4+2],y=e[2*4+3],h=e[3*4+0],m=e[3*4+1],u=e[3*4+2],E=e[3*4+3],v=p*E,T=u*y,A=f*E,b=u*s,_=f*y,g=p*s,F=o*E,M=u*c,I=o*y,P=p*c,d=o*s,B=f*c,w=l*m,L=h*x,G=i*m,V=h*a,H=i*x,X=l*a,ie=t*m,ae=h*n,se=t*x,fe=l*n,le=t*a,ue=i*n,nr=v*a+b*x+_*m-(T*a+A*x+g*m),or=T*n+F*x+P*m-(v*n+M*x+I*m),cr=A*n+M*a+d*m-(b*n+F*a+B*m),ir=g*n+I*a+B*x-(_*n+P*a+d*x),D=1/(t*nr+i*or+l*cr+h*ir);return r[0]=D*nr,r[1]=D*or,r[2]=D*cr,r[3]=D*ir,r[4]=D*(T*i+A*l+g*h-(v*i+b*l+_*h)),r[5]=D*(v*t+M*l+I*h-(T*t+F*l+P*h)),r[6]=D*(b*t+F*i+B*h-(A*t+M*i+d*h)),r[7]=D*(_*t+P*i+d*l-(g*t+I*i+B*l)),r[8]=D*(w*s+V*y+H*E-(L*s+G*y+X*E)),r[9]=D*(L*c+ie*y+fe*E-(w*c+ae*y+se*E)),r[10]=D*(G*c+ae*s+le*E-(V*c+ie*s+ue*E)),r[11]=D*(X*c+se*s+ue*y-(H*c+fe*s+le*y)),r[12]=D*(G*p+X*u+L*f-(H*u+w*f+V*p)),r[13]=D*(se*u+w*o+ae*p-(ie*p+fe*u+L*o)),r[14]=D*(ie*f+ue*u+V*o-(le*u+G*o+ae*f)),r[15]=D*(le*p+H*o+fe*f-(se*f+ue*p+X*o)),r}function qt(e,r,t){t=t||Ce();let n=r[0],o=r[1],c=r[2],i=n*e[0*4+3]+o*e[1*4+3]+c*e[2*4+3]+e[3*4+3];return t[0]=(n*e[0*4+0]+o*e[1*4+0]+c*e[2*4+0]+e[3*4+0])/i,t[1]=(n*e[0*4+1]+o*e[1*4+1]+c*e[2*4+1]+e[3*4+1])/i,t[2]=(n*e[0*4+2]+o*e[1*4+2]+c*e[2*4+2]+e[3*4+2])/i,t}function Zt(e,r,t){t=t||Ce();let n=r[0],o=r[1],c=r[2];return t[0]=n*e[0*4+0]+o*e[1*4+0]+c*e[2*4+0],t[1]=n*e[0*4+1]+o*e[1*4+1]+c*e[2*4+1],t[2]=n*e[0*4+2]+o*e[1*4+2]+c*e[2*4+2],t}var Ne=5120,re=5121,Ue=5122,Le=5123,De=5124,Oe=5125,ze=5126,Qt=32819,Jt=32820,en=33635,rn=5131,tn=33640,nn=35899,on=35902,cn=36269,an=34042,yr={};{let e=yr;e[Ne]=Int8Array,e[re]=Uint8Array,e[Ue]=Int16Array,e[Le]=Uint16Array,e[De]=Int32Array,e[Oe]=Uint32Array,e[ze]=Float32Array,e[Qt]=Uint16Array,e[Jt]=Uint16Array,e[en]=Uint16Array,e[rn]=Uint16Array,e[tn]=Uint32Array,e[nn]=Uint32Array,e[on]=Uint32Array,e[cn]=Uint32Array,e[an]=Uint32Array}function Ge(e){if(e instanceof Int8Array)return Ne;if(e instanceof Uint8Array||e instanceof Uint8ClampedArray)return re;if(e instanceof Int16Array)return Ue;if(e instanceof Uint16Array)return Le;if(e instanceof Int32Array)return De;if(e instanceof Uint32Array)return Oe;if(e instanceof Float32Array)return ze;throw new Error("unsupported typed array type")}function hr(e){if(e===Int8Array)return Ne;if(e===Uint8Array||e===Uint8ClampedArray)return re;if(e===Int16Array)return Ue;if(e===Uint16Array)return Le;if(e===Int32Array)return De;if(e===Uint32Array)return Oe;if(e===Float32Array)return ze;throw new Error("unsupported typed array type")}function sn(e){let r=yr[e];if(!r)throw new Error("unknown gl type");return r}var me=typeof SharedArrayBuffer<"u"?function(r){return r&&r.buffer&&(r.buffer instanceof ArrayBuffer||r.buffer instanceof SharedArrayBuffer)}:function(r){return r&&r.buffer&&r.buffer instanceof ArrayBuffer};function fn(...e){console.error(...e)}var ar=new Map;function Er(e,r){if(!e||typeof e!="object")return!1;let t=ar.get(r);t||(t=new WeakMap,ar.set(r,t));let n=t.get(e);if(n===void 0){let o=Object.prototype.toString.call(e);n=o.substring(8,o.length-1)===r,t.set(e,n)}return n}function ln(e,r){return typeof WebGLBuffer<"u"&&Er(r,"WebGLBuffer")}function br(e,r){return typeof WebGLTexture<"u"&&Er(r,"WebGLTexture")}var Tr=35044,j=34962,Ar=34963,un=34660,mn=5120,xn=5121,pn=5122,yn=5123,hn=5124,En=5125,_r=5126,vr={attribPrefix:""};function bn(e,r,t,n,o){e.bindBuffer(r,t),e.bufferData(r,n,o||Tr)}function Ve(e,r,t,n){if(ln(e,r))return r;t=t||j;let o=e.createBuffer();return bn(e,t,o,r,n),o}function Fr(e){return e==="indices"}function Tn(e){return e===Int8Array||e===Uint8Array}function Mr(e){return e.length?e:e.data}var An=/coord|texture/i,_n=/color|colour/i;function vn(e,r){let t;if(An.test(e)?t=2:_n.test(e)?t=4:t=3,r%t>0)throw new Error(`Can not guess numComponents for attribute '${e}'. Tried ${t} but ${r} values is not evenly divisible by ${t}. You should specify it.`);return t}function Sr(e,r,t){return e.numComponents||e.size||vn(r,t||Mr(e).length)}function pe(e,r){if(me(e))return e;if(me(e.data))return e.data;Array.isArray(e)&&(e={data:e});let t=e.type?ke(e.type):void 0;return t||(Fr(r)?t=Uint16Array:t=Float32Array),new t(e.data)}function Fn(e){return typeof e=="number"?e:e?hr(e):_r}function ke(e){return typeof e=="number"?sn(e):e||Float32Array}function Mn(e,r){return{buffer:r.buffer,numValues:2*3*4,type:Fn(r.type),arrayType:ke(r.type)}}function Sn(e,r){let t=r.data||r,n=ke(r.type),o=t*n.BYTES_PER_ELEMENT,c=e.createBuffer();return e.bindBuffer(j,c),e.bufferData(j,o,r.drawType||Tr),{buffer:c,numValues:t,type:hr(n),arrayType:n}}function gn(e,r,t){let n=pe(r,t);return{arrayType:n.constructor,buffer:Ve(e,n,void 0,r.drawType),type:Ge(n),numValues:0}}function In(e,r){let t={};return Object.keys(r).forEach(function(n){if(!Fr(n)){let o=r[n],c=o.attrib||o.name||o.attribName||vr.attribPrefix+n;if(o.value){if(!Array.isArray(o.value)&&!me(o.value))throw new Error("array.value is not array or typedarray");t[c]={value:o.value}}else{let i;o.buffer&&o.buffer instanceof WebGLBuffer?i=Mn:typeof o=="number"||typeof o.data=="number"?i=Sn:i=gn;let{buffer:a,type:f,numValues:s,arrayType:l}=i(e,o,n),x=o.normalize!==void 0?o.normalize:Tn(l),p=Sr(o,n,s);t[c]={buffer:a,numComponents:p,type:f,normalize:x,stride:o.stride||0,offset:o.offset||0,divisor:o.divisor===void 0?void 0:o.divisor,drawType:o.drawType}}}}),e.bindBuffer(j,null),t}function wn(e,r){return r===mn||r===xn?1:r===pn||r===yn?2:r===hn||r===En||r===_r?4:0}var Q=["position","positions","a_position"];function Pn(e){let r,t;for(t=0;t<Q.length&&(r=Q[t],!(r in e));++t);t===Q.length&&(r=Object.keys(e)[0]);let n=e[r],o=Mr(n).length;if(o===void 0)return 1;let c=Sr(n,r),i=o/c;if(o%c>0)throw new Error(`numComponents ${c} not correct for length ${o}`);return i}function Rn(e,r){let t,n;for(n=0;n<Q.length&&(t=Q[n],!(t in r||(t=vr.attribPrefix+t,t in r)));++n);n===Q.length&&(t=Object.keys(r)[0]);let o=r[t];if(!o.buffer)return 1;e.bindBuffer(j,o.buffer);let c=e.getBufferParameter(j,un);e.bindBuffer(j,null);let i=wn(e,o.type),a=c/i,f=o.numComponents||o.size,s=a/f;if(s%1!==0)throw new Error(`numComponents ${f} not correct for length ${length}`);return s}function $e(e,r,t){let n=In(e,r),o=Object.assign({},t||{});o.attribs=Object.assign({},t?t.attribs:{},n);let c=r.indices;if(c){let i=pe(c,"indices");o.indices=Ve(e,i,Ar),o.numElements=i.length,o.elementType=Ge(i)}else o.numElements||(o.numElements=Rn(e,o.attribs));return o}function dn(e,r,t){let n=t==="indices"?Ar:j,o=pe(r,t);return Ve(e,o,n)}function Bn(e,r){let t={};return Object.keys(r).forEach(function(n){t[n]=dn(e,r[n],n)}),r.indices?(t.numElements=r.indices.length,t.elementType=Ge(pe(r.indices))):t.numElements=Pn(r),t}function Cn(e,r){let t=0;return e.push=function(){for(let n=0;n<arguments.length;++n){let o=arguments[n];if(o instanceof Array||me(o))for(let c=0;c<o.length;++c)e[t++]=o[c];else e[t++]=o}},e.reset=function(n){t=n||0},e.numComponents=r,Object.defineProperty(e,"numElements",{get:function(){return this.length/this.numComponents|0}}),e}function R(e,r,t){let n=t||Float32Array;return Cn(new n(e*r),e)}function He(e,r,t){let n=e.length,o=new Float32Array(3);for(let c=0;c<n;c+=3)t(r,[e[c],e[c+1],e[c+2]],o),e[c]=o[0],e[c+1]=o[1],e[c+2]=o[2]}function Nn(e,r,t){t=t||Ce();let n=r[0],o=r[1],c=r[2];return t[0]=n*e[0*4+0]+o*e[0*4+1]+c*e[0*4+2],t[1]=n*e[1*4+0]+o*e[1*4+1]+c*e[1*4+2],t[2]=n*e[2*4+0]+o*e[2*4+1]+c*e[2*4+2],t}function Un(e,r){return He(e,r,Zt),e}function Ln(e,r){return He(e,Kt(r),Nn),e}function Dn(e,r){return He(e,r,qt),e}function On(e,r){return Object.keys(e).forEach(function(t){let n=e[t];t.indexOf("pos")>=0?Dn(n,r):t.indexOf("tan")>=0||t.indexOf("binorm")>=0?Un(n,r):t.indexOf("norm")>=0&&Ln(n,r)}),e}function gr(e,r,t){return e=e||2,r=r||0,t=t||0,e*=.5,{position:{numComponents:2,data:[r+-1*e,t+-1*e,r+1*e,t+-1*e,r+-1*e,t+1*e,r+1*e,t+1*e]},normal:[0,0,1,0,0,1,0,0,1,0,0,1],texcoord:[0,0,1,0,0,1,1,1],indices:[0,1,2,2,1,3]}}function Ir(e,r,t,n,o){e=e||1,r=r||1,t=t||1,n=n||1,o=o||Wt();let c=(t+1)*(n+1),i=R(3,c),a=R(3,c),f=R(2,c);for(let p=0;p<=n;p++)for(let y=0;y<=t;y++){let h=y/t,m=p/n;i.push(e*h-e*.5,0,r*m-r*.5),a.push(0,1,0),f.push(h,m)}let s=t+1,l=R(3,t*n*2,Uint16Array);for(let p=0;p<n;p++)for(let y=0;y<t;y++)l.push((p+0)*s+y,(p+1)*s+y,(p+0)*s+y+1),l.push((p+1)*s+y,(p+1)*s+y+1,(p+0)*s+y+1);return On({position:i,normal:a,texcoord:f,indices:l},o)}function wr(e,r,t,n,o,c,i){if(r<=0||t<=0)throw new Error("subdivisionAxis and subdivisionHeight must be > 0");n=n||0,o=o||Math.PI,c=c||0,i=i||Math.PI*2;let a=o-n,f=i-c,s=(r+1)*(t+1),l=R(3,s),x=R(3,s),p=R(2,s);for(let m=0;m<=t;m++)for(let u=0;u<=r;u++){let E=u/r,v=m/t,T=f*E+c,A=a*v+n,b=Math.sin(T),_=Math.cos(T),g=Math.sin(A),F=Math.cos(A),M=_*g,I=F,P=b*g;l.push(e*M,e*I,e*P),x.push(M,I,P),p.push(1-E,v)}let y=r+1,h=R(3,r*t*2,Uint16Array);for(let m=0;m<r;m++)for(let u=0;u<t;u++)h.push((u+0)*y+m,(u+0)*y+m+1,(u+1)*y+m),h.push((u+1)*y+m,(u+0)*y+m+1,(u+1)*y+m+1);return{position:l,normal:x,texcoord:p,indices:h}}var zn=[[3,7,5,1],[6,2,0,4],[6,7,3,2],[0,1,5,4],[7,6,4,5],[2,3,1,0]];function Pr(e){e=e||1;let r=e/2,t=[[-r,-r,-r],[+r,-r,-r],[-r,+r,-r],[+r,+r,-r],[-r,-r,+r],[+r,-r,+r],[-r,+r,+r],[+r,+r,+r]],n=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],o=[[1,0],[0,0],[0,1],[1,1]],c=6*4,i=R(3,c),a=R(3,c),f=R(2,c),s=R(3,6*2,Uint16Array);for(let l=0;l<6;++l){let x=zn[l];for(let y=0;y<4;++y){let h=t[x[y]],m=n[l],u=o[y];i.push(h),a.push(m),f.push(u)}let p=4*l;s.push(p+0,p+1,p+2),s.push(p+0,p+2,p+3)}return{position:i,normal:a,texcoord:f,indices:s}}function Xe(e,r,t,n,o,c,i){if(n<3)throw new Error("radialSubdivisions must be 3 or greater");if(o<1)throw new Error("verticalSubdivisions must be 1 or greater");let a=c===void 0?!0:c,f=i===void 0?!0:i,s=(a?2:0)+(f?2:0),l=(n+1)*(o+1+s),x=R(3,l),p=R(3,l),y=R(2,l),h=R(3,n*(o+s/2)*2,Uint16Array),m=n+1,u=Math.atan2(e-r,t),E=Math.cos(u),v=Math.sin(u),T=a?-2:0,A=o+(f?2:0);for(let b=T;b<=A;++b){let _=b/o,g=t*_,F;b<0?(g=0,_=1,F=e):b>o?(g=t,_=1,F=r):F=e+(r-e)*(b/o),(b===-2||b===o+2)&&(F=0,_=0),g-=t/2;for(let M=0;M<m;++M){let I=Math.sin(M*Math.PI*2/n),P=Math.cos(M*Math.PI*2/n);x.push(I*F,g,P*F),b<0?p.push(0,-1,0):b>o?p.push(0,1,0):F===0?p.push(0,0,0):p.push(I*E,v,P*E),y.push(M/n,1-_)}}for(let b=0;b<o+s;++b)if(!(b===1&&a||b===o+s-2&&f))for(let _=0;_<n;++_)h.push(m*(b+0)+0+_,m*(b+0)+1+_,m*(b+1)+1+_),h.push(m*(b+0)+0+_,m*(b+1)+1+_,m*(b+1)+0+_);return{position:x,normal:p,texcoord:y,indices:h}}function sr(e,r){r=r||[];let t=[];for(let n=0;n<e.length;n+=4){let o=e[n],c=e.slice(n+1,n+4);c.push.apply(c,r);for(let i=0;i<o;++i)t.push.apply(t,c)}return t}function Rr(){let e=[0,0,0,0,150,0,30,0,0,0,150,0,30,150,0,30,0,0,30,0,0,30,30,0,100,0,0,30,30,0,100,30,0,100,0,0,30,60,0,30,90,0,67,60,0,30,90,0,67,90,0,67,60,0,0,0,30,30,0,30,0,150,30,0,150,30,30,0,30,30,150,30,30,0,30,100,0,30,30,30,30,30,30,30,100,0,30,100,30,30,30,60,30,67,60,30,30,90,30,30,90,30,67,60,30,67,90,30,0,0,0,100,0,0,100,0,30,0,0,0,100,0,30,0,0,30,100,0,0,100,30,0,100,30,30,100,0,0,100,30,30,100,0,30,30,30,0,30,30,30,100,30,30,30,30,0,100,30,30,100,30,0,30,30,0,30,60,30,30,30,30,30,30,0,30,60,0,30,60,30,30,60,0,67,60,30,30,60,30,30,60,0,67,60,0,67,60,30,67,60,0,67,90,30,67,60,30,67,60,0,67,90,0,67,90,30,30,90,0,30,90,30,67,90,30,30,90,0,67,90,30,67,90,0,30,90,0,30,150,30,30,90,30,30,90,0,30,150,0,30,150,30,0,150,0,0,150,30,30,150,30,0,150,0,30,150,30,30,150,0,0,0,0,0,0,30,0,150,30,0,0,0,0,150,30,0,150,0],r=[.22,.19,.22,.79,.34,.19,.22,.79,.34,.79,.34,.19,.34,.19,.34,.31,.62,.19,.34,.31,.62,.31,.62,.19,.34,.43,.34,.55,.49,.43,.34,.55,.49,.55,.49,.43,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0],t=sr([18,0,0,1,18,0,0,-1,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,-1,0,6,-1,0,0]),n=sr([18,200,70,120,18,80,70,200,6,70,200,210,6,200,200,70,6,210,100,70,6,210,160,70,6,70,180,210,6,100,70,210,6,76,210,100,6,140,210,80,6,90,130,110,6,160,160,220],[255]),o=e.length/3,c={position:R(3,o),texcoord:R(2,o),normal:R(3,o),color:R(4,o,Uint8Array),indices:R(3,o/3,Uint16Array)};c.position.push(e),c.texcoord.push(r),c.normal.push(t),c.color.push(n);for(let i=0;i<o;++i)c.indices.push(i);return c}function dr(e,r,t,n,o,c,i){if(o<=0)throw new Error("subdivisionDown must be > 0");c=c||0,i=i||1;let a=2,f=i-c,s=(o+1)*2*(2+a),l=R(3,s),x=R(3,s),p=R(2,s);function y(v,T,A){return v+(T-v)*A}function h(v,T,A,b,_,g){for(let F=0;F<=o;F++){let M=T/(a-1),I=F/o,P=(M-.5)*2,d=(c+I*f)*Math.PI,B=Math.sin(d),w=Math.cos(d),L=y(e,v,B),G=P*n,V=w*e,H=B*L;l.push(G,V,H);let X=Yt(jt([0,B,w],A),b);x.push(X),p.push(M*_+g,I)}}for(let v=0;v<a;v++){let T=(v/(a-1)-.5)*2;h(r,v,[1,1,1],[0,0,0],1,0),h(r,v,[0,0,0],[T,0,0],0,0),h(t,v,[1,1,1],[0,0,0],1,0),h(t,v,[0,0,0],[T,0,0],0,1)}let m=R(3,o*2*(2+a),Uint16Array);function u(v,T){for(let A=0;A<o;++A)m.push(v+A+0,v+A+1,T+A+0),m.push(v+A+1,T+A+1,T+A+0)}let E=o+1;return u(E*0,E*4),u(E*5,E*7),u(E*6,E*2),u(E*3,E*1),{position:l,normal:x,texcoord:p,indices:m}}function Br(e,r,t,n,o,c){return Xe(e,e,r,t,n,o,c)}function Cr(e,r,t,n,o,c){if(t<3)throw new Error("radialSubdivisions must be 3 or greater");if(n<3)throw new Error("verticalSubdivisions must be 3 or greater");o=o||0,c=c||Math.PI*2;let i=c-o,a=t+1,f=n+1,s=a*f,l=R(3,s),x=R(3,s),p=R(2,s),y=R(3,t*n*2,Uint16Array);for(let h=0;h<f;++h){let m=h/n,u=m*Math.PI*2,E=Math.sin(u),v=e+E*r,T=Math.cos(u),A=T*r;for(let b=0;b<a;++b){let _=b/t,g=o+_*i,F=Math.sin(g),M=Math.cos(g),I=F*v,P=M*v,d=F*E,B=M*E;l.push(I,A,P),x.push(d,T,B),p.push(_,1-m)}}for(let h=0;h<n;++h)for(let m=0;m<t;++m){let u=1+m,E=1+h;y.push(a*h+m,a*E+m,a*h+u),y.push(a*E+m,a*E+u,a*h+u)}return{position:l,normal:x,texcoord:p,indices:y}}function Nr(e,r,t,n,o){if(r<3)throw new Error("divisions must be at least 3");t=t||1,o=o||1,n=n||0;let c=(r+1)*(t+1),i=R(3,c),a=R(3,c),f=R(2,c),s=R(3,t*r*2,Uint16Array),l=0,x=e-n,p=r+1;for(let y=0;y<=t;++y){let h=n+x*Math.pow(y/t,o);for(let m=0;m<=r;++m){let u=2*Math.PI*m/r,E=h*Math.cos(u),v=h*Math.sin(u);if(i.push(E,0,v),a.push(0,1,0),f.push(1-m/r,y/t),y>0&&m!==r){let T=l+(m+1),A=l+m,b=l+m-p,_=l+(m+1)-p;s.push(T,A,b),s.push(T,b,_)}}l+=r+1}return{position:i,normal:a,texcoord:f,indices:s}}function k(e){return function(r){let t=e.apply(this,Array.prototype.slice.call(arguments,1));return Bn(r,t)}}function $(e){return function(r){let t=e.apply(null,Array.prototype.slice.call(arguments,1));return $e(r,t)}}var Si=$(Rr),gi=k(Rr),Ii=$(Pr),wi=k(Pr),Pi=$(Ir),Ri=k(Ir),di=$(wr),Bi=k(wr),Ci=$(Xe),Ni=k(Xe),Ui=$(gr),Li=k(gr),Di=$(dr),Oi=k(dr),zi=$(Br),Gi=k(Br),Vi=$(Cr),ki=k(Cr),$i=$(Nr),Hi=k(Nr);function Ye(e){return!!e.texStorage2D}var Gn=function(){let e={},r={};function t(n){let o=n.constructor.name;if(!e[o]){for(let c in n)if(typeof n[c]=="number"){let i=r[n[c]];r[n[c]]=i?`${i} | ${c}`:c}e[o]=!0}}return function(o,c){return t(o),r[c]||(typeof c=="number"?`0x${c.toString(16)}`:c)}}();var Xi={textureColor:new Uint8Array([128,192,255,255]),textureOptions:{},crossOrigin:void 0};var Yi=function(){let e;return function(){return e=e||(typeof document<"u"&&document.createElement?document.createElement("canvas").getContext("2d"):null),e}}(),Vn=6406,fr=6407,lr=6408,kn=6409,$n=6410,Hn=6402,Xn=34041;var Yn=33319,jn=33320,Wn=6403,Kn=36244,qn=36248,Zn=36249,Qn={};{let e=Qn;e[Vn]={numColorComponents:1},e[kn]={numColorComponents:1},e[$n]={numColorComponents:2},e[fr]={numColorComponents:3},e[lr]={numColorComponents:4},e[Wn]={numColorComponents:1},e[Kn]={numColorComponents:1},e[Yn]={numColorComponents:2},e[jn]={numColorComponents:2},e[fr]={numColorComponents:3},e[qn]={numColorComponents:3},e[lr]={numColorComponents:4},e[Zn]={numColorComponents:4},e[Hn]={numColorComponents:1},e[Xn]={numColorComponents:2}}var je=fn;function Ur(e){return typeof document<"u"&&document.getElementById?document.getElementById(e):null}var xe=33984;var ye=34962,Jn=34963;var eo=35713,ro=35714,to=35632,no=35633,oo=35981,Lr=35718,co=35721,io=35971,ao=35382,so=35396,fo=35398,lo=35392,uo=35395,he=5126,Dr=35664,Or=35665,zr=35666,We=5124,Gr=35667,Vr=35668,kr=35669,$r=35670,Hr=35671,Xr=35672,Yr=35673,jr=35674,Wr=35675,Kr=35676,mo=35678,xo=35680,po=35679,yo=35682,ho=35685,Eo=35686,bo=35687,To=35688,Ao=35689,_o=35690,vo=36289,Fo=36292,Mo=36293,Ke=5125,qr=36294,Zr=36295,Qr=36296,So=36298,go=36299,Io=36300,wo=36303,Po=36306,Ro=36307,Bo=36308,Co=36311,Ee=3553,be=34067,qe=32879,Te=35866,S={};function Jr(e,r){return S[r].bindPoint}function No(e,r){return function(t){e.uniform1f(r,t)}}function Uo(e,r){return function(t){e.uniform1fv(r,t)}}function Lo(e,r){return function(t){e.uniform2fv(r,t)}}function Do(e,r){return function(t){e.uniform3fv(r,t)}}function Oo(e,r){return function(t){e.uniform4fv(r,t)}}function et(e,r){return function(t){e.uniform1i(r,t)}}function rt(e,r){return function(t){e.uniform1iv(r,t)}}function tt(e,r){return function(t){e.uniform2iv(r,t)}}function nt(e,r){return function(t){e.uniform3iv(r,t)}}function ot(e,r){return function(t){e.uniform4iv(r,t)}}function zo(e,r){return function(t){e.uniform1ui(r,t)}}function Go(e,r){return function(t){e.uniform1uiv(r,t)}}function Vo(e,r){return function(t){e.uniform2uiv(r,t)}}function ko(e,r){return function(t){e.uniform3uiv(r,t)}}function $o(e,r){return function(t){e.uniform4uiv(r,t)}}function Ho(e,r){return function(t){e.uniformMatrix2fv(r,!1,t)}}function Xo(e,r){return function(t){e.uniformMatrix3fv(r,!1,t)}}function Yo(e,r){return function(t){e.uniformMatrix4fv(r,!1,t)}}function jo(e,r){return function(t){e.uniformMatrix2x3fv(r,!1,t)}}function Wo(e,r){return function(t){e.uniformMatrix3x2fv(r,!1,t)}}function Ko(e,r){return function(t){e.uniformMatrix2x4fv(r,!1,t)}}function qo(e,r){return function(t){e.uniformMatrix4x2fv(r,!1,t)}}function Zo(e,r){return function(t){e.uniformMatrix3x4fv(r,!1,t)}}function Qo(e,r){return function(t){e.uniformMatrix4x3fv(r,!1,t)}}function O(e,r,t,n){let o=Jr(e,r);return Ye(e)?function(c){let i,a;!c||br(e,c)?(i=c,a=null):(i=c.texture,a=c.sampler),e.uniform1i(n,t),e.activeTexture(xe+t),e.bindTexture(o,i),e.bindSampler(t,a)}:function(c){e.uniform1i(n,t),e.activeTexture(xe+t),e.bindTexture(o,c)}}function z(e,r,t,n,o){let c=Jr(e,r),i=new Int32Array(o);for(let a=0;a<o;++a)i[a]=t+a;return Ye(e)?function(a){e.uniform1iv(n,i),a.forEach(function(f,s){e.activeTexture(xe+i[s]);let l,x;!f||br(e,f)?(l=f,x=null):(l=f.texture,x=f.sampler),e.bindSampler(t,x),e.bindTexture(c,l)})}:function(a){e.uniform1iv(n,i),a.forEach(function(f,s){e.activeTexture(xe+i[s]),e.bindTexture(c,f)})}}S[he]={Type:Float32Array,size:4,setter:No,arraySetter:Uo};S[Dr]={Type:Float32Array,size:8,setter:Lo,cols:2};S[Or]={Type:Float32Array,size:12,setter:Do,cols:3};S[zr]={Type:Float32Array,size:16,setter:Oo,cols:4};S[We]={Type:Int32Array,size:4,setter:et,arraySetter:rt};S[Gr]={Type:Int32Array,size:8,setter:tt,cols:2};S[Vr]={Type:Int32Array,size:12,setter:nt,cols:3};S[kr]={Type:Int32Array,size:16,setter:ot,cols:4};S[Ke]={Type:Uint32Array,size:4,setter:zo,arraySetter:Go};S[qr]={Type:Uint32Array,size:8,setter:Vo,cols:2};S[Zr]={Type:Uint32Array,size:12,setter:ko,cols:3};S[Qr]={Type:Uint32Array,size:16,setter:$o,cols:4};S[$r]={Type:Uint32Array,size:4,setter:et,arraySetter:rt};S[Hr]={Type:Uint32Array,size:8,setter:tt,cols:2};S[Xr]={Type:Uint32Array,size:12,setter:nt,cols:3};S[Yr]={Type:Uint32Array,size:16,setter:ot,cols:4};S[jr]={Type:Float32Array,size:32,setter:Ho,rows:2,cols:2};S[Wr]={Type:Float32Array,size:48,setter:Xo,rows:3,cols:3};S[Kr]={Type:Float32Array,size:64,setter:Yo,rows:4,cols:4};S[ho]={Type:Float32Array,size:32,setter:jo,rows:2,cols:3};S[Eo]={Type:Float32Array,size:32,setter:Ko,rows:2,cols:4};S[bo]={Type:Float32Array,size:48,setter:Wo,rows:3,cols:2};S[To]={Type:Float32Array,size:48,setter:Zo,rows:3,cols:4};S[Ao]={Type:Float32Array,size:64,setter:qo,rows:4,cols:2};S[_o]={Type:Float32Array,size:64,setter:Qo,rows:4,cols:3};S[mo]={Type:null,size:0,setter:O,arraySetter:z,bindPoint:Ee};S[xo]={Type:null,size:0,setter:O,arraySetter:z,bindPoint:be};S[po]={Type:null,size:0,setter:O,arraySetter:z,bindPoint:qe};S[yo]={Type:null,size:0,setter:O,arraySetter:z,bindPoint:Ee};S[vo]={Type:null,size:0,setter:O,arraySetter:z,bindPoint:Te};S[Fo]={Type:null,size:0,setter:O,arraySetter:z,bindPoint:Te};S[Mo]={Type:null,size:0,setter:O,arraySetter:z,bindPoint:be};S[So]={Type:null,size:0,setter:O,arraySetter:z,bindPoint:Ee};S[go]={Type:null,size:0,setter:O,arraySetter:z,bindPoint:qe};S[Io]={Type:null,size:0,setter:O,arraySetter:z,bindPoint:be};S[wo]={Type:null,size:0,setter:O,arraySetter:z,bindPoint:Te};S[Po]={Type:null,size:0,setter:O,arraySetter:z,bindPoint:Ee};S[Ro]={Type:null,size:0,setter:O,arraySetter:z,bindPoint:qe};S[Bo]={Type:null,size:0,setter:O,arraySetter:z,bindPoint:be};S[Co]={Type:null,size:0,setter:O,arraySetter:z,bindPoint:Te};function Ae(e,r){return function(t){if(t.value)switch(e.disableVertexAttribArray(r),t.value.length){case 4:e.vertexAttrib4fv(r,t.value);break;case 3:e.vertexAttrib3fv(r,t.value);break;case 2:e.vertexAttrib2fv(r,t.value);break;case 1:e.vertexAttrib1fv(r,t.value);break;default:throw new Error("the length of a float constant value must be between 1 and 4!")}else e.bindBuffer(ye,t.buffer),e.enableVertexAttribArray(r),e.vertexAttribPointer(r,t.numComponents||t.size,t.type||he,t.normalize||!1,t.stride||0,t.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(r,t.divisor||0)}}function W(e,r){return function(t){if(t.value)if(e.disableVertexAttribArray(r),t.value.length===4)e.vertexAttrib4iv(r,t.value);else throw new Error("The length of an integer constant value must be 4!");else e.bindBuffer(ye,t.buffer),e.enableVertexAttribArray(r),e.vertexAttribIPointer(r,t.numComponents||t.size,t.type||We,t.stride||0,t.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(r,t.divisor||0)}}function _e(e,r){return function(t){if(t.value)if(e.disableVertexAttribArray(r),t.value.length===4)e.vertexAttrib4uiv(r,t.value);else throw new Error("The length of an unsigned integer constant value must be 4!");else e.bindBuffer(ye,t.buffer),e.enableVertexAttribArray(r),e.vertexAttribIPointer(r,t.numComponents||t.size,t.type||Ke,t.stride||0,t.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(r,t.divisor||0)}}function Ze(e,r,t){let n=t.size,o=t.count;return function(c){e.bindBuffer(ye,c.buffer);let i=c.size||c.numComponents||n,a=i/o,f=c.type||he,l=S[f].size*i,x=c.normalize||!1,p=c.offset||0,y=l/o;for(let h=0;h<o;++h)e.enableVertexAttribArray(r+h),e.vertexAttribPointer(r+h,a,f,x,l,p+y*h),e.vertexAttribDivisor&&e.vertexAttribDivisor(r+h,c.divisor||0)}}var U={};U[he]={size:4,setter:Ae};U[Dr]={size:8,setter:Ae};U[Or]={size:12,setter:Ae};U[zr]={size:16,setter:Ae};U[We]={size:4,setter:W};U[Gr]={size:8,setter:W};U[Vr]={size:12,setter:W};U[kr]={size:16,setter:W};U[Ke]={size:4,setter:_e};U[qr]={size:8,setter:_e};U[Zr]={size:12,setter:_e};U[Qr]={size:16,setter:_e};U[$r]={size:4,setter:W};U[Hr]={size:8,setter:W};U[Xr]={size:12,setter:W};U[Yr]={size:16,setter:W};U[jr]={size:4,setter:Ze,count:2};U[Wr]={size:9,setter:Ze,count:3};U[Kr]={size:16,setter:Ze,count:4};var Jo=/ERROR:\s*\d+:(\d+)/gi;function ec(e,r="",t=0){let n=[...r.matchAll(Jo)],o=new Map(n.map((c,i)=>{let a=parseInt(c[1]),f=n[i+1],s=f?f.index:r.length,l=r.substring(c.index,s);return[a-1,l]}));return e.split(`
`).map((c,i)=>{let a=o.get(i);return`${i+1+t}: ${c}${a?`

^^^ ${a}`:""}`}).join(`
`)}var ur=/^[ \t]*\n/;function ct(e){let r=0;return ur.test(e)&&(r=1,e=e.replace(ur,"")),{lineOffset:r,shaderSource:e}}function rc(e,r){return e.errorCallback(r),e.callback&&setTimeout(()=>{e.callback(`${r}
${e.errors.join(`
`)}`)}),null}function tc(e,r,t,n){if(n=n||je,!e.getShaderParameter(t,eo)){let c=e.getShaderInfoLog(t),{lineOffset:i,shaderSource:a}=ct(e.getShaderSource(t)),f=`${ec(a,c,i)}
Error compiling ${Gn(e,r)}: ${c}`;return n(f),f}return""}function te(e,r,t){let n,o,c;if(typeof r=="function"&&(t=r,r=void 0),typeof e=="function")t=e,e=void 0;else if(e&&!Array.isArray(e)){let s=e;t=s.errorCallback,e=s.attribLocations,n=s.transformFeedbackVaryings,o=s.transformFeedbackMode,c=s.callback}let i=t||je,a=[],f={errorCallback(s,...l){a.push(s),i(s,...l)},transformFeedbackVaryings:n,transformFeedbackMode:o,callback:c,errors:a};{let s={};Array.isArray(e)?e.forEach(function(l,x){s[l]=r?r[x]:x}):s=e||{},f.attribLocations=s}return f}var nc=["VERTEX_SHADER","FRAGMENT_SHADER"];function oc(e,r){if(r.indexOf("frag")>=0)return to;if(r.indexOf("vert")>=0)return no}function cc(e,r,t){let n=e.getAttachedShaders(r);for(let o of n)t.has(o)&&e.deleteShader(o);e.deleteProgram(r)}var ic=(e=0)=>new Promise(r=>setTimeout(r,e));function it(e,r,t){let n=e.createProgram(),{attribLocations:o,transformFeedbackVaryings:c,transformFeedbackMode:i}=te(t);for(let a=0;a<r.length;++a){let f=r[a];if(typeof f=="string"){let s=Ur(f),l=s?s.text:f,x=e[nc[a]];s&&s.type&&(x=oc(e,s.type)||x),f=e.createShader(x),e.shaderSource(f,ct(l).shaderSource),e.compileShader(f),e.attachShader(n,f)}}Object.entries(o).forEach(([a,f])=>e.bindAttribLocation(n,f,a));{let a=c;a&&(a.attribs&&(a=a.attribs),Array.isArray(a)||(a=Object.keys(a)),e.transformFeedbackVaryings(n,a,i||oo))}return e.linkProgram(n),n}function at(e,r,t,n,o){let c=te(t,n,o),i=new Set(r),a=it(e,r,c);function f(s,l){let x=ft(s,l,c.errorCallback);return x&&cc(s,l,i),x}if(c.callback){st(e,a).then(()=>{let s=f(e,a);c.callback(s,s?void 0:a)});return}return f(e,a)?void 0:a}function ve(e){return function(r,t,...n){return new Promise((o,c)=>{let i=te(...n);i.callback=(a,f)=>{a?c(a):o(f)},e(r,t,i)})}}var ji=ve(at),Wi=ve(Qe);async function st(e,r){let t=e.getExtension("KHR_parallel_shader_compile"),n=t?(c,i)=>c.getProgramParameter(i,t.COMPLETION_STATUS_KHR):()=>!0,o=0;do await ic(o),o=1e3/60;while(!n(e,r))}async function ac(e,r){for(let t of Object.values(r))await st(e,t)}function ft(e,r,t){if(t=t||je,!e.getProgramParameter(r,ro)){let o=e.getProgramInfoLog(r);t(`Error in program linking: ${o}`);let i=e.getAttachedShaders(r).map(a=>tc(e,e.getShaderParameter(a,e.SHADER_TYPE),a,t));return`${o}
${i.filter(a=>a).join(`
`)}`}}function sc(e,r,t,n,o){return at(e,r,t,n,o)}function lt(e){let r=e.name;return r.startsWith("gl_")||r.startsWith("webgl_")}var fc=/(\.|\[|]|\w+)/g,lc=e=>e>="0"&&e<="9";function uc(e,r,t,n){let o=e.split(fc).filter(a=>a!==""),c=0,i="";for(;;){let a=o[c++];i+=a;let f=lc(a[0]),s=f?parseInt(a):a;if(f&&(i+=o[c++]),c===o.length){t[s]=r;break}else{let x=o[c++],p=x==="[",y=t[s]||(p?[]:{});t[s]=y,t=y,n[i]=n[i]||function(h){return function(m){ut(h,m)}}(y),i+=x}}}function mc(e,r){let t=0;function n(a,f,s){let l=f.name.endsWith("[0]"),x=f.type,p=S[x];if(!p)throw new Error(`unknown type: 0x${x.toString(16)}`);let y;if(p.bindPoint){let h=t;t+=f.size,l?y=p.arraySetter(e,x,h,s,f.size):y=p.setter(e,x,h,s,f.size)}else p.arraySetter&&l?y=p.arraySetter(e,s):y=p.setter(e,s);return y.location=s,y}let o={},c={},i=e.getProgramParameter(r,Lr);for(let a=0;a<i;++a){let f=e.getActiveUniform(r,a);if(lt(f))continue;let s=f.name;s.endsWith("[0]")&&(s=s.substr(0,s.length-3));let l=e.getUniformLocation(r,f.name);if(l){let x=n(r,f,l);o[s]=x,uc(s,x,c,o)}}return o}function xc(e,r){let t={},n=e.getProgramParameter(r,io);for(let o=0;o<n;++o){let c=e.getTransformFeedbackVarying(r,o);t[c.name]={index:o,type:c.type,size:c.size}}return t}function pc(e,r){let t=e.getProgramParameter(r,Lr),n=[],o=[];for(let a=0;a<t;++a){o.push(a),n.push({});let f=e.getActiveUniform(r,a);n[a].name=f.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach(function(a){let f=a[0],s=a[1];e.getActiveUniforms(r,o,e[f]).forEach(function(l,x){n[x][s]=l})});let c={},i=e.getProgramParameter(r,ao);for(let a=0;a<i;++a){let f=e.getActiveUniformBlockName(r,a),s={index:e.getUniformBlockIndex(r,f),usedByVertexShader:e.getActiveUniformBlockParameter(r,a,so),usedByFragmentShader:e.getActiveUniformBlockParameter(r,a,fo),size:e.getActiveUniformBlockParameter(r,a,lo),uniformIndices:e.getActiveUniformBlockParameter(r,a,uo)};s.used=s.usedByVertexShader||s.usedByFragmentShader,c[f]=s}return{blockSpecs:c,uniformData:n}}function ut(e,r){for(let t in r){let n=e[t];typeof n=="function"?n(r[t]):ut(e[t],r[t])}}function K(e,...r){let t=e.uniformSetters||e,n=r.length;for(let o=0;o<n;++o){let c=r[o];if(Array.isArray(c)){let i=c.length;for(let a=0;a<i;++a)K(t,c[a])}else for(let i in c){let a=t[i];a&&a(c[i])}}}function yc(e,r){let t={},n=e.getProgramParameter(r,co);for(let o=0;o<n;++o){let c=e.getActiveAttrib(r,o);if(lt(c))continue;let i=e.getAttribLocation(r,c.name),a=U[c.type],f=a.setter(e,i,a);f.location=i,t[c.name]=f}return t}function hc(e,r){for(let t in r){let n=e[t];n&&n(r[t])}}function mt(e,r,t){t.vertexArrayObject?e.bindVertexArray(t.vertexArrayObject):(hc(r.attribSetters||r,t.attribs),t.indices&&e.bindBuffer(Jn,t.indices))}function de(e,r){let t=mc(e,r),n=yc(e,r),o={program:r,uniformSetters:t,attribSetters:n};return Ye(e)&&(o.uniformBlockSpec=pc(e,r),o.transformFeedbackInfo=xc(e,r)),o}var Ec=/\s|{|}|;/;function Qe(e,r,t,n,o){let c=te(t,n,o),i=[];if(r=r.map(function(s){if(!Ec.test(s)){let l=Ur(s);if(l)s=l.text;else{let x=`no element with id: ${s}`;c.errorCallback(x),i.push(x)}}return s}),i.length)return rc(c,"");let a=c.callback;a&&(c.callback=(s,l)=>{a(s,s?void 0:de(e,l))});let f=sc(e,r,c);return f?de(e,f):null}function mr(e,r,t,n,o){for(let[c,i]of Object.entries(r)){let a={...o},f=t[c];Array.isArray(f)||Object.assign(a,f);let s=ft(e,i,a.errorCallback);if(s){for(let l of Object.values(r)){let x=e.getAttachedShaders(l);e.deleteProgram(l);for(let p of x)n.has(p)||e.deleteShader(p)}return s}}}function xt(e,r,t={}){let n=new Set,o=Object.fromEntries(Object.entries(r).map(([i,a])=>{let f={...t},s=Array.isArray(a)?a:a.shaders;return Array.isArray(a)||Object.assign(f,a),s.forEach(n.add,n),[i,it(e,s,f)]}));if(t.callback){ac(e,o).then(()=>{let i=mr(e,o,r,n,t);t.callback(i,i?void 0:o)});return}return mr(e,o,r,n,t)?void 0:o}function bc(e,r,t){t=te(t);function n(i,a){return Object.fromEntries(Object.entries(a).map(([f,s])=>[f,de(i,s)]))}let o=t.callback;o&&(t.callback=(i,a)=>{o(i,i?void 0:n(e,a))});let c=xt(e,r,t);if(!(o||!c))return n(e,c)}var Ki=ve(xt),qi=ve(bc);var Tc=4,xr=5123;function pt(e,r,t,n,o,c){t=t===void 0?Tc:t;let i=r.indices,a=r.elementType,f=n===void 0?r.numElements:n;o=o===void 0?0:o,a||i?c!==void 0?e.drawElementsInstanced(t,f,a===void 0?xr:r.elementType,o,c):e.drawElements(t,f,a===void 0?xr:r.elementType,o):c!==void 0?e.drawArraysInstanced(t,o,f,c):e.drawArrays(t,o,f)}var Ac=6402;var _c=33190,vc=36012,Fc=35056,Mc=36013,Sc=32854,gc=32855,Ic=36194,yt=33189,ht=6401,Et=36168,bt=34041;var Fe=36096,Tt=36128,Je=33306;var Y={};Y[bt]=Je;Y[ht]=Tt;Y[Et]=Tt;Y[Ac]=Fe;Y[yt]=Fe;Y[_c]=Fe;Y[vc]=Fe;Y[Fc]=Je;Y[Mc]=Je;var q={};q[Sc]=!0;q[gc]=!0;q[Ic]=!0;q[bt]=!0;q[yt]=!0;q[ht]=!0;q[Et]=!0;function At(e,r){r=r||1,r=Math.max(0,r);let t=e.clientWidth*r|0,n=e.clientHeight*r|0;return e.width!==t||e.height!==n?(e.width=t,e.height=n,!0):!1}var wc="u_mat",ne=class{constructor(r){this.diffuse=r.kd,this.specular=r.ks,this.shininess=r.ns,this.ambient=r.ka,this.emissive=r.ke}apply(r){let t=this.getUniforms();K(r,t)}getUniforms(){let r={};for(let[t,n]of Object.entries(this))n!==void 0&&(r[`${wc}${t[0].toUpperCase()}${t.slice(1)}`]=n);return r}};var vt=ee(J(),1);function ra(e){vt.setLevel(e)}var ce=ee(J(),1);var er=ee(J(),1),oe=null;function Se(e=!0,r="canvas"){return oe||(er.default.info("\u{1F58C}\uFE0F Creating WebGL2 context"),oe=document.querySelector(r).getContext("webgl2",{antialias:e}),oe||er.default.error("\u{1F4A5} Unable to create WebGL2 context!"),oe)}var Pc="u_light",ge=class{constructor(){this.position=[0,0,0];this.color=[1,1,1];this.ambient=[.1,.1,.1]}apply(r){let t=this.getUniforms();K(r,t)}getUniforms(){let r={};for(let[t,n]of Object.entries(this))n!==void 0&&(r[`${Pc}${t[0].toUpperCase()}${t.slice(1)}`]=n);return r}};var Ft=ee(J(),1),Ie=class{constructor(){this.cache=new Map}getModel(r){if(!this.cache.has(r))throw new Error(`Model ${r} not found in cache`);return this.cache.get(r)}addModel(r){Ft.default.debug(`\u{1F9F0} Adding model '${r.name}' to cache`),this.cache.set(r.name,r)}};var N=1e-6,Z=typeof Float32Array<"u"?Float32Array:Array;var sa=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var e=0,r=arguments.length;r--;)e+=arguments[r]*arguments[r];return Math.sqrt(e)});var C={};Ht(C,{add:()=>pi,adjoint:()=>Oc,clone:()=>Bc,copy:()=>Cc,create:()=>dc,determinant:()=>zc,equals:()=>bi,exactEquals:()=>Ei,frob:()=>xi,fromQuat:()=>ni,fromQuat2:()=>Qc,fromRotation:()=>Wc,fromRotationTranslation:()=>gt,fromRotationTranslationScale:()=>ri,fromRotationTranslationScaleOrigin:()=>ti,fromScaling:()=>jc,fromTranslation:()=>Yc,fromValues:()=>Nc,fromXRotation:()=>Kc,fromYRotation:()=>qc,fromZRotation:()=>Zc,frustum:()=>oi,getRotation:()=>ei,getScaling:()=>It,getTranslation:()=>Jc,identity:()=>Mt,invert:()=>Dc,lookAt:()=>li,mul:()=>Ti,multiply:()=>St,multiplyScalar:()=>yi,multiplyScalarAndAdd:()=>hi,ortho:()=>si,orthoNO:()=>Pt,orthoZO:()=>fi,perspective:()=>ci,perspectiveFromFieldOfView:()=>ai,perspectiveNO:()=>wt,perspectiveZO:()=>ii,rotate:()=>kc,rotateX:()=>$c,rotateY:()=>Hc,rotateZ:()=>Xc,scale:()=>Vc,set:()=>Uc,str:()=>mi,sub:()=>Ai,subtract:()=>Rt,targetTo:()=>ui,translate:()=>Gc,transpose:()=>Lc});function dc(){var e=new Z(16);return Z!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function Bc(e){var r=new Z(16);return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function Cc(e,r){return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function Nc(e,r,t,n,o,c,i,a,f,s,l,x,p,y,h,m){var u=new Z(16);return u[0]=e,u[1]=r,u[2]=t,u[3]=n,u[4]=o,u[5]=c,u[6]=i,u[7]=a,u[8]=f,u[9]=s,u[10]=l,u[11]=x,u[12]=p,u[13]=y,u[14]=h,u[15]=m,u}function Uc(e,r,t,n,o,c,i,a,f,s,l,x,p,y,h,m,u){return e[0]=r,e[1]=t,e[2]=n,e[3]=o,e[4]=c,e[5]=i,e[6]=a,e[7]=f,e[8]=s,e[9]=l,e[10]=x,e[11]=p,e[12]=y,e[13]=h,e[14]=m,e[15]=u,e}function Mt(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Lc(e,r){if(e===r){var t=r[1],n=r[2],o=r[3],c=r[6],i=r[7],a=r[11];e[1]=r[4],e[2]=r[8],e[3]=r[12],e[4]=t,e[6]=r[9],e[7]=r[13],e[8]=n,e[9]=c,e[11]=r[14],e[12]=o,e[13]=i,e[14]=a}else e[0]=r[0],e[1]=r[4],e[2]=r[8],e[3]=r[12],e[4]=r[1],e[5]=r[5],e[6]=r[9],e[7]=r[13],e[8]=r[2],e[9]=r[6],e[10]=r[10],e[11]=r[14],e[12]=r[3],e[13]=r[7],e[14]=r[11],e[15]=r[15];return e}function Dc(e,r){var t=r[0],n=r[1],o=r[2],c=r[3],i=r[4],a=r[5],f=r[6],s=r[7],l=r[8],x=r[9],p=r[10],y=r[11],h=r[12],m=r[13],u=r[14],E=r[15],v=t*a-n*i,T=t*f-o*i,A=t*s-c*i,b=n*f-o*a,_=n*s-c*a,g=o*s-c*f,F=l*m-x*h,M=l*u-p*h,I=l*E-y*h,P=x*u-p*m,d=x*E-y*m,B=p*E-y*u,w=v*B-T*d+A*P+b*I-_*M+g*F;return w?(w=1/w,e[0]=(a*B-f*d+s*P)*w,e[1]=(o*d-n*B-c*P)*w,e[2]=(m*g-u*_+E*b)*w,e[3]=(p*_-x*g-y*b)*w,e[4]=(f*I-i*B-s*M)*w,e[5]=(t*B-o*I+c*M)*w,e[6]=(u*A-h*g-E*T)*w,e[7]=(l*g-p*A+y*T)*w,e[8]=(i*d-a*I+s*F)*w,e[9]=(n*I-t*d-c*F)*w,e[10]=(h*_-m*A+E*v)*w,e[11]=(x*A-l*_-y*v)*w,e[12]=(a*M-i*P-f*F)*w,e[13]=(t*P-n*M+o*F)*w,e[14]=(m*T-h*b-u*v)*w,e[15]=(l*b-x*T+p*v)*w,e):null}function Oc(e,r){var t=r[0],n=r[1],o=r[2],c=r[3],i=r[4],a=r[5],f=r[6],s=r[7],l=r[8],x=r[9],p=r[10],y=r[11],h=r[12],m=r[13],u=r[14],E=r[15];return e[0]=a*(p*E-y*u)-x*(f*E-s*u)+m*(f*y-s*p),e[1]=-(n*(p*E-y*u)-x*(o*E-c*u)+m*(o*y-c*p)),e[2]=n*(f*E-s*u)-a*(o*E-c*u)+m*(o*s-c*f),e[3]=-(n*(f*y-s*p)-a*(o*y-c*p)+x*(o*s-c*f)),e[4]=-(i*(p*E-y*u)-l*(f*E-s*u)+h*(f*y-s*p)),e[5]=t*(p*E-y*u)-l*(o*E-c*u)+h*(o*y-c*p),e[6]=-(t*(f*E-s*u)-i*(o*E-c*u)+h*(o*s-c*f)),e[7]=t*(f*y-s*p)-i*(o*y-c*p)+l*(o*s-c*f),e[8]=i*(x*E-y*m)-l*(a*E-s*m)+h*(a*y-s*x),e[9]=-(t*(x*E-y*m)-l*(n*E-c*m)+h*(n*y-c*x)),e[10]=t*(a*E-s*m)-i*(n*E-c*m)+h*(n*s-c*a),e[11]=-(t*(a*y-s*x)-i*(n*y-c*x)+l*(n*s-c*a)),e[12]=-(i*(x*u-p*m)-l*(a*u-f*m)+h*(a*p-f*x)),e[13]=t*(x*u-p*m)-l*(n*u-o*m)+h*(n*p-o*x),e[14]=-(t*(a*u-f*m)-i*(n*u-o*m)+h*(n*f-o*a)),e[15]=t*(a*p-f*x)-i*(n*p-o*x)+l*(n*f-o*a),e}function zc(e){var r=e[0],t=e[1],n=e[2],o=e[3],c=e[4],i=e[5],a=e[6],f=e[7],s=e[8],l=e[9],x=e[10],p=e[11],y=e[12],h=e[13],m=e[14],u=e[15],E=r*i-t*c,v=r*a-n*c,T=r*f-o*c,A=t*a-n*i,b=t*f-o*i,_=n*f-o*a,g=s*h-l*y,F=s*m-x*y,M=s*u-p*y,I=l*m-x*h,P=l*u-p*h,d=x*u-p*m;return E*d-v*P+T*I+A*M-b*F+_*g}function St(e,r,t){var n=r[0],o=r[1],c=r[2],i=r[3],a=r[4],f=r[5],s=r[6],l=r[7],x=r[8],p=r[9],y=r[10],h=r[11],m=r[12],u=r[13],E=r[14],v=r[15],T=t[0],A=t[1],b=t[2],_=t[3];return e[0]=T*n+A*a+b*x+_*m,e[1]=T*o+A*f+b*p+_*u,e[2]=T*c+A*s+b*y+_*E,e[3]=T*i+A*l+b*h+_*v,T=t[4],A=t[5],b=t[6],_=t[7],e[4]=T*n+A*a+b*x+_*m,e[5]=T*o+A*f+b*p+_*u,e[6]=T*c+A*s+b*y+_*E,e[7]=T*i+A*l+b*h+_*v,T=t[8],A=t[9],b=t[10],_=t[11],e[8]=T*n+A*a+b*x+_*m,e[9]=T*o+A*f+b*p+_*u,e[10]=T*c+A*s+b*y+_*E,e[11]=T*i+A*l+b*h+_*v,T=t[12],A=t[13],b=t[14],_=t[15],e[12]=T*n+A*a+b*x+_*m,e[13]=T*o+A*f+b*p+_*u,e[14]=T*c+A*s+b*y+_*E,e[15]=T*i+A*l+b*h+_*v,e}function Gc(e,r,t){var n=t[0],o=t[1],c=t[2],i,a,f,s,l,x,p,y,h,m,u,E;return r===e?(e[12]=r[0]*n+r[4]*o+r[8]*c+r[12],e[13]=r[1]*n+r[5]*o+r[9]*c+r[13],e[14]=r[2]*n+r[6]*o+r[10]*c+r[14],e[15]=r[3]*n+r[7]*o+r[11]*c+r[15]):(i=r[0],a=r[1],f=r[2],s=r[3],l=r[4],x=r[5],p=r[6],y=r[7],h=r[8],m=r[9],u=r[10],E=r[11],e[0]=i,e[1]=a,e[2]=f,e[3]=s,e[4]=l,e[5]=x,e[6]=p,e[7]=y,e[8]=h,e[9]=m,e[10]=u,e[11]=E,e[12]=i*n+l*o+h*c+r[12],e[13]=a*n+x*o+m*c+r[13],e[14]=f*n+p*o+u*c+r[14],e[15]=s*n+y*o+E*c+r[15]),e}function Vc(e,r,t){var n=t[0],o=t[1],c=t[2];return e[0]=r[0]*n,e[1]=r[1]*n,e[2]=r[2]*n,e[3]=r[3]*n,e[4]=r[4]*o,e[5]=r[5]*o,e[6]=r[6]*o,e[7]=r[7]*o,e[8]=r[8]*c,e[9]=r[9]*c,e[10]=r[10]*c,e[11]=r[11]*c,e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function kc(e,r,t,n){var o=n[0],c=n[1],i=n[2],a=Math.hypot(o,c,i),f,s,l,x,p,y,h,m,u,E,v,T,A,b,_,g,F,M,I,P,d,B,w,L;return a<N?null:(a=1/a,o*=a,c*=a,i*=a,f=Math.sin(t),s=Math.cos(t),l=1-s,x=r[0],p=r[1],y=r[2],h=r[3],m=r[4],u=r[5],E=r[6],v=r[7],T=r[8],A=r[9],b=r[10],_=r[11],g=o*o*l+s,F=c*o*l+i*f,M=i*o*l-c*f,I=o*c*l-i*f,P=c*c*l+s,d=i*c*l+o*f,B=o*i*l+c*f,w=c*i*l-o*f,L=i*i*l+s,e[0]=x*g+m*F+T*M,e[1]=p*g+u*F+A*M,e[2]=y*g+E*F+b*M,e[3]=h*g+v*F+_*M,e[4]=x*I+m*P+T*d,e[5]=p*I+u*P+A*d,e[6]=y*I+E*P+b*d,e[7]=h*I+v*P+_*d,e[8]=x*B+m*w+T*L,e[9]=p*B+u*w+A*L,e[10]=y*B+E*w+b*L,e[11]=h*B+v*w+_*L,r!==e&&(e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e)}function $c(e,r,t){var n=Math.sin(t),o=Math.cos(t),c=r[4],i=r[5],a=r[6],f=r[7],s=r[8],l=r[9],x=r[10],p=r[11];return r!==e&&(e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[4]=c*o+s*n,e[5]=i*o+l*n,e[6]=a*o+x*n,e[7]=f*o+p*n,e[8]=s*o-c*n,e[9]=l*o-i*n,e[10]=x*o-a*n,e[11]=p*o-f*n,e}function Hc(e,r,t){var n=Math.sin(t),o=Math.cos(t),c=r[0],i=r[1],a=r[2],f=r[3],s=r[8],l=r[9],x=r[10],p=r[11];return r!==e&&(e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[0]=c*o-s*n,e[1]=i*o-l*n,e[2]=a*o-x*n,e[3]=f*o-p*n,e[8]=c*n+s*o,e[9]=i*n+l*o,e[10]=a*n+x*o,e[11]=f*n+p*o,e}function Xc(e,r,t){var n=Math.sin(t),o=Math.cos(t),c=r[0],i=r[1],a=r[2],f=r[3],s=r[4],l=r[5],x=r[6],p=r[7];return r!==e&&(e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e[0]=c*o+s*n,e[1]=i*o+l*n,e[2]=a*o+x*n,e[3]=f*o+p*n,e[4]=s*o-c*n,e[5]=l*o-i*n,e[6]=x*o-a*n,e[7]=p*o-f*n,e}function Yc(e,r){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function jc(e,r){return e[0]=r[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=r[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Wc(e,r,t){var n=t[0],o=t[1],c=t[2],i=Math.hypot(n,o,c),a,f,s;return i<N?null:(i=1/i,n*=i,o*=i,c*=i,a=Math.sin(r),f=Math.cos(r),s=1-f,e[0]=n*n*s+f,e[1]=o*n*s+c*a,e[2]=c*n*s-o*a,e[3]=0,e[4]=n*o*s-c*a,e[5]=o*o*s+f,e[6]=c*o*s+n*a,e[7]=0,e[8]=n*c*s+o*a,e[9]=o*c*s-n*a,e[10]=c*c*s+f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function Kc(e,r){var t=Math.sin(r),n=Math.cos(r);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=t,e[7]=0,e[8]=0,e[9]=-t,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function qc(e,r){var t=Math.sin(r),n=Math.cos(r);return e[0]=n,e[1]=0,e[2]=-t,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=t,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Zc(e,r){var t=Math.sin(r),n=Math.cos(r);return e[0]=n,e[1]=t,e[2]=0,e[3]=0,e[4]=-t,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function gt(e,r,t){var n=r[0],o=r[1],c=r[2],i=r[3],a=n+n,f=o+o,s=c+c,l=n*a,x=n*f,p=n*s,y=o*f,h=o*s,m=c*s,u=i*a,E=i*f,v=i*s;return e[0]=1-(y+m),e[1]=x+v,e[2]=p-E,e[3]=0,e[4]=x-v,e[5]=1-(l+m),e[6]=h+u,e[7]=0,e[8]=p+E,e[9]=h-u,e[10]=1-(l+y),e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Qc(e,r){var t=new Z(3),n=-r[0],o=-r[1],c=-r[2],i=r[3],a=r[4],f=r[5],s=r[6],l=r[7],x=n*n+o*o+c*c+i*i;return x>0?(t[0]=(a*i+l*n+f*c-s*o)*2/x,t[1]=(f*i+l*o+s*n-a*c)*2/x,t[2]=(s*i+l*c+a*o-f*n)*2/x):(t[0]=(a*i+l*n+f*c-s*o)*2,t[1]=(f*i+l*o+s*n-a*c)*2,t[2]=(s*i+l*c+a*o-f*n)*2),gt(e,r,t),e}function Jc(e,r){return e[0]=r[12],e[1]=r[13],e[2]=r[14],e}function It(e,r){var t=r[0],n=r[1],o=r[2],c=r[4],i=r[5],a=r[6],f=r[8],s=r[9],l=r[10];return e[0]=Math.hypot(t,n,o),e[1]=Math.hypot(c,i,a),e[2]=Math.hypot(f,s,l),e}function ei(e,r){var t=new Z(3);It(t,r);var n=1/t[0],o=1/t[1],c=1/t[2],i=r[0]*n,a=r[1]*o,f=r[2]*c,s=r[4]*n,l=r[5]*o,x=r[6]*c,p=r[8]*n,y=r[9]*o,h=r[10]*c,m=i+l+h,u=0;return m>0?(u=Math.sqrt(m+1)*2,e[3]=.25*u,e[0]=(x-y)/u,e[1]=(p-f)/u,e[2]=(a-s)/u):i>l&&i>h?(u=Math.sqrt(1+i-l-h)*2,e[3]=(x-y)/u,e[0]=.25*u,e[1]=(a+s)/u,e[2]=(p+f)/u):l>h?(u=Math.sqrt(1+l-i-h)*2,e[3]=(p-f)/u,e[0]=(a+s)/u,e[1]=.25*u,e[2]=(x+y)/u):(u=Math.sqrt(1+h-i-l)*2,e[3]=(a-s)/u,e[0]=(p+f)/u,e[1]=(x+y)/u,e[2]=.25*u),e}function ri(e,r,t,n){var o=r[0],c=r[1],i=r[2],a=r[3],f=o+o,s=c+c,l=i+i,x=o*f,p=o*s,y=o*l,h=c*s,m=c*l,u=i*l,E=a*f,v=a*s,T=a*l,A=n[0],b=n[1],_=n[2];return e[0]=(1-(h+u))*A,e[1]=(p+T)*A,e[2]=(y-v)*A,e[3]=0,e[4]=(p-T)*b,e[5]=(1-(x+u))*b,e[6]=(m+E)*b,e[7]=0,e[8]=(y+v)*_,e[9]=(m-E)*_,e[10]=(1-(x+h))*_,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function ti(e,r,t,n,o){var c=r[0],i=r[1],a=r[2],f=r[3],s=c+c,l=i+i,x=a+a,p=c*s,y=c*l,h=c*x,m=i*l,u=i*x,E=a*x,v=f*s,T=f*l,A=f*x,b=n[0],_=n[1],g=n[2],F=o[0],M=o[1],I=o[2],P=(1-(m+E))*b,d=(y+A)*b,B=(h-T)*b,w=(y-A)*_,L=(1-(p+E))*_,G=(u+v)*_,V=(h+T)*g,H=(u-v)*g,X=(1-(p+m))*g;return e[0]=P,e[1]=d,e[2]=B,e[3]=0,e[4]=w,e[5]=L,e[6]=G,e[7]=0,e[8]=V,e[9]=H,e[10]=X,e[11]=0,e[12]=t[0]+F-(P*F+w*M+V*I),e[13]=t[1]+M-(d*F+L*M+H*I),e[14]=t[2]+I-(B*F+G*M+X*I),e[15]=1,e}function ni(e,r){var t=r[0],n=r[1],o=r[2],c=r[3],i=t+t,a=n+n,f=o+o,s=t*i,l=n*i,x=n*a,p=o*i,y=o*a,h=o*f,m=c*i,u=c*a,E=c*f;return e[0]=1-x-h,e[1]=l+E,e[2]=p-u,e[3]=0,e[4]=l-E,e[5]=1-s-h,e[6]=y+m,e[7]=0,e[8]=p+u,e[9]=y-m,e[10]=1-s-x,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function oi(e,r,t,n,o,c,i){var a=1/(t-r),f=1/(o-n),s=1/(c-i);return e[0]=c*2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c*2*f,e[6]=0,e[7]=0,e[8]=(t+r)*a,e[9]=(o+n)*f,e[10]=(i+c)*s,e[11]=-1,e[12]=0,e[13]=0,e[14]=i*c*2*s,e[15]=0,e}function wt(e,r,t,n,o){var c=1/Math.tan(r/2),i;return e[0]=c/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,o!=null&&o!==1/0?(i=1/(n-o),e[10]=(o+n)*i,e[14]=2*o*n*i):(e[10]=-1,e[14]=-2*n),e}var ci=wt;function ii(e,r,t,n,o){var c=1/Math.tan(r/2),i;return e[0]=c/t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,o!=null&&o!==1/0?(i=1/(n-o),e[10]=o*i,e[14]=o*n*i):(e[10]=-1,e[14]=-n),e}function ai(e,r,t,n){var o=Math.tan(r.upDegrees*Math.PI/180),c=Math.tan(r.downDegrees*Math.PI/180),i=Math.tan(r.leftDegrees*Math.PI/180),a=Math.tan(r.rightDegrees*Math.PI/180),f=2/(i+a),s=2/(o+c);return e[0]=f,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=-((i-a)*f*.5),e[9]=(o-c)*s*.5,e[10]=n/(t-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*t/(t-n),e[15]=0,e}function Pt(e,r,t,n,o,c,i){var a=1/(r-t),f=1/(n-o),s=1/(c-i);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*f,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*s,e[11]=0,e[12]=(r+t)*a,e[13]=(o+n)*f,e[14]=(i+c)*s,e[15]=1,e}var si=Pt;function fi(e,r,t,n,o,c,i){var a=1/(r-t),f=1/(n-o),s=1/(c-i);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*f,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=s,e[11]=0,e[12]=(r+t)*a,e[13]=(o+n)*f,e[14]=c*s,e[15]=1,e}function li(e,r,t,n){var o,c,i,a,f,s,l,x,p,y,h=r[0],m=r[1],u=r[2],E=n[0],v=n[1],T=n[2],A=t[0],b=t[1],_=t[2];return Math.abs(h-A)<N&&Math.abs(m-b)<N&&Math.abs(u-_)<N?Mt(e):(l=h-A,x=m-b,p=u-_,y=1/Math.hypot(l,x,p),l*=y,x*=y,p*=y,o=v*p-T*x,c=T*l-E*p,i=E*x-v*l,y=Math.hypot(o,c,i),y?(y=1/y,o*=y,c*=y,i*=y):(o=0,c=0,i=0),a=x*i-p*c,f=p*o-l*i,s=l*c-x*o,y=Math.hypot(a,f,s),y?(y=1/y,a*=y,f*=y,s*=y):(a=0,f=0,s=0),e[0]=o,e[1]=a,e[2]=l,e[3]=0,e[4]=c,e[5]=f,e[6]=x,e[7]=0,e[8]=i,e[9]=s,e[10]=p,e[11]=0,e[12]=-(o*h+c*m+i*u),e[13]=-(a*h+f*m+s*u),e[14]=-(l*h+x*m+p*u),e[15]=1,e)}function ui(e,r,t,n){var o=r[0],c=r[1],i=r[2],a=n[0],f=n[1],s=n[2],l=o-t[0],x=c-t[1],p=i-t[2],y=l*l+x*x+p*p;y>0&&(y=1/Math.sqrt(y),l*=y,x*=y,p*=y);var h=f*p-s*x,m=s*l-a*p,u=a*x-f*l;return y=h*h+m*m+u*u,y>0&&(y=1/Math.sqrt(y),h*=y,m*=y,u*=y),e[0]=h,e[1]=m,e[2]=u,e[3]=0,e[4]=x*u-p*m,e[5]=p*h-l*u,e[6]=l*m-x*h,e[7]=0,e[8]=l,e[9]=x,e[10]=p,e[11]=0,e[12]=o,e[13]=c,e[14]=i,e[15]=1,e}function mi(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function xi(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function pi(e,r,t){return e[0]=r[0]+t[0],e[1]=r[1]+t[1],e[2]=r[2]+t[2],e[3]=r[3]+t[3],e[4]=r[4]+t[4],e[5]=r[5]+t[5],e[6]=r[6]+t[6],e[7]=r[7]+t[7],e[8]=r[8]+t[8],e[9]=r[9]+t[9],e[10]=r[10]+t[10],e[11]=r[11]+t[11],e[12]=r[12]+t[12],e[13]=r[13]+t[13],e[14]=r[14]+t[14],e[15]=r[15]+t[15],e}function Rt(e,r,t){return e[0]=r[0]-t[0],e[1]=r[1]-t[1],e[2]=r[2]-t[2],e[3]=r[3]-t[3],e[4]=r[4]-t[4],e[5]=r[5]-t[5],e[6]=r[6]-t[6],e[7]=r[7]-t[7],e[8]=r[8]-t[8],e[9]=r[9]-t[9],e[10]=r[10]-t[10],e[11]=r[11]-t[11],e[12]=r[12]-t[12],e[13]=r[13]-t[13],e[14]=r[14]-t[14],e[15]=r[15]-t[15],e}function yi(e,r,t){return e[0]=r[0]*t,e[1]=r[1]*t,e[2]=r[2]*t,e[3]=r[3]*t,e[4]=r[4]*t,e[5]=r[5]*t,e[6]=r[6]*t,e[7]=r[7]*t,e[8]=r[8]*t,e[9]=r[9]*t,e[10]=r[10]*t,e[11]=r[11]*t,e[12]=r[12]*t,e[13]=r[13]*t,e[14]=r[14]*t,e[15]=r[15]*t,e}function hi(e,r,t,n){return e[0]=r[0]+t[0]*n,e[1]=r[1]+t[1]*n,e[2]=r[2]+t[2]*n,e[3]=r[3]+t[3]*n,e[4]=r[4]+t[4]*n,e[5]=r[5]+t[5]*n,e[6]=r[6]+t[6]*n,e[7]=r[7]+t[7]*n,e[8]=r[8]+t[8]*n,e[9]=r[9]+t[9]*n,e[10]=r[10]+t[10]*n,e[11]=r[11]+t[11]*n,e[12]=r[12]+t[12]*n,e[13]=r[13]+t[13]*n,e[14]=r[14]+t[14]*n,e[15]=r[15]+t[15]*n,e}function Ei(e,r){return e[0]===r[0]&&e[1]===r[1]&&e[2]===r[2]&&e[3]===r[3]&&e[4]===r[4]&&e[5]===r[5]&&e[6]===r[6]&&e[7]===r[7]&&e[8]===r[8]&&e[9]===r[9]&&e[10]===r[10]&&e[11]===r[11]&&e[12]===r[12]&&e[13]===r[13]&&e[14]===r[14]&&e[15]===r[15]}function bi(e,r){var t=e[0],n=e[1],o=e[2],c=e[3],i=e[4],a=e[5],f=e[6],s=e[7],l=e[8],x=e[9],p=e[10],y=e[11],h=e[12],m=e[13],u=e[14],E=e[15],v=r[0],T=r[1],A=r[2],b=r[3],_=r[4],g=r[5],F=r[6],M=r[7],I=r[8],P=r[9],d=r[10],B=r[11],w=r[12],L=r[13],G=r[14],V=r[15];return Math.abs(t-v)<=N*Math.max(1,Math.abs(t),Math.abs(v))&&Math.abs(n-T)<=N*Math.max(1,Math.abs(n),Math.abs(T))&&Math.abs(o-A)<=N*Math.max(1,Math.abs(o),Math.abs(A))&&Math.abs(c-b)<=N*Math.max(1,Math.abs(c),Math.abs(b))&&Math.abs(i-_)<=N*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(a-g)<=N*Math.max(1,Math.abs(a),Math.abs(g))&&Math.abs(f-F)<=N*Math.max(1,Math.abs(f),Math.abs(F))&&Math.abs(s-M)<=N*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(l-I)<=N*Math.max(1,Math.abs(l),Math.abs(I))&&Math.abs(x-P)<=N*Math.max(1,Math.abs(x),Math.abs(P))&&Math.abs(p-d)<=N*Math.max(1,Math.abs(p),Math.abs(d))&&Math.abs(y-B)<=N*Math.max(1,Math.abs(y),Math.abs(B))&&Math.abs(h-w)<=N*Math.max(1,Math.abs(h),Math.abs(w))&&Math.abs(m-L)<=N*Math.max(1,Math.abs(m),Math.abs(L))&&Math.abs(u-G)<=N*Math.max(1,Math.abs(u),Math.abs(G))&&Math.abs(E-V)<=N*Math.max(1,Math.abs(E),Math.abs(V))}var Ti=St,Ai=Rt;var we=class{constructor(){this.position=[0,0,30];this.lookAt=[0,0,0];this.fov=45;this.near=.1;this.far=100;this.up=[0,1,0]}get viewMatrix(){return C.targetTo(C.create(),this.position,this.lookAt,this.up)}projectionMatrix(r){return C.perspective(C.create(),this.fov*(Math.PI/180),r,this.near,this.far)}};var Pe=class{constructor(r,t){this.position=[0,0,0];this.scale=[1,1,1];this.rotate=[0,0,0];this.transparent=!1;this.position=t,this.model=r}rotateX(r){this.rotate[0]+=r}rotateY(r){this.rotate[1]+=r}rotateZ(r){this.rotate[2]+=r}render(r,t,n,o){if(!r)return;let c=C.create();this.position&&C.translate(c,c,this.position),this.rotate&&(C.rotateX(c,c,this.rotate[0]),C.rotateY(c,c,this.rotate[1]),C.rotateZ(c,c,this.rotate[2])),this.scale&&C.scale(c,c,this.scale),t.u_world=c,C.invert(t.u_worldInverseTranspose,c),C.transpose(t.u_worldInverseTranspose,t.u_worldInverseTranspose),C.multiply(t.u_worldViewProjection,n,c);for(let i of this.model.parts){let a=i.bufferInfo;this.model.materials[i.materialName].apply(o),mt(r,o,a),K(o,t),pt(r,a)}}};var dt=`precision highp float;

varying vec3 v_lighting;
varying vec2 v_texCoord;

uniform vec3 u_matDiffuse;
uniform float u_transparency;

// temp
varying vec4 v_color;

void main(void) {
  gl_FragColor = vec4(u_matDiffuse, 1.0) * vec4(v_lighting, 1.0);
  //gl_FragColor.a = u_transparency;
  
  // return red pixels for testing
  //gl_FragColor = vec4(1.0, 0.0, 0.0, 0.5);
}
`;var Bt=`precision highp float;

uniform mat4 u_worldViewProjection;
uniform mat4 u_worldInverseTranspose;
uniform mat4 u_world;

uniform vec3 u_lightPosition;
uniform vec3 u_lightColor;
uniform vec3 u_lightAmbient;

attribute vec4 position;
attribute vec3 normal;
attribute vec4 color;

// varying to pass to fragment shader
varying vec3 v_lighting;
varying vec4 v_color;

void main() {
  vec4 worldPos = u_world * position;
  float distance = length(u_lightPosition - worldPos.xyz) * 0.06;
  vec3 lightVector = normalize(u_lightPosition - worldPos.xyz);
  vec4 normalWorld = u_worldInverseTranspose * vec4(normal, 1.0);
  float intensity = clamp(dot(normalWorld.xyz, lightVector), 0.0, 0.8);

  v_lighting = u_lightAmbient + (u_lightColor * (intensity / (distance * distance)));
  //v_lighting = u_lightAmbient + (u_lightColor * intensity);
  v_color = color;
  gl_Position = u_worldViewProjection * position;
}`;var Ct=class e{constructor(r){this.aspectRatio=1;this.programs={};this.started=!1;this.instances=[];this.lights=[];this.resizeable=!0;this.gl=r,this.models=new Ie,this.prevTime=0,this.totalTime=0;let t=new ge;t.position=[10,120,-20],t.color=[1,1,1],t.ambient=[.2,.2,.2],this.lights[0]=t,this.camera=new we,this.update=()=>{},ce.default.info("\u{1F451} Context created")}static async init(r){let t=Se(!0,r);if(!t)throw ce.default.error("\u{1F4A5} Failed to get WebGL context"),new Error("Failed to get WebGL context");let n=new e(t),o=t.canvas.clientWidth,c=t.canvas.clientHeight;n.aspectRatio=o/c;try{let i=Qe(t,[Bt,dt]);n.programs.standard=i,ce.default.info("\u{1F3A8} Loaded all shaders, GL is ready")}catch(i){throw ce.default.error(i),i}return t.enable(t.DEPTH_TEST),t.enable(t.CULL_FACE),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),n.render=n.render.bind(n),n}async render(r){if(!this.gl)return;r*=.001;let t=r-this.prevTime;this.prevTime=r,this.totalTime+=t,this.update(t);let n={u_worldInverseTranspose:C.create(),u_worldViewProjection:C.create()},o=this.programs.standard;this.resizeable&&(At(this.gl.canvas),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height));let c=this.camera.viewMatrix,i=C.invert(C.create(),c);n.u_viewInverse=c;let a=this.camera.projectionMatrix(this.aspectRatio),f=C.multiply(C.create(),a,i);this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.gl.useProgram(o.program),this.lights[0].apply(o);for(let s of this.instances)s.render(this.gl,n,f,o);this.started&&requestAnimationFrame(this.render)}start(){this.started=!0,requestAnimationFrame(this.render)}stop(){this.started=!1}createInstance(r){let t=this.models.getModel(r);if(!t)throw new Error(`Model ${r} not found`);let n=new Pe(t,[0,0,0]);return this.instances.push(n),n}get defaultLight(){return this.lights[0]}};function Nt(e){let r=new Map,t={},n={newmtl(i,a){t={},r.set(a,t)},Ns(i){t.ns=parseFloat(i[0])},Ka(i){t.ka=i.map(parseFloat)},Kd(i){t.kd=i.map(parseFloat)},Ks(i){t.ks=i.map(parseFloat)},Ke(i){t.ke=i.map(parseFloat)},Ni(i){t.ni=parseFloat(i[0])},d(i){t.d=parseFloat(i[0])},illum(i){t.illum=parseInt(i[0])}},o=/(\w*)(?: )*(.*)/,c=e.split(`
`);for(let i=0;i<c.length;++i){let a=c[i].trim();if(a===""||a.startsWith("#"))continue;let f=o.exec(a);if(!f)continue;let[,s,l]=f,x=a.split(/\s+/).slice(1),p=n[s];if(!p){console.warn("unhandled keyword:",s);continue}p(x,l)}return r}var Fi=/(\w*)(?: )*(.*)/;function Ut(e){let r=e.split(`
`),t=[[0,0,0]],n=[[0,0]],o=[[0,0,0]],c=[t,n,o],i=[[],[],[]],a=Array(),f={},s="__default",l=Array(),x={v(m){t.push(m.map(parseFloat))},vn(m){o.push(m.map(parseFloat))},vt(m){n.push(m.map(parseFloat))},f(m){h();let u=m.length-2;for(let E=0;E<u;++E)p(m[0]),p(m[E+1]),p(m[E+2])},usemtl(m,u){s=u,y()},mtllib(m,u){l.push(u)},s(){},o(){}};function p(m){m.split("/").forEach((E,v)=>{if(!E)return;let T=parseInt(E),A=T+(T>=0?0:c[v].length);i[v].push(...c[v][A])})}function y(){f.material&&(f={})}function h(){if(!f.material){let m=[],u=[],E=[];i=[m,u,E],f={material:s,data:{position:m,texcoord:u,normal:E}},a.push(f)}}for(let m=0;m<r.length;++m){let u=r[m].trim();if(u===""||u.startsWith("#"))continue;let E=Fi.exec(u);if(!E)continue;let[,v,T]=E,A=u.split(/\s+/).slice(1),b=x[v];if(!b){console.warn("unhandled keyword:",v,"at line",m+1);continue}b(A,T)}for(let m of a)m.data.texcoord&&m.data.texcoord.length<=0&&delete m.data.texcoord;return{matLibNames:l,geometries:a}}async function rr(e){let r=await fetch(e);if(!r.ok)throw new Error(`File fetch failed: ${r.statusText}`);return await r.text()}var Dt=ee(J(),1),Lt=class e{constructor(r){this.parts=[];this.materials={};this.name=r}static async parse(r=".",t){let n=t.split(".")[0],o=new e(n),c;try{c=await rr(`${r}/${t}`)}catch{throw new Error(`\u{1F4A5} Unable to load model ${t}`)}let i=Ut(c);if(!i.geometries||i.geometries.length===0)throw new Error(`\u{1F4A5} Error parsing model ${t}`);if(i.matLibNames&&i.matLibNames.length>0)try{let s=await rr(`${r}/${i.matLibNames[0]}`),l=Nt(s);for(let[x,p]of l)o.materials[x]=new ne(p)}catch{console.warn(`Unable to load material library ${i.matLibNames[0]}`)}let a=new ne({kd:[.2,.5,.97]});o.materials.__default=a;let f=Se();if(!f)throw new Error("Unable to get WebGL context");for(let s of i.geometries){let l=$e(f,s.data);o.parts.push(new tr(l,s.material))}return Dt.default.debug(`\u265F\uFE0F Model '${t}' loaded with ${o.parts.length} parts, ${Object.keys(o.materials).length} materials`),o}},tr=class{constructor(r,t){this.bufferInfo=r,this.materialName=t}};export{we as Camera,Ct as Context,ge as Light,ne as Material,Lt as Model,ra as setLogLevel};
/*! Bundled license information:

twgl.js/dist/5.x/twgl-full.module.js:
  (* @license twgl.js 5.3.1 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
  Available via the MIT license.
  see: http://github.com/greggman/twgl.js for details *)
*/
